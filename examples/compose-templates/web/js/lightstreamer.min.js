/**
 * @preserve
 * LIGHTSTREAMER - www.lightstreamer.com
 * Lightstreamer Web Client
 * Version 9.2.0+20240216
 * Copyright (c) Lightstreamer Srl. All Rights Reserved.
 * Contains: LightstreamerClient, Subscription, ConsoleLogLevel,
 * ConsoleLoggerProvider, MpnDevice, MpnSubscription, SafariMpnBuilder,
 * FirebaseMpnBuilder, Chart, DynaGrid, SimpleChartListener,
 * StaticGrid, StatusWidget, Logger, LoggerProvider,
 * ClientListener, ClientMessageListener, ItemUpdate, SubscriptionListener,
 * MpnDeviceListener, MpnSubscriptionListener, ChartListener, DynaGridListener,
 * StaticGridListener
 * UMD
 */
!function(t,e){var s,i=(s=function(t){"use strict";function e(t){if(t.__esModule)return t;var e=t.default;if("function"==typeof e){var s=function t(){return this instanceof t?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};s.prototype=e.prototype}else s={};return Object.defineProperty(s,"__esModule",{value:!0}),Object.keys(t).forEach((function(e){var i=Object.getOwnPropertyDescriptor(t,e);Object.defineProperty(s,e,i.get?i:{enumerable:!0,get:function(){return t[e]}})})),s}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;const s=t=>(e,s)=>(t.set(e,s),s),i=void 0===Number.MAX_SAFE_INTEGER?9007199254740991:Number.MAX_SAFE_INTEGER,n=536870912,r=2*n,a=(t,e)=>s=>{const a=e.get(s);let o=void 0===a?s.size:a<r?a+1:0;if(!s.has(o))return t(s,o);if(s.size<n){for(;s.has(o);)o=Math.floor(Math.random()*r);return t(s,o)}if(s.size>i)throw new Error("Congratulations, you created a collection of unique numbers which uses all available integers!");for(;s.has(o);)o=Math.floor(Math.random()*i);return t(s,o)},o=new WeakMap,h=a(s(o),o),u=t=>void 0!==t.method&&"call"===t.method,l=t=>null===t.error&&"number"==typeof t.id,c=t=>{const e=new Map([[0,()=>{}]]),s=new Map([[0,()=>{}]]),i=new Map,n=new Worker(t);return n.addEventListener("message",(({data:t})=>{if(u(t)){const{params:{timerId:n,timerType:r}}=t;if("interval"===r){const t=e.get(n);if("number"==typeof t){const e=i.get(t);if(void 0===e||e.timerId!==n||e.timerType!==r)throw new Error("The timer is in an undefined state.")}else{if(void 0===t)throw new Error("The timer is in an undefined state.");t()}}else if("timeout"===r){const t=s.get(n);if("number"==typeof t){const e=i.get(t);if(void 0===e||e.timerId!==n||e.timerType!==r)throw new Error("The timer is in an undefined state.")}else{if(void 0===t)throw new Error("The timer is in an undefined state.");t(),s.delete(n)}}}else{if(!l(t)){const{error:{message:e}}=t;throw new Error(e)}{const{id:n}=t,r=i.get(n);if(void 0===r)throw new Error("The timer is in an undefined state.");const{timerId:a,timerType:o}=r;i.delete(n),"interval"===o?e.delete(a):s.delete(a)}}})),{clearInterval:t=>{const s=h(i);i.set(s,{timerId:t,timerType:"interval"}),e.set(t,s),n.postMessage({id:s,method:"clear",params:{timerId:t,timerType:"interval"}})},clearTimeout:t=>{const e=h(i);i.set(e,{timerId:t,timerType:"timeout"}),s.set(t,e),n.postMessage({id:e,method:"clear",params:{timerId:t,timerType:"timeout"}})},setInterval:(t,s=0)=>{const i=h(e);return e.set(i,(()=>{t(),"function"==typeof e.get(i)&&n.postMessage({id:null,method:"set",params:{delay:s,now:performance.now(),timerId:i,timerType:"interval"}})})),n.postMessage({id:null,method:"set",params:{delay:s,now:performance.now(),timerId:i,timerType:"interval"}}),i},setTimeout:(t,e=0)=>{const i=h(s);return s.set(i,t),n.postMessage({id:null,method:"set",params:{delay:e,now:performance.now(),timerId:i,timerType:"timeout"}}),i}}},d=(t,e)=>{let s=null;return()=>{if(null!==s)return s;const i=new Blob([e],{type:"application/javascript; charset=utf-8"}),n=URL.createObjectURL(i);return s=t(n),setTimeout((()=>URL.revokeObjectURL(n))),s}},_=d(c,'(()=>{"use strict";const e=new Map,t=new Map,r=(e,t)=>{let r,o;const i=performance.now();r=i,o=e-Math.max(0,i-t);return{expected:r+o,remainingDelay:o}},o=(e,t,r,i)=>{const s=performance.now();s>r?postMessage({id:null,method:"call",params:{timerId:t,timerType:i}}):e.set(t,setTimeout(o,r-s,e,t,r,i))};addEventListener("message",(i=>{let{data:s}=i;try{if("clear"===s.method){const{id:r,params:{timerId:o,timerType:i}}=s;if("interval"===i)(t=>{const r=e.get(t);if(void 0===r)throw new Error(\'There is no interval scheduled with the given id "\'.concat(t,\'".\'));clearTimeout(r),e.delete(t)})(o),postMessage({error:null,id:r});else{if("timeout"!==i)throw new Error(\'The given type "\'.concat(i,\'" is not supported\'));(e=>{const r=t.get(e);if(void 0===r)throw new Error(\'There is no timeout scheduled with the given id "\'.concat(e,\'".\'));clearTimeout(r),t.delete(e)})(o),postMessage({error:null,id:r})}}else{if("set"!==s.method)throw new Error(\'The given method "\'.concat(s.method,\'" is not supported\'));{const{params:{delay:i,now:n,timerId:a,timerType:d}}=s;if("interval"===d)((t,i,s)=>{const{expected:n,remainingDelay:a}=r(t,s);e.set(i,setTimeout(o,a,e,i,n,"interval"))})(i,a,n);else{if("timeout"!==d)throw new Error(\'The given type "\'.concat(d,\'" is not supported\'));((e,i,s)=>{const{expected:n,remainingDelay:a}=r(e,s);t.set(i,setTimeout(o,a,t,i,n,"timeout"))})(i,a,n)}}}}catch(e){postMessage({error:{message:e.message},id:s.id,result:null})}}))})();'),p=t=>_().clearInterval(t),f=t=>_().clearTimeout(t),m=(...t)=>_().setInterval(...t),g=(...t)=>_().setTimeout(...t);var v,S=e(Object.freeze({__proto__:null,clearInterval:p,clearTimeout:f,setInterval:m,setTimeout:g})),y={exports:{}};function b(){return v||(v=1,t=y,function(e,s){s(t.exports)}(0,(function(t){var e,s,i,n;function r(t){Error.call(this,t),this.message=t}function a(t){Error.call(this,t),this.message=t}function o(t){var e,s;if(n(t))return t.slice();if(null===t)return t;if("object"==typeof t){for(s in e={},t)Object.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}return t}function h(t,e){var s;if(t===e)return!0;if(typeof t!=typeof e)return!1;if("object"==typeof t){var i=n(t);if(i!==n(e))return!1;if(i){if(t.length!=e.length)return!1;for(var r=0;r<t.length;r++)if(!h(t[r],e[r]))return!1;return!0}for(s in t)if(Object.hasOwnProperty(t,s)&&(!Object.hasOwnProperty(e,s)||!h(t[s],e[s])))return!1;for(s in e)if(Object.hasOwnProperty(e,s)&&!Object.hasOwnProperty(t,s))return!1;return!0}return!1}function u(t){var e,s;if(!t.op)throw new r("Operation missing!");if(!i.hasOwnProperty(t.op))throw new r("Invalid operation!");if(!("path"in t))throw new r("Path missing!");for(s=i[t.op],e=0;e<s.length;e++)if(!(s[e]in t))throw new r(t.op+" must have key "+s[e])}function l(t,e){u(t);var i=t.op,n=new s(t.path),o=t.value,l=t.from?new s(t.from):null;switch(i){case"add":return function(t){return n.add(t,o,e)};case"remove":return function(t){return n.remove(t,e)};case"replace":return function(t){return n.replace(t,o,e)};case"move":if(n.subsetOf(l))throw new r("destination must not be a child of source");return function(t){var s=l.get(t),i=l.remove(t,e);return n.add(i,s,e)};case"copy":return function(t){var s=l.get(t);return n.add(t,s,e)};case"test":return function(t){if(!h(n.get(t),o))throw new a("Test operation failed. Value did not match.");return t}}}n=Array.isArray||function(t){return"[object Array]"==Object.prototype.toString.call(t)},t.apply_patch=function(t,s){return new e(s).apply(t)},t.InvalidPatch=r,r.prototype=new Error,t.PatchApplyError=a,a.prototype=new Error,t.JSONPointer=s=function(t){var e,s,i=[];if(""!==(s=t.split("/"))[0])throw new r("JSONPointer must start with a slash (or be an empty string)!");for(e=1;e<s.length;e++)i[e-1]=s[e].replace(/~1/g,"/").replace(/~0/g,"~");this.path=i,this.length=i.length},s.prototype._get_segment=function(t,e){var s=this.path[t];if(n(e))if("-"===s)s=e.length;else{if(!s.match(/^0$|^[1-9][0-9]*$/))throw new a("Expected a number to segment an array");s=parseInt(s,10)}return s},s.prototype._action=function(t,e,s){var i=this;function r(t,h){var u,l;if(s||(t=o(t)),u=i._get_segment(h,t),h==i.path.length-1)t=e(t,u);else{if(n(t)){if(t.length<=u)throw new a("Path not found in document")}else{if("object"!=typeof t)throw new a("Path not found in document");if(!Object.hasOwnProperty.call(t,u))throw new a("Path not found in document")}l=r(t[u],h+1),s||(t[u]=l)}return t}return r(t,0)},s.prototype.add=function(t,e,s){return 0===this.length?e:this._action(t,(function(t,s){if(n(t)){if(s>t.length)throw new a("Add operation must not attempt to create a sparse array!");t.splice(s,0,e)}else t[s]=e;return t}),s)},s.prototype.remove=function(t,e){if(0!==this.length)return this._action(t,(function(t,e){if(!Object.hasOwnProperty.call(t,e))throw new a("Remove operation must point to an existing value!");return n(t)?t.splice(e,1):delete t[e],t}),e)},s.prototype.replace=function(t,e,s){return 0===this.length?e:this._action(t,(function(t,s){if(!Object.hasOwnProperty.call(t,s))throw new a("Replace operation must point to an existing value!");return n(t)?t.splice(s,1,e):t[s]=e,t}),s)},s.prototype.get=function(t){var e;return 0===this.length?t:(this._action(t,(function(t,s){if(!Object.hasOwnProperty.call(t,s))throw new a("Path not found in document");return e=t[s],t}),!0),e)},s.prototype.subsetOf=function(t){if(this.length<=t.length)return!1;for(var e=0;e<t.length;e++)if(t.path[e]!==this.path[e])return!1;return!0},i={add:["value"],replace:["value"],test:["value"],remove:[],move:["from"],copy:["from"]},t.JSONPatch=e=function(t,e){this._compile(t,e)},e.prototype._compile=function(t,e){var s,i=this;if(this.compiledOps=[],"string"==typeof t&&(t=JSON.parse(t)),!n(t))throw new r("Patch must be an array of operations");for(s=0;s<t.length;s++){var a=l(t[s],e);i.compiledOps.push(a)}},t.JSONPatch.prototype.apply=function(t){var e;for(e=0;e<this.compiledOps.length;e++)t=this.compiledOps[e](t);return t}}))),y.exports;var t}var E=function(){};E.prototype={fatal:function(t,e){},isFatalEnabled:function(){},error:function(t,e){},isErrorEnabled:function(){},warn:function(t,e){},isWarnEnabled:function(){},info:function(t,e){},isInfoEnabled:function(){},debug:function(t,e){},isDebugEnabled:function(){},trace:function(t,e){},isTraceEnabled:function(){}};var w=function(){};function T(){}function R(){}w.prototype={getLogger:function(t){}},T.prototype={onServerError:function(t,e){},onStatusChange:function(t){},onPropertyChange:function(t){},onListenStart:function(){},onListenEnd:function(){},onServerKeepalive:function(){}},R.prototype={onAbort:function(t,e){},onError:function(t){},onDiscarded:function(t){},onDeny:function(t,e,s){},onProcessed:function(t,e){}};var I=function(){};I.prototype={getItemName:function(){},getItemPos:function(){},getValue:function(t){},getValueAsJSONPatchIfAvailable:function(t){return null},isValueChanged:function(t){},isSnapshot:function(){},forEachChangedField:function(t){},forEachField:function(t){}};var C=function(){};C.prototype={onItemUpdate:function(t){},onItemLostUpdates:function(t,e,s){},onCommandSecondLevelItemLostUpdates:function(t,e){},onEndOfSnapshot:function(t,e){},onClearSnapshot:function(t,e){},onSubscription:function(){},onUnsubscription:function(){},onSubscriptionError:function(t,e){},onCommandSecondLevelSubscriptionError:function(t,e,s){},onListenStart:function(){},onListenEnd:function(){},onRealMaxFrequency:function(t){}};var x=function(){};x.prototype={onListenStart:function(){},onListenEnd:function(){},onRegistered:function(){},onSuspended:function(){},onResumed:function(){},onStatusChanged:function(t,e){},onRegistrationFailed:function(t,e){},onSubscriptionsUpdated:function(){}};var L=function(){};L.prototype={onListenStart:function(){},onListenEnd:function(){},onSubscription:function(){},onUnsubscription:function(){},onSubscriptionError:function(t,e){},onUnsubscriptionError:function(t,e){},onTriggered:function(){},onStatusChanged:function(t,e){},onPropertyChanged:function(t){},onModificationError:function(t,e,s){}};var N={};!function(t){var e,s=function(){return U.__string_rec(this,"")},i=i||{};function n(t,e){var s=Object.create(t);for(var i in e)s[i]=e[i];return e.toString!==Object.prototype.toString&&(s.toString=e.toString),s}var r=function(t,e){this.r=new RegExp(t,e.split("u").join(""))};r.__name__=!0,r.prototype={match:function(t){return this.r.global&&(this.r.lastIndex=0),this.r.m=this.r.exec(t),this.r.s=t,null!=this.r.m},__class__:r};var a=function(){};a.__name__=!0,a.dateStr=function(t){var e=t.getMonth()+1,s=t.getDate(),i=t.getHours(),n=t.getMinutes(),r=t.getSeconds();return t.getFullYear()+"-"+(e<10?"0"+e:""+e)+"-"+(s<10?"0"+s:""+s)+" "+(i<10?"0"+i:""+i)+":"+(n<10?"0"+n:""+n)+":"+(r<10?"0"+r:""+r)},a.cca=function(t,e){var s=t.charCodeAt(e);if(s==s)return s},a.substr=function(t,e,s){if(null==s)s=t.length;else if(s<0){if(0!=e)return"";s=t.length+s}return t.substr(e,s)},a.remove=function(t,e){var s=t.indexOf(e);return-1!=s&&(t.splice(s,1),!0)},a.now=function(){return Date.now()};var o=function(t,e){this.min=t,this.max=e};o.__name__=!0,o.prototype={hasNext:function(){return this.min<this.max},next:function(){return this.min++},__class__:o};var h=function(){};h.__name__=!0,h.has=function(t,e){for(var s=Hs(t);s.hasNext();)if(s.next()==e)return!0;return!1},h.exists=function(t,e){for(var s=Hs(t);s.hasNext();)if(e(s.next()))return!0;return!1},h.count=function(t,e){var s=0;if(null==e)for(var i=Hs(t);i.hasNext();)i.next(),++s;else for(var n=Hs(t);n.hasNext();)e(n.next())&&++s;return s},h.empty=function(t){return!Hs(t).hasNext()},h.find=function(t,e){for(var s=Hs(t);s.hasNext();){var i=s.next();if(e(i))return i}return null},Math.__name__=!0;var u=function(){};u.__name__=!0,u.field=function(t,e){try{return t[e]}catch(t){return null}},u.fields=function(t){var e=[];if(null!=t){var s=Object.prototype.hasOwnProperty;for(var i in t)"__id__"!=i&&"hx__closures__"!=i&&s.call(t,i)&&e.push(i)}return e},u.deleteField=function(t,e){return!!Object.prototype.hasOwnProperty.call(t,e)&&(delete t[e],!0)},u.copy=function(t){if(null==t)return null;for(var e={},s=0,i=u.fields(t);s<i.length;){var n=i[s];++s,e[n]=u.field(t,n)}return e};var l=function(){};l.__name__=!0,l.string=function(t){return U.__string_rec(t,"")},l.parseInt=function(t){var e=parseInt(t);return isNaN(e)?null:e},l.random=function(t){return t<=0?0:Math.floor(Math.random()*t)};var c=function(){this.b=""};c.__name__=!0,c.prototype={__class__:c};var d=function(){};d.__name__=!0,d.startsWith=function(t,e){return t.length>=e.length&&0==t.lastIndexOf(e,0)},d.endsWith=function(t,e){var s=e.length,i=t.length;return i>=s&&t.indexOf(e,i-s)==i-s},d.isSpace=function(t,e){var s=a.cca(t,e);return s>8&&s<14||32==s},d.ltrim=function(t){for(var e=t.length,s=0;s<e&&d.isSpace(t,s);)++s;return s>0?a.substr(t,s,e-s):t},d.rtrim=function(t){for(var e=t.length,s=0;s<e&&d.isSpace(t,e-s-1);)++s;return s>0?a.substr(t,0,e-s):t},d.trim=function(t){return d.ltrim(d.rtrim(t))},d.replace=function(t,e,s){return t.split(e).join(s)};var _=function(){};_.__name__=!0,_.enumEq=function(t,e){if(t==e)return!0;try{var s=t.__enum__;if(null==s||s!=e.__enum__)return!1;if(t._hx_index!=e._hx_index)return!1;for(var n=i[s].__constructs__[t._hx_index].__params__,r=0;r<n.length;){var a=n[r];if(++r,!_.enumEq(t[a],e[a]))return!1}}catch(r){return!1}return!0};var p=N.LSConnectionDetails=function(t){this.serverAddress=Zs,this.client=t,this.lock=t.lock};p.__name__=!0,p.prototype={getServerAddress:function(){return this.serverAddress},setServerAddress:function(t){var e=m.fromString(t);if(e!=this.serverAddress){hi.isInfoEnabled()&&hi.info("serverAddress changed: "+e);var s=this.serverAddress;this.serverAddress=e,this.client.eventDispatcher.onPropertyChange("serverAddress"),s!=e&&this.client.machine.evtServerAddressChanged()}},getAdapterSet:function(){return this.adapterSet},setAdapterSet:function(t){t!=this.adapterSet&&(hi.isInfoEnabled()&&hi.info("adapterSet changed: "+t),this.adapterSet=t,this.client.eventDispatcher.onPropertyChange("adapterSet"))},getUser:function(){return this.user},setUser:function(t){t!=this.user&&(hi.isInfoEnabled()&&hi.info("user changed: "+t),this.user=t,this.client.eventDispatcher.onPropertyChange("user"))},setPassword:function(t){t!=this.password&&(hi.isInfoEnabled()&&hi.info("password changed"),this.password=t,this.client.eventDispatcher.onPropertyChange("password"))},getSessionId:function(){return this.sessionId},setSessionId:function(t){t!=this.sessionId&&(this.sessionId=t,this.client.eventDispatcher.onPropertyChange("sessionId"))},getServerInstanceAddress:function(){return this.serverInstanceAddress},setServerInstanceAddress:function(t){t!=this.serverInstanceAddress&&(this.serverInstanceAddress=t,this.client.eventDispatcher.onPropertyChange("serverInstanceAddress"))},getServerSocketName:function(){return this.serverSocketName},setServerSocketName:function(t){t!=this.serverSocketName&&(this.serverSocketName=t,this.client.eventDispatcher.onPropertyChange("serverSocketName"))},getClientIp:function(){return this.clientIp},setClientIp:function(t){t!=this.clientIp&&(this.clientIp=t,this.client.eventDispatcher.onPropertyChange("clientIp"))},toString:function(){var t=Ce._new();return Ce.set(t,"serverAddress",this.serverAddress),Ce.set(t,"adapterSet",this.adapterSet),Ce.set(t,"user",this.user),Ce.set(t,"sessionId",this.sessionId),Ce.set(t,"serverInstanceAddress",this.serverInstanceAddress),Ce.set(t,"serverSocketName",this.serverSocketName),Ce.set(t,"clientIp",this.clientIp),Ce.set(t,"libVersion",x.LIB_NAME+" "+x.LIB_VERSION),ks.stringify(t.h)},__class__:p};var f=function(){};f.__name__=!0,f.get_supported=function(){return"undefined"!=typeof window&&void 0!==window.location&&"string"==typeof window.location.protocol},f.getLocalStorage=function(){try{var t=window.localStorage;if(t.getItem(""),0==t.length){var e="_hx_"+Math.random();t.setItem(e,e),t.removeItem(e)}return t}catch(t){return null}};var m={_new:function(t){return t},fromString:function(t){if(null==t)return null;if(d.startsWith(t,"http://")||d.startsWith(t,"https://"))return t;throw new v("address is malformed")}},g=function(t,e,s){Error.call(this,t),this.message=t,this.__previousException=e,this.__nativeException=null!=s?s:this,this.__skipStack=0;var i=Error.prepareStackTrace;if(Error.prepareStackTrace=function(t){return t.stack},s instanceof Error)this.stack=s.stack;else{var n=null;if(Error.captureStackTrace)Error.captureStackTrace(this,g),n=this;else if(void 0===(n=new Error).stack){try{throw n}catch(t){}this.__skipStack++}this.stack=n.stack}Error.prepareStackTrace=i};g.__name__=!0,g.caught=function(t){return t instanceof g?t:t instanceof Error?new g(t.message,null,t):new Os(t,null,t)},g.thrown=function(t){if(t instanceof g)return t.get_native();if(t instanceof Error)return t;var e=new Os(t);return e.__skipStack++,e},g.__super__=Error,g.prototype=n(Error.prototype,{toString:function(){return this.get_message()},details:function(){if(null==this.get_previous()){var t="Exception: "+this.toString(),e=this.get_stack();return t+(null==e?"null":Ms.toString(e))}for(var s="",i=this,n=null;null!=i;){if(null==n)s="Exception: "+i.get_message()+(null==(t=i.get_stack())?"null":Ms.toString(t))+s;else{var r=Ms.subtract(i.get_stack(),n.get_stack());s="Exception: "+i.get_message()+(null==r?"null":Ms.toString(r))+"\n\nNext "+s}n=i,i=i.get_previous()}return s},__shiftStack:function(){this.__skipStack++},get_message:function(){return this.message},get_previous:function(){return this.__previousException},get_native:function(){return this.__nativeException},get_stack:function(){var t=this.__exceptionStack;if(null==t){var e=Ds.toHaxe(Ds.normalize(this.stack),this.__skipStack);return this.setProperty("__exceptionStack",e),e}return t},setProperty:function(t,e){try{Object.defineProperty(this,t,{value:e})}catch(s){this[t]=e}},__class__:g});var v=function(t,e,s){g.call(this,t,e,s),this.__skipStack++};v.__name__=!0,v.__super__=g,v.prototype=n(g.prototype,{__class__:v});var y=N.LSConnectionOptions=function(t){this.cookieHandlingRequired=!1,this.slowingEnabled=!1,this.serverInstanceAddressIgnored=!1,this.httpExtraHeadersOnSessionCreationOnly=!1,this.stalledTimeout=2e3,this.sessionRecoveryTimeout=15e3,this.reverseHeartbeatInterval=0,this.retryDelay=4e3,this.reconnectTimeout=3e3,this.pollingInterval=0,this.realMaxBandwidth=null,this.requestedMaxBandwidth=rs.BWUnlimited,this.keepaliveInterval=0,this.idleTimeout=19e3,this.httpExtraHeaders=null,this.forcedTransport=null,this.firstRetryMaxDelay=100,this.contentLength=5e7,this.client=t,this.lock=t.lock};y.__name__=!0,y.prototype={getContentLength:function(){return this.contentLength},setContentLength:function(t){var e=is.fromIntGt0(t);e!=this.contentLength&&(hi.isInfoEnabled()&&hi.info("contentLength changed: "+e),this.contentLength=e,this.client.eventDispatcher.onPropertyChange("contentLength"))},getFirstRetryMaxDelay:function(){return this.firstRetryMaxDelay},setFirstRetryMaxDelay:function(t){var e=ss.fromIntGt0(t);e!=this.firstRetryMaxDelay&&(hi.isInfoEnabled()&&hi.info("firstRetryMaxDelay changed: "+e),this.firstRetryMaxDelay=e,this.client.eventDispatcher.onPropertyChange("firstRetryMaxDelay"))},getForcedTransport:function(){return this.forcedTransport},setForcedTransport:function(t){var e=ns.fromString(t);e!=this.forcedTransport&&(hi.isInfoEnabled()&&hi.info("forcedTransport changed: "+e),this.forcedTransport=e,this.client.eventDispatcher.onPropertyChange("forcedTransport"),this.client.machine.evtExtSetForcedTransport())},getHttpExtraHeaders:function(){return null==this.httpExtraHeaders?null:De.fromMapToDynamicAccess(this.httpExtraHeaders)},setHttpExtraHeaders:function(t){var e=null!=t?De.toHaxe(t):null;this.mapEq(e,this.httpExtraHeaders)||(hi.isInfoEnabled()&&hi.info("httpExtraHeaders changed: "+(null==e?"null":ks.stringify(e.h))),this.httpExtraHeaders=e,this.client.eventDispatcher.onPropertyChange("httpExtraHeaders"))},mapEq:function(t,e){if(t==e)return!0;if(null==t||null==e)return!1;if(h.count(t)!=h.count(e))return!1;for(var s=t.h,i=Object.keys(s),n=i.length,r=0;r<n;){var a=i[r++];if(s[a]!=e.h[a])return!1}return!0},getIdleTimeout:function(){return this.idleTimeout},setIdleTimeout:function(t){var e=ss.fromIntGtEq0(t);e!=this.idleTimeout&&(hi.isInfoEnabled()&&hi.info("idleTimeout changed: "+e),this.idleTimeout=e,this.client.eventDispatcher.onPropertyChange("idleTimeout"))},getKeepaliveInterval:function(){return this.keepaliveInterval},setKeepaliveInterval:function(t){var e=ss.fromIntGtEq0(t);e!=this.keepaliveInterval&&(hi.isInfoEnabled()&&hi.info("keepaliveInterval changed: "+e),this.keepaliveInterval=e,this.client.eventDispatcher.onPropertyChange("keepaliveInterval"))},getRequestedMaxBandwidth:function(){return as.toString(this.requestedMaxBandwidth)},setRequestedMaxBandwidth:function(t){null!=t&&(t=null==t?"null":""+t);var e=as.fromString(t);_.enumEq(e,this.requestedMaxBandwidth)||(hi.isInfoEnabled()&&hi.info("requestedMaxBandwidth changed: "+as.toString(e)),this.requestedMaxBandwidth=e,this.client.eventDispatcher.onPropertyChange("requestedMaxBandwidth"),this.client.machine.evtExtSetRequestedMaxBandwidth())},getRealMaxBandwidth:function(){return fs.toString(this.realMaxBandwidth)},setRealMaxBandwidth:function(t){fs.eq(t,this.realMaxBandwidth)||(this.realMaxBandwidth=t,this.client.eventDispatcher.onPropertyChange("realMaxBandwidth"))},getPollingInterval:function(){return this.pollingInterval},setPollingInterval:function(t){var e=ss.fromIntGtEq0(t);e!=this.pollingInterval&&(hi.isInfoEnabled()&&hi.info("pollingInterval changed: "+e),this.pollingInterval=e,this.client.eventDispatcher.onPropertyChange("pollingInterval"))},getReconnectTimeout:function(){return this.reconnectTimeout},setReconnectTimeout:function(t){var e=ss.fromIntGt0(t);e!=this.reconnectTimeout&&(hi.isInfoEnabled()&&hi.info("reconnectTimeout changed: "+e),this.reconnectTimeout=e,this.client.eventDispatcher.onPropertyChange("reconnectTimeout"))},getRetryDelay:function(){return this.retryDelay},setRetryDelay:function(t){var e=ss.fromIntGt0(t);e!=this.retryDelay&&(hi.isInfoEnabled()&&hi.info("retryDelay changed: "+e),this.retryDelay=e,this.client.eventDispatcher.onPropertyChange("retryDelay"))},getReverseHeartbeatInterval:function(){return this.reverseHeartbeatInterval},setReverseHeartbeatInterval:function(t){var e=ss.fromIntGtEq0(t);e!=this.reverseHeartbeatInterval&&(hi.isInfoEnabled()&&hi.info("reverseHeartbeatInterval changed: "+e),this.reverseHeartbeatInterval=e,this.client.eventDispatcher.onPropertyChange("reverseHeartbeatInterval"),this.client.machine.evtExtSetReverseHeartbeatInterval())},getSessionRecoveryTimeout:function(){return this.sessionRecoveryTimeout},setSessionRecoveryTimeout:function(t){var e=ss.fromIntGtEq0(t);e!=this.sessionRecoveryTimeout&&(hi.isInfoEnabled()&&hi.info("sessionRecoveryTimeout changed: "+e),this.sessionRecoveryTimeout=e,this.client.eventDispatcher.onPropertyChange("sessionRecoveryTimeout"))},getStalledTimeout:function(){return this.stalledTimeout},setStalledTimeout:function(t){var e=ss.fromIntGt0(t);e!=this.stalledTimeout&&(hi.isInfoEnabled()&&hi.info("stalledTimeout changed: "+e),this.stalledTimeout=e,this.client.eventDispatcher.onPropertyChange("stalledTimeout"))},isHttpExtraHeadersOnSessionCreationOnly:function(){return this.httpExtraHeadersOnSessionCreationOnly},setHttpExtraHeadersOnSessionCreationOnly:function(t){t!=this.httpExtraHeadersOnSessionCreationOnly&&(hi.isInfoEnabled()&&hi.info("httpExtraHeadersOnSessionCreationOnly changed: "+(null==t?"null":""+t)),this.httpExtraHeadersOnSessionCreationOnly=t,this.client.eventDispatcher.onPropertyChange("httpExtraHeadersOnSessionCreationOnly"))},isServerInstanceAddressIgnored:function(){return this.serverInstanceAddressIgnored},setServerInstanceAddressIgnored:function(t){t!=this.serverInstanceAddressIgnored&&(hi.isInfoEnabled()&&hi.info("serverInstanceAddressIgnored changed: "+(null==t?"null":""+t)),this.serverInstanceAddressIgnored=t,this.client.eventDispatcher.onPropertyChange("serverInstanceAddressIgnored"))},setCookieHandlingRequired:function(t){t!=this.cookieHandlingRequired&&(hi.isInfoEnabled()&&hi.info("cookieHandlingRequired changed: "+(null==t?"null":""+t)),this.cookieHandlingRequired=t,this.client.eventDispatcher.onPropertyChange("cookieHandlingRequired"))},isCookieHandlingRequired:function(){return this.cookieHandlingRequired},isSlowingEnabled:function(){return this.slowingEnabled},setSlowingEnabled:function(t){t!=this.slowingEnabled&&(hi.isInfoEnabled()&&hi.info("slowingEnabled changed: "+(null==t?"null":""+t)),this.slowingEnabled=t,this.client.eventDispatcher.onPropertyChange("slowingEnabled"))},toString:function(){var t=Ce._new();return Ce.set(t,"forcedTransport",this.forcedTransport),Ce.set(t,"requestedMaxBandwidth",this.requestedMaxBandwidth),Ce.set(t,"realMaxBandwidth",this.realMaxBandwidth),Ce.set(t,"retryDelay",this.retryDelay),Ce.set(t,"firstRetryMaxDelay",this.firstRetryMaxDelay),Ce.set(t,"sessionRecoveryTimeout",this.sessionRecoveryTimeout),Ce.set(t,"reverseHeartbeatInterval",this.reverseHeartbeatInterval),Ce.set(t,"stalledTimeout",this.stalledTimeout),Ce.set(t,"reconnectTimeout",this.reconnectTimeout),Ce.set(t,"keepaliveInterval",this.keepaliveInterval),Ce.set(t,"pollingInterval",this.pollingInterval),Ce.set(t,"idleTimeout",this.idleTimeout),Ce.set(t,"contentLength",this.contentLength),Ce.set(t,"slowingEnabled",this.slowingEnabled),Ce.set(t,"serverInstanceAddressIgnored",this.serverInstanceAddressIgnored),Ce.set(t,"HTTPExtraHeadersOnSessionCreationOnly",this.httpExtraHeadersOnSessionCreationOnly),Ce.set(t,"HTTPExtraHeaders",this.httpExtraHeaders),Ce.set(t,"cookieHandlingRequired",this.cookieHandlingRequired),ks.stringify(t.h)},__class__:y};var T=function(){this.listeners=[]};T.__name__=!0,T.prototype={addListener:function(t){return-1==this.listeners.indexOf(t)&&(this.listeners.push(t),!0)},removeListener:function(t){return a.remove(this.listeners,t)},getListeners:function(){return this.listeners},dispatchToAll:function(t){for(var e=0,s=this.listeners;e<s.length;)this.dispatchToOne(s[e++],t)},dispatchToOne:function(t,e){wi((function(){try{e(t)}catch(t){var s=g.caught(t);hi.isErrorEnabled()&&hi.error("Uncaught exception\n"+s.details())}}))},__class__:T};var R=function(){T.call(this)};R.__name__=!0,R.__super__=T,R.prototype=n(T.prototype,{removeListenerAndFireOnListenEnd:function(t,e){this.removeListener(t)&&this.dispatchToOne(t,(function(t){null!=t.onListenEnd&&t.onListenEnd(e)}))},addListenerAndFireOnListenStart:function(t,e){this.addListener(t)&&this.dispatchToOne(t,(function(t){null!=t.onListenStart&&t.onListenStart(e)}))},onServerError:function(t,e){this.dispatchToAll((function(s){null!=s.onServerError&&s.onServerError(t,e)}))},onStatusChange:function(t){this.dispatchToAll((function(e){null!=e.onStatusChange&&e.onStatusChange(t)}))},onPropertyChange:function(t){this.dispatchToAll((function(e){null!=e.onPropertyChange&&e.onPropertyChange(t)}))},onServerKeepalive:function(){this.dispatchToAll((function(t){null!=t.onServerKeepalive&&t.onServerKeepalive()}))},__class__:R});var x=N.LSLightstreamerClient=function(t,e){this.lock=new A,this.eventDispatcher=new R,this.connectionDetails=new p(this),this.connectionOptions=new y(this),this.machine=new _t(this,new ze(this)),null!=t&&this.connectionDetails.setServerAddress(t),null!=e&&this.connectionDetails.setAdapterSet(e)};x.__name__=!0,x.setLoggerProvider=function(t){q.setLoggerProvider(t)},x.prototype={addListener:function(t){this.eventDispatcher.addListenerAndFireOnListenStart(t,this)},removeListener:function(t){this.eventDispatcher.removeListenerAndFireOnListenEnd(t,this)},getListeners:function(){return this.eventDispatcher.getListeners().slice()},connect:function(){this.machine.connect()},disconnect:function(){this.machine.disconnect()},getStatus:function(){return this.machine.getStatus()},sendMessage:function(t,e,s,i,n){null==n&&(n=!1),null==s&&(s=-1),this.machine.sendMessage(t,e,null!=s?s:-1,i,null!=n&&n)},subscribe:function(t){this.machine.subscribeExt(t)},unsubscribe:function(t){this.machine.unsubscribe(t)},getSubscriptions:function(){return this.machine.getSubscriptions().slice()},getSubscriptionWrappers:function(){for(var t=[],e=0,s=this.machine.getSubscriptions();e<s.length;){var i=s[e];++e,null!=i.wrapper&&t.push(i.wrapper)}return t.slice()},registerForMpn:function(t){U.__cast(this.machine,_t).registerForMpn(t)},subscribeMpn:function(t,e){U.__cast(this.machine,_t).subscribeMpn(t,e)},unsubscribeMpn:function(t){U.__cast(this.machine,_t).unsubscribeMpn(t)},unsubscribeMpnSubscriptions:function(t){U.__cast(this.machine,_t).unsubscribeMpnSubscriptions(t)},getMpnSubscriptions:function(t){return U.__cast(this.machine,_t).getMpnSubscriptions(t).slice()},getMpnSubscriptionWrappers:function(t){for(var e=[],s=0,i=U.__cast(this.machine,_t).getMpnSubscriptions(t);s<i.length;){var n=i[s];++s,null!=n.wrapper&&e.push(n.wrapper)}return e.slice()},findMpnSubscription:function(t){return U.__cast(this.machine,_t).findMpnSubscription(t)},findMpnSubscriptionWrapper:function(t){var e=this.findMpnSubscription(t);return null!=e?e.wrapper:null},__class__:x};var L=i["com.lightstreamer.client._Subscription.SubscriptionState"]={__ename__:!0,__constructs__:null,Inactive:{_hx_name:"Inactive",_hx_index:0,__enum__:"com.lightstreamer.client._Subscription.SubscriptionState",toString:s},Active:{_hx_name:"Active",_hx_index:1,__enum__:"com.lightstreamer.client._Subscription.SubscriptionState",toString:s},Subscribed:{_hx_name:"Subscribed",_hx_index:2,__enum__:"com.lightstreamer.client._Subscription.SubscriptionState",toString:s}};L.__constructs__=[L.Inactive,L.Active,L.Subscribed];var M=function(){T.call(this)};M.__name__=!0,M.__super__=T,M.prototype=n(T.prototype,{onClearSnapshot:function(t,e){this.dispatchToAll((function(s){null!=s.onClearSnapshot&&s.onClearSnapshot(t,e)}))},onCommandSecondLevelItemLostUpdates:function(t,e){this.dispatchToAll((function(s){null!=s.onCommandSecondLevelItemLostUpdates&&s.onCommandSecondLevelItemLostUpdates(t,e)}))},onCommandSecondLevelSubscriptionError:function(t,e,s){this.dispatchToAll((function(i){null!=i.onCommandSecondLevelSubscriptionError&&i.onCommandSecondLevelSubscriptionError(t,e,s)}))},onEndOfSnapshot:function(t,e){this.dispatchToAll((function(s){null!=s.onEndOfSnapshot&&s.onEndOfSnapshot(t,e)}))},onItemLostUpdates:function(t,e,s){this.dispatchToAll((function(i){null!=i.onItemLostUpdates&&i.onItemLostUpdates(t,e,s)}))},onItemUpdate:function(t){this.dispatchToAll((function(e){null!=e.onItemUpdate&&e.onItemUpdate(t)}))},removeListenerAndFireOnListenEnd:function(t,e){this.removeListener(t)&&this.dispatchToOne(t,(function(t){null!=t.onListenEnd&&t.onListenEnd(e)}))},addListenerAndFireOnListenStart:function(t,e){this.addListener(t)&&this.dispatchToOne(t,(function(t){null!=t.onListenStart&&t.onListenStart(e)}))},onSubscription:function(){this.dispatchToAll((function(t){null!=t.onSubscription&&t.onSubscription()}))},onSubscriptionError:function(t,e){this.dispatchToAll((function(s){null!=s.onSubscriptionError&&s.onSubscriptionError(t,e)}))},onUnsubscription:function(){this.dispatchToAll((function(t){null!=t.onUnsubscription&&t.onUnsubscription()}))},onRealMaxFrequency:function(t){this.dispatchToAll((function(e){null!=e.onRealMaxFrequency&&e.onRealMaxFrequency(t)}))},__class__:M});var D=N.LSSubscription=function(t,e,s,i){this.lock=new A,this.m_internal=!1,this.state=L.Inactive,this.eventDispatcher=new M,this.wrapper=i,this.mode=ms.fromString(t),this.initSnapshot(),this.initItemsAndFields("string"==typeof e?[e].slice():e,s)};D.__name__=!0,D.prototype={initSnapshot:function(){this.snapshot="RAW"==this.mode?null:us.SnpYes},initItemsAndFields:function(t,e){if(null!=t){if(null==e)throw new v("Please specify a valid field list");if(this.items=gs.fromArray(Oe.copy(t,t)),this.fields=vs.fromArray(Oe.copy(e,e)),"COMMAND"==this.mode&&-1==this.fields.indexOf("key"))throw new v("Field 'key' is missing");if("COMMAND"==this.mode&&-1==this.fields.indexOf("command"))throw new v("Field 'command' is missing")}else if(null!=e)throw new v("Please specify a valid item or item list")},addListener:function(t){this.eventDispatcher.addListenerAndFireOnListenStart(t,this)},removeListener:function(t){this.eventDispatcher.removeListenerAndFireOnListenEnd(t,this)},getListeners:function(){return this.eventDispatcher.getListeners().slice()},isActive:function(){return this.state!=L.Inactive},isSubscribed:function(){return this.state==L.Subscribed},getDataAdapter:function(){return this.dataAdapter},setDataAdapter:function(t){this.checkActive(),this.dataAdapter=Ss.fromString(t)},getMode:function(){return this.mode},getItems:function(){return null==this.items?null:this.items.slice()},fetchItems:function(){return this.items},setItems:function(t){this.checkActive(),this.items=gs.fromArray(null==t?null:Oe.copy(t,t)),this.group=null},getItemGroup:function(){return this.group},setItemGroup:function(t){this.checkActive(),this.group=Ss.fromString(t),this.items=null},getFields:function(){return null==this.fields?null:this.fields.slice()},fetchFields:function(){return this.fields},setFields:function(t){this.checkActive();var e=vs.fromArray(null==t?null:Oe.copy(t,t));if("COMMAND"==this.mode&&null!=e){if(-1==e.indexOf("command"))throw new v("Field 'command' is missing");if(-1==e.indexOf("key"))throw new v("Field 'key' is missing")}this.fields=e,this.schema=null},getFieldSchema:function(){return this.schema},setFieldSchema:function(t){this.checkActive(),this.schema=Ss.fromString(t),this.fields=null},getRequestedBufferSize:function(){return hs.toString(this.bufferSize)},setRequestedBufferSize:function(t){null!=t&&(t=null==t?"null":""+t),this.checkActive(),this.bufferSize=hs.fromString(t)},getRequestedSnapshot:function(){return ls.toString(this.snapshot)},setRequestedSnapshot:function(t){null!=t&&(t=null==t?"null":""+t),this.checkActive();var e=ls.fromString(t);switch(this.mode){case"COMMAND":case"MERGE":if(null!=e&&null!=e&&2==e._hx_index)throw new v("Snapshot length is not permitted if MERGE or COMMAND was specified as mode");break;case"RAW":if(null!=e)throw new v("Snapshot is not permitted if RAW was specified as mode")}this.snapshot=e},getRequestedMaxFrequency:function(){return ds.toString(this.requestedMaxFrequency)},setRequestedMaxFrequency:function(t){var e,s=this;null!=t&&(t=null==t?"null":""+t),this.lock.synchronized((function(){var i=ds.fromString(t);switch(s.mode){case"COMMAND":case"DISTINCT":case"MERGE":break;default:throw new v("The operation in only available on MERGE, DISTINCT and COMMAND Subscripitons")}if(s.isActive()&&(null==i||i==cs.FreqUnfiltered||s.requestedMaxFrequency==cs.FreqUnfiltered))throw new v("Cannot change the frequency from/to 'unfiltered' or to null while the Subscription is active");return null!=s.subId&&li.isInfoEnabled()&&li.info("Subscription "+s.subId+" requested max frequency changed: "+t),s.requestedMaxFrequency=i,e=s.manager})),null!=e&&e.evtExtConfigure()},getSelector:function(){return this.selector},setSelector:function(t){this.checkActive(),this.selector=Ss.fromString(t)},getCommandPosition:function(){if(this.checkCommand(),null==this.cmdIdx)throw new Me("The position of the command field is currently unknown");return this.cmdIdx},getKeyPosition:function(){if(this.checkCommand(),null==this.keyIdx)throw new Me("The position of the key field is currently unknown");return this.keyIdx},getCommandSecondLevelDataAdapter:function(){return this.dataAdapter2},setCommandSecondLevelDataAdapter:function(t){this.checkActive(),this.checkCommand(),this.dataAdapter2=Ss.fromString(t)},getCommandSecondLevelFields:function(){return null==this.fields2?null:this.fields2.slice()},setCommandSecondLevelFields:function(t){this.checkActive(),this.checkCommand(),this.fields2=vs.fromArray(null==t?null:Oe.copy(t,t)),this.schema2=null},getCommandSecondLevelFieldSchema:function(){return this.schema2},setCommandSecondLevelFieldSchema:function(t){this.checkActive(),this.checkCommand(),this.schema2=Ss.fromString(t),this.fields2=null},getValue:function(t,e){var s="number"==typeof t&&(0|t)===t,i="string"==typeof t,n="number"==typeof e&&(0|e)===e,r="string"==typeof e;if(s&&n)return this.getValuePosPos(t,e);if(s&&r)return this.getValuePosName(t,e);if(i&&n)return this.getValueNamePos(t,e);if(i&&r)return this.getValueNameName(t,e);throw new v("Invalid argument type")},getCommandValue:function(t,e,s){var i="number"==typeof t&&(0|t)===t,n="string"==typeof t,r="number"==typeof s&&(0|s)===s,a="string"==typeof s;if(i&&r)return this.getCommandValuePosPos(t,e,s);if(i&&a)return this.getCommandValuePosName(t,e,s);if(n&&r)return this.getCommandValueNamePos(t,e,s);if(n&&a)return this.getCommandValueNameName(t,e,s);throw new v("Invalid argument type")},getValuePosPos:function(t,e){var s,i=this;if(t<1||e<1)throw new v("The specified position is out of bounds");return this.lock.synchronized((function(){return s=i.manager})),null!=s?s.getValue(t,e):null},getValuePosName:function(t,e){var s=this;return this.getValuePosPos(t,this.lock.synchronized((function(){return s.getFieldPos(e)})))},getValueNamePos:function(t,e){var s=this;return this.getValuePosPos(this.lock.synchronized((function(){return s.getItemPos(t)})),e)},getValueNameName:function(t,e){var s=this;return this.getValuePosPos(this.lock.synchronized((function(){return s.getItemPos(t)})),this.lock.synchronized((function(){return s.getFieldPos(e)})))},getCommandValuePosPos:function(t,e,s){var i,n=this;if(this.checkCommand(),t<1||s<1)throw new v("The specified position is out of bounds");return this.lock.synchronized((function(){return i=n.manager})),null!=i?i.getCommandValue(t,e,s):null},getCommandValuePosName:function(t,e,s){var i=this;return this.getCommandValuePosPos(t,e,this.lock.synchronized((function(){return i.getFieldPos(s)})))},getCommandValueNamePos:function(t,e,s){var i=this;return this.getCommandValuePosPos(this.lock.synchronized((function(){return i.getItemPos(t)})),e,s)},getCommandValueNameName:function(t,e,s){var i=this;return this.getCommandValuePosPos(this.lock.synchronized((function(){return i.getItemPos(t)})),e,this.lock.synchronized((function(){return i.getFieldPos(s)})))},getItemPos:function(t){var e;if(null==this.items||-1==(e=gs.getPos(this.items,t)))throw new v("Unknown item name");return e},getFieldPos:function(t){var e;if(null==this.fields||-1==(e=vs.getPos(this.fields,t)))throw new v("Unknown field name");return e},checkActive:function(){if(this.isActive())throw new Me("Cannot modify an active Subscription. Please unsubscribe before applying any change")},checkCommand:function(){if("COMMAND"!=this.mode)throw new Me("This method can only be used on COMMAND subscriptions")},fetch_items:function(){return this.items},fetch_fields:function(){return this.fields},fetch_fields2:function(){return this.fields2},fetch_mode:function(){return this.mode},fetch_requestedBufferSize:function(){return this.bufferSize},fetch_requestedSnapshot:function(){return this.snapshot},fetch_requestedMaxFrequency:function(){return this.requestedMaxFrequency},fetch_nItems:function(){return this.nItems},fetch_subManager:function(){return this.manager},setActive:function(){this.state=L.Active},setInactive:function(){this.state=L.Inactive,this.subId=null,this.cmdIdx=null,this.keyIdx=null,this.nItems=null,this.nFields=null},setSubscribed:function(t,e,s){this.state=L.Subscribed,this.subId=t,this.nItems=e,this.nFields=s},setSubscribedCMD:function(t,e,s,i,n){this.state=L.Subscribed,this.subId=t,this.cmdIdx=i,this.keyIdx=n,this.nItems=e,this.nFields=s},fetch_nFields:function(){return this.nFields},isInternal:function(){return this.m_internal},setInternal:function(){this.m_internal=!0},getItemName:function(t){return null!=this.items?this.items[t-1]:null},relate:function(t){this.manager=t},unrelate:function(t){this.manager==t&&(this.manager=null)},hasSnapshot:function(){return!(null==this.snapshot||this.snapshot==us.SnpNo)},getItemNameOrPos:function(t){return null!=this.items?this.items[t-1]:""+t},fireOnSubscription:function(t){li.isInfoEnabled()&&li.info("Subscription "+t+" added"),this.eventDispatcher.onSubscription()},fireOnUnsubscription:function(t){li.isInfoEnabled()&&li.info("Subscription "+t+" deleted"),this.eventDispatcher.onUnsubscription()},fireOnSubscriptionError:function(t,e,s){li.isWarnEnabled()&&li.warn("Subscription "+t+" failed: "+e+" - "+s),this.eventDispatcher.onSubscriptionError(e,s)},fireOnEndOfSnapshot:function(t,e){li.isDebugEnabled()&&li.debug("Subscription "+e+":"+this.getItemNameOrPos(t)+": snapshot ended"),this.eventDispatcher.onEndOfSnapshot(this.getItemName(t),t)},fireOnClearSnapshot:function(t,e){li.isDebugEnabled()&&li.debug("Subscription "+e+":"+this.getItemNameOrPos(t)+": snapshot cleared"),this.eventDispatcher.onClearSnapshot(this.getItemName(t),t)},fireOnLostUpdates:function(t,e,s){li.isDebugEnabled()&&li.debug("Subscription "+s+":"+this.getItemNameOrPos(t)+": lost "+e+" updates"),this.eventDispatcher.onItemLostUpdates(this.getItemName(t),t,e)},fireOnItemUpdate:function(t,e){li.isDebugEnabled()&&li.debug("Subscription "+e+":"+this.getItemNameOrPos(t.getItemPos())+" update: "+l.string(t)),this.eventDispatcher.onItemUpdate(t)},fireOnRealMaxFrequency:function(t,e){li.isDebugEnabled()&&li.debug("Subscription "+e+" real max frequency changed: "+l.string(t)),this.eventDispatcher.onRealMaxFrequency(ys(t))},fireOnSubscriptionError2Level:function(t,e,s,i,n){li.isWarnEnabled()&&li.warn("Subscription "+i+":"+this.getItemNameOrPos(n)+":"+t+" failed: "+e+" - "+s),this.eventDispatcher.onCommandSecondLevelSubscriptionError(e,s,t)},fireOnLostUpdates2Level:function(t,e,s,i){li.isDebugEnabled()&&li.debug("Subscription "+s+":"+this.getItemNameOrPos(i)+":"+t+": lost "+e+" updates"),this.eventDispatcher.onCommandSecondLevelItemLostUpdates(e,t)},toString:function(){var t=Ce._new();return Ce.set(t,"mode",this.mode),Ce.set(t,"items",null!=this.items?l.string(this.items):this.group),Ce.set(t,"fields",null!=this.fields?l.string(this.fields):this.schema),Ce.set(t,"dataAdapter",this.dataAdapter),Ce.set(t,"requestedBufferSize",this.bufferSize),Ce.set(t,"requestedSnapshot",this.snapshot),Ce.set(t,"requestedMaxFrequency",this.requestedMaxFrequency),Ce.set(t,"selector",this.selector),Ce.set(t,"secondLevelFields",null!=this.fields2?l.string(this.fields2):this.schema2),Ce.set(t,"secondLevelDataAdapter",this.dataAdapter2),ks.stringify(t.h)},__class__:D};var O=function(){};O.__name__=!0,O.__isInterface__=!0,O.prototype={__class__:O};var P=function(t){this.frozen=!1,this.onEvent=t};P.__name__=!0,P.__interfaces__=[O],P.newLoggingInstance=function(){var t=new P((function(t){di.isWarnEnabled()&&di.warn(l.string(t)+" event detected")}));return t.startListening(),t},P.prototype={handleFrozen:function(){this.frozen=!0,this.onEvent(He.Frozen)},handleResumed:function(){this.frozen=!1,this.onEvent(He.Resumed)},startListening:function(){f.get_supported()&&(window.addEventListener("freeze",Vs(this,this.handleFrozen),{capture:!0}),window.addEventListener("resume",Vs(this,this.handleResumed),{capture:!0}))},stopListening:function(){f.get_supported()&&(window.removeEventListener("freeze",Vs(this,this.handleFrozen),{capture:!0}),window.removeEventListener("resume",Vs(this,this.handleResumed),{capture:!0}))},__class__:P};var k=function(){};k.__name__=!0,k.__interfaces__=[E],k.prototype={__class__:k};var F=function(){};F.__name__=!0,F.__super__=k,F.prototype=n(k.prototype,{fatal:function(t,e){},error:function(t,e){},warn:function(t,e){},info:function(t,e){},debug:function(t,e){},trace:function(t,e){},isFatalEnabled:function(){return!1},isErrorEnabled:function(){return!1},isWarnEnabled:function(){return!1},isInfoEnabled:function(){return!1},isDebugEnabled:function(){return!1},isTraceEnabled:function(){return!1},__class__:F});var A=function(){};A.__name__=!0,A.prototype={acquire:function(){},release:function(){},synchronized:function(t){var e=null,s=null;try{s=t()}catch(t){e=g.caught(t)}if(null!=e)throw g.thrown(e);return s},__class__:A};var q=function(){};q.__name__=!0,q.getLogger=function(t){return q.lock.synchronized((function(){var e=q.logInstances.h[t];if(null==e){var s=new B(null==q.currentLoggerProvider?q.emptyLogger:q.currentLoggerProvider.getLogger(t));q.logInstances.h[t]=s,e=s}return e}))},q.setLoggerProvider=function(t){q.lock.synchronized((function(){q.currentLoggerProvider=t;for(var e=q.logInstances.h,s=Object.keys(e),i=s.length,n=0;n<i;){var r=s[n++];e[r].wrappedLogger=null==q.currentLoggerProvider?q.emptyLogger:q.currentLoggerProvider.getLogger(r)}}))},q.newLogger=function(t){return null==q.currentLoggerProvider?q.emptyLogger:q.currentLoggerProvider.getLogger(t)};var B=function(t){this.wrappedLogger=t};B.__name__=!0,B.__super__=k,B.prototype=n(k.prototype,{fatal:function(t,e){this.wrappedLogger.fatal(t,e)},error:function(t,e){this.wrappedLogger.error(t,e)},warn:function(t,e){this.wrappedLogger.warn(t,e)},info:function(t,e){this.wrappedLogger.info(t,e)},debug:function(t,e){this.wrappedLogger.debug(t,e)},trace:function(t,e){this.wrappedLogger.trace(t,e)},isFatalEnabled:function(){return this.wrappedLogger.isFatalEnabled()},isErrorEnabled:function(){return this.wrappedLogger.isErrorEnabled()},isWarnEnabled:function(){return this.wrappedLogger.isWarnEnabled()},isInfoEnabled:function(){return this.wrappedLogger.isInfoEnabled()},isDebugEnabled:function(){return this.wrappedLogger.isDebugEnabled()},isTraceEnabled:function(){return this.wrappedLogger.isTraceEnabled()},__class__:B});var U=function(){};U.__name__=!0,U.getClass=function(t){if(null==t)return null;if(t instanceof Array)return Array;var e=t.__class__;if(null!=e)return e;var s=U.__nativeClassName(t);return null!=s?U.__resolveNativeClass(s):null},U.__string_rec=function(t,e){if(null==t)return"null";if(e.length>=5)return"<...>";var s=typeof t;switch("function"==s&&(t.__name__||t.__ename__)&&(s="object"),s){case"function":return"<function>";case"object":if(t.__enum__){var n=i[t.__enum__].__constructs__[t._hx_index],r=n._hx_name;return n.__params__?(e+="\t",r+"("+function(s){for(var i=[],r=0,a=n.__params__;r<a.length;){var o=a[r];r+=1,i.push(U.__string_rec(t[o],e))}return i}().join(",")+")"):r}if(t instanceof Array){var a="[";e+="\t";for(var o=0,h=t.length;o<h;){var u=o++;a+=(u>0?",":"")+U.__string_rec(t[u],e)}return a+="]"}var l;try{l=t.toString}catch(o){return"???"}if(null!=l&&l!=Object.toString&&"function"==typeof l){var c=t.toString();if("[object Object]"!=c)return c}a="{\n",e+="\t";var d=null!=t.hasOwnProperty,_=null;for(_ in t)d&&!t.hasOwnProperty(_)||"prototype"!=_&&"__class__"!=_&&"__super__"!=_&&"__interfaces__"!=_&&"__properties__"!=_&&(2!=a.length&&(a+=", \n"),a+=e+_+" : "+U.__string_rec(t[_],e));return a+="\n"+(e=e.substring(1))+"}";case"string":return t;default:return String(t)}},U.__interfLoop=function(t,e){for(;;){if(null==t)return!1;if(t==e)return!0;var s=t.__interfaces__;if(null!=s)for(var i=0,n=s.length;i<n;){var r=s[i++];if(r==e||U.__interfLoop(r,e))return!0}t=t.__super__}},U.__instanceof=function(t,e){if(null==e)return!1;switch(e){case Array:return t instanceof Array;case Ks:return"boolean"==typeof t;case Ys:return null!=t;case Gs:return"number"==typeof t;case zs:return"number"==typeof t&&(0|t)===t;case String:return"string"==typeof t;default:if(null==t)return!1;if("function"==typeof e){if(U.__downcastCheck(t,e))return!0}else if("object"==typeof e&&U.__isNativeObj(e)&&t instanceof e)return!0;return e==js&&null!=t.__name__||e==Qs&&null!=t.__ename__||null!=t.__enum__&&i[t.__enum__]==e}},U.__downcastCheck=function(t,e){return t instanceof e||!!e.__isInterface__&&U.__interfLoop(U.getClass(t),e)},U.__cast=function(t,e){if(null==t||U.__instanceof(t,e))return t;throw g.thrown("Cannot cast "+l.string(t)+" to "+l.string(e))},U.__nativeClassName=function(t){var e=U.__toStr.call(t).slice(8,-1);return"Object"==e||"Function"==e||"Math"==e||"JSON"==e?null:e},U.__isNativeObj=function(t){return null!=U.__nativeClassName(t)},U.__resolveNativeClass=function(e){return t[e]};var W=function(t,e){this.slw_m=.5,this.slw_hugeDelayMs=2e4,this.slw_maxAvgDelayMs=7e3,this.slw_avgDelayMs=0,this.slw_refTime=0,this.rec_clientProg=0,this.rec_serverProg=0,this.subscriptionManagers=new Fe,this.messageManagers=new xe,this.sequenceMap=new ks,this.disabledTransports=new je,this.suspendedTransports=new je,this.ctrl_connectTs=0,this.recoverTs=0,this.connectTs=0,this.m_nextSubId=0,this.m_nextReqId=0,this.m_status="DISCONNECTED",this.delayCounter=new At,this.state=new it,this.client=t,this.lock=t.lock,this.details=t.connectionDetails,this.options=t.connectionOptions,this.wsFactory=Vs(e,e.createWsClient),this.httpFactory=Vs(e,e.createHttpClient),this.ctrlFactory=Vs(e,e.createCtrlClient),this.timerFactory=Vs(e,e.createTimer),this.randomGenerator=Vs(e,e.randomMillis),this.reachabilityFactory=Vs(e,e.createReachabilityManager),this.frz_pageLifecycleFactory=Vs(e,e.createPageLifecycleFactory),this.clientEventDispatcher=t.eventDispatcher,this.switchRequest=new X(this),this.constrainRequest=new Z(this),this.delayCounter.reset(this.options.retryDelay)};W.__name__=!0,W.prototype={disposeSession:function(){this.disposeWS(),this.disposeHTTP(),this.disposeCtrl(),this.details.setServerInstanceAddress(null),this.details.setSessionId(null),this.details.setServerSocketName(null),this.details.setClientIp(null),this.options.setRealMaxBandwidth(null),this.lastKnownClientIp=null,this.resetSequenceMap(),this.rec_serverProg=0,this.rec_clientProg=0,this.bw_lastReqId=null,this.bw_requestedMaxBandwidth=null,this.swt_lastReqId=null},disposeClient:function(){this.sessionId=null,this.enableAllTransports(),this.resetCurrentRetryDelay(),this.resetSequenceMap(),this.cause=null},evtExtConnect:function(){this.traceEvent("connect");var t,e=!0;100==this.state.s_m&&(W.frz_globalPageLifecycle.frozen?(di.isWarnEnabled()&&di.warn("connection requested while page is frozen"),this.cause="page.frozen",this.resetCurrentRetryDelay(),this.doInstallPageLifecycle(),this.state.s_m=117,this.state.traceState(),e=this.evtExtConnect_NextRegion(),null!=(t=this.frz_pageLifecycle)&&t.startListening(),this.evtRetry(Y.page_frozen)):(this.cause="api",this.resetCurrentRetryDelay(),this.doInstallPageLifecycle(),this.state.s_m=101,this.state.traceState(),e=this.evtExtConnect_NextRegion(),null!=(t=this.frz_pageLifecycle)&&t.startListening(),this.evtSelectCreate())),e&&this.evtExtConnect_NextRegion()},evtExtConnect_NextRegion:function(){return this.evtExtConnect_NetworkReachabilityRegion()},evtExtConnect_NetworkReachabilityRegion:function(){var t=this;if(1400==this.state.s_nr){var e=new Es(this.getServerAddress()).get_hostname();this.nr_reachabilityManager=this.reachabilityFactory(e),this.state.s_nr=1410,this.state.traceState(),this.nr_reachabilityManager.startListening((function(s){switch(s._hx_index){case 0:t.evtNetworkReachable(e);break;case 1:t.evtNetworkNotReachable(e)}}))}return!1},doInstallPageLifecycle:function(){var t=this;this.frz_pageLifecycle=this.frz_pageLifecycleFactory((function(e){switch(e._hx_index){case 0:t.evtPageFrozen();break;case 1:t.evtPageResumed()}}))},doUnistallPageLifecycle:function(){var t=this.frz_pageLifecycle;null!=t&&t.stopListening(),this.frz_pageLifecycle=null},evtPageFrozen:function(){switch(this.traceEvent("page.frozen"),this.state.s_m){case 110:case 111:case 112:case 113:case 114:case 115:case 116:this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="page.frozen",this.state.s_m=117,this.state.traceState(),this.cancel_evtRetryTimeout();break;case 120:case 121:case 122:this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="page.frozen",this.state.s_m=117,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtRetry(Y.page_frozen);break;case 130:case 140:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="page.frozen",this.state.s_m=117,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtRetry(Y.page_frozen);break;case 150:var t=this.state.s_tr;if(null!=t)switch(t){case 210:this.sendDestroyWS("page.frozen"),this.closeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="page.frozen",this.state.clear_w(),this.state.goto_m_from_session(117),this.exit_w(),this.evtEndSession(),this.evtRetry(Y.page_frozen);break;case 220:case 230:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="page.frozen",this.state.goto_m_from_session(117),this.cancel_evtTransportTimeout(),this.evtEndSession(),this.evtRetry(Y.page_frozen);break;case 240:var e;if(500==(null!=(i=this.state.s_ws)?i.m:null))this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="page.frozen",this.state.goto_m_from_ws(117),this.exit_ws_to_m(),this.evtRetry(Y.page_frozen);else(i=!!(s=501==(null!=(e=this.state.s_ws)?e.m:null)||502==(null!=(e=this.state.s_ws)?e.m:null))||503==(null!=(s=this.state.s_ws)?s.m:null))&&(this.sendDestroyWS("page.frozen"),this.closeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="page.frozen",this.state.goto_m_from_ws(117),this.exit_ws_to_m(),this.evtRetry(Y.page_frozen));break;case 250:var s,i;(i=600==(null!=(s=this.state.s_wp)?s.m:null)||601==(null!=(s=this.state.s_wp)?s.m:null))?(this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="page.frozen",this.state.goto_m_from_wp(117),this.exit_ws_to_m(),this.evtRetry(Y.page_frozen)):602==(null!=(i=this.state.s_wp)?i.m:null)&&(this.sendDestroyWS("page.frozen"),this.closeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="page.frozen",this.state.goto_m_from_wp(117),this.exit_wp_to_m(),this.evtRetry(Y.page_frozen));break;case 260:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="page.frozen",this.state.goto_m_from_rec(117),this.exit_rec_to_m(),this.evtRetry(Y.page_frozen);break;case 270:710==this.state.s_h?(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="page.frozen",this.state.goto_m_from_hs(117),this.exit_hs_to_m(),this.evtRetry(Y.page_frozen)):720==this.state.s_h&&(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="page.frozen",this.state.goto_m_from_hp(117),this.exit_hp_to_m(),this.evtRetry(Y.page_frozen))}}},evtPageResumed:function(){this.traceEvent("page.resumed"),117==this.state.s_m&&(this.state.s_m=116,this.state.traceState(),this.evtSelectCreate())},evtNetworkNotReachable:function(t){ui.isInfoEnabled()&&ui.info(t+" is NOT reachable"),this.traceEvent("nr:network.not.reachable"),(1410==this.state.s_nr||1412==this.state.s_nr)&&(this.state.s_nr=1411,this.state.traceState())},evtNetworkReachable:function(t){ui.isInfoEnabled()&&ui.info(t+" is reachable"),this.traceEvent("nr:network.reachable"),1410==this.state.s_nr?(this.state.s_nr=1412,this.state.traceState()):1411==this.state.s_nr&&(this.state.s_nr=1412,this.state.traceState(),this.evtOnlineAgain())},evtOnlineAgain:function(){this.traceEvent("online.again"),112==this.state.s_m?(this.state.s_m=116,this.state.traceState(),this.cancel_evtRetryTimeout(),this.evtSelectCreate()):1003==this.state.s_rec&&(this.sendRecovery(),this.state.s_rec=1001,this.state.traceState(),this.cancel_evtRetryTimeout(),this.schedule_evtTransportTimeout(this.options.retryDelay))},evtServerAddressChanged:function(){var t=this;switch(this.traceEvent("nr:serverAddress.changed"),this.state.s_nr){case 1410:case 1411:case 1412:var e=this.nr_reachabilityManager,s=new Es(this.getServerAddress()).get_hostname();this.nr_reachabilityManager=this.reachabilityFactory(s),this.state.s_nr=1410,this.state.traceState(),null!=e&&e.stopListening(),this.nr_reachabilityManager.startListening((function(e){switch(e._hx_index){case 0:t.evtNetworkReachable(s);break;case 1:t.evtNetworkNotReachable(s)}}))}},evtExtDisconnect:function(t){switch(this.traceEvent("disconnect: cause="+l.string(t)),this.state.s_m){case 110:case 111:case 112:case 113:case 114:case 115:case 116:case 117:this.notifyStatus("DISCONNECTED"),this.notifyServerErrorIfCauseIsError(t),this.state.s_m=100,this.state.traceState(),this.cancel_evtRetryTimeout(),this.evtTerminate(t);break;case 120:case 121:case 122:this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerErrorIfCauseIsError(t),this.state.s_m=100,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtTerminate(t);break;case 130:case 140:this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerErrorIfCauseIsError(t),this.state.s_m=100,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtTerminate(t);break;case 150:var e=this.state.s_tr;if(null!=e)switch(e){case 210:this.sendDestroyWS(),this.closeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerErrorIfCauseIsError(t),this.state.clear_w(),this.state.goto_m_from_session(100),this.exit_w(),this.evtEndSession(),this.evtTerminate(t);break;case 220:case 230:this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerErrorIfCauseIsError(t),this.state.goto_m_from_session(100),this.cancel_evtTransportTimeout(),this.evtEndSession(),this.evtTerminate(t);break;case 240:var s;if(500==(null!=(n=this.state.s_ws)?n.m:null))this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerErrorIfCauseIsError(t),this.state.goto_m_from_ws(100),this.exit_ws_to_m(),this.evtTerminate(t);else(n=!!(i=501==(null!=(s=this.state.s_ws)?s.m:null)||502==(null!=(s=this.state.s_ws)?s.m:null))||503==(null!=(i=this.state.s_ws)?i.m:null))&&(this.sendDestroyWS(),this.closeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerErrorIfCauseIsError(t),this.state.goto_m_from_ws(100),this.exit_ws_to_m(),this.evtTerminate(t));break;case 250:var i,n;(n=600==(null!=(i=this.state.s_wp)?i.m:null)||601==(null!=(i=this.state.s_wp)?i.m:null))?(this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerErrorIfCauseIsError(t),this.state.goto_m_from_wp(100),this.exit_ws_to_m(),this.evtTerminate(t)):602==(null!=(n=this.state.s_wp)?n.m:null)&&(this.sendDestroyWS(),this.closeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerErrorIfCauseIsError(t),this.state.goto_m_from_wp(100),this.exit_wp_to_m(),this.evtTerminate(t));break;case 260:this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerErrorIfCauseIsError(t),this.state.goto_m_from_rec(100),this.exit_rec_to_m(),this.evtTerminate(t);break;case 270:710==this.state.s_h?(this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerErrorIfCauseIsError(t),this.state.goto_m_from_hs(100),this.exit_hs_to_m(),this.evtTerminate(t)):720==this.state.s_h&&(this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerErrorIfCauseIsError(t),this.state.goto_m_from_hp(100),this.exit_hp_to_m(),this.evtTerminate(t))}}},evtSelectCreate:function(){if(this.traceEvent("select.create"),101==this.state.s_m||116==this.state.s_m)switch(this.getBestForCreating()._hx_index){case 0:this.notifyStatus("CONNECTING"),this.openWS_Create(),this.state.s_m=120,this.state.traceState(),this.evtCreate(),this.schedule_evtTransportTimeout(this.delayCounter.get_currentRetryDelay());break;case 1:this.notifyStatus("CONNECTING"),this.sendCreateHTTP(),this.state.s_m=130,this.state.traceState(),this.evtCreate(),this.schedule_evtTransportTimeout(this.delayCounter.get_currentRetryDelay());break;case 2:this.notifyStatus("DISCONNECTED"),this.state.s_m=100,this.state.traceState(),this.evtTerminate(G.TC_otherError("Unable to select a transport"))}},evtWSOpen:function(){var t;this.traceEvent("ws.open"),120==this.state.s_m?(this.sendCreateWS(),this.state.s_m=121,this.state.traceState()):500==(null!=(t=this.state.s_ws)?t.m:null)?(this.sendBindWS_Streaming(),this.state.s_ws.m=501,this.state.traceState()):600==(null!=(t=this.state.s_wp)?t.m:null)&&(Pe.sure(this.ws).send("wsok"),this.state.s_wp.m=601,this.state.traceState())},evtMessage:function(t){var e=!0;if(d.startsWith(t,"U,")){var s=Nt(t);this.evtU(s.subId,s.itemIdx,s.values,t)}else if(d.startsWith(t,"REQOK"))"REQOK"==t?this.evtREQOK_withoutReqId():this.evtREQOK(Ct(t.split(",")[1]));else if(d.startsWith(t,"PROBE"))this.evtPROBE();else if(d.startsWith(t,"LOOP"))this.evtLOOP(Ct(t.split(",")[1]));else if(d.startsWith(t,"CONOK")){var i=t.split(",");this.evtCONOK(i[1],Ct(i[2]),Ct(i[3]),i[4])}else if(d.startsWith(t,"WSOK"))this.evtWSOK();else if(d.startsWith(t,"SERVNAME"))this.evtSERVNAME(t.split(",")[1]);else if(d.startsWith(t,"CLIENTIP"))this.evtCLIENTIP(t.split(",")[1]);else if(d.startsWith(t,"CONS")){var n=t.split(",")[1];switch(n){case"unlimited":this.evtCONS(ps.BWUnlimited);break;case"unmanaged":this.evtCONS(ps.BWUnmanaged);break;default:this.evtCONS(ps.BWLimited(xt(n)))}}else if(d.startsWith(t,"MSGDONE")){"*"==(o=(i=t.split(","))[1])&&(o="UNORDERED_MESSAGES");var r=Ct(i[2]),a=i[3];this.evtMSGDONE(o,r,""==a?"":Dt(a))}else if(d.startsWith(t,"MSGFAIL")){var o;"*"==(o=(i=t.split(","))[1])&&(o="UNORDERED_MESSAGES"),this.evtMSGFAIL(o,Ct(i[2]),Ct(i[3]),Dt(i[4]))}else if(d.startsWith(t,"REQERR"))i=t.split(","),this.evtREQERR(Ct(i[1]),Ct(i[2]),Dt(i[3]));else if(d.startsWith(t,"PROG"))this.evtPROG(Ct(t.split(",")[1]));else if(d.startsWith(t,"SUBOK"))i=t.split(","),this.evtSUBOK(Ct(i[1]),Ct(i[2]),Ct(i[3]));else if(d.startsWith(t,"SUBCMD"))i=t.split(","),this.evtSUBCMD(Ct(i[1]),Ct(i[2]),Ct(i[3]),Ct(i[4]),Ct(i[5]));else if(d.startsWith(t,"UNSUB"))this.evtUNSUB(Ct(t.split(",")[1]));else if(d.startsWith(t,"CONF")){var h=Ct((i=t.split(","))[1]);"unlimited"==i[2]?this.evtCONF(h,_s.RFreqUnlimited):this.evtCONF(h,_s.RFreqLimited(xt(i[2])))}else d.startsWith(t,"EOS")?(i=t.split(","),this.evtEOS(Ct(i[1]),Ct(i[2]))):d.startsWith(t,"CS")?(i=t.split(","),this.evtCS(Ct(i[1]),Ct(i[2]))):d.startsWith(t,"OV")?(i=t.split(","),this.evtOV(Ct(i[1]),Ct(i[2]),Ct(i[3]))):d.startsWith(t,"NOOP")?this.evtNOOP():d.startsWith(t,"CONERR")?(i=t.split(","),this.evtCONERR(Ct(i[1]),Dt(i[2]))):d.startsWith(t,"END")?(i=t.split(","),this.evtEND(Ct(i[1]),Dt(i[2]))):d.startsWith(t,"ERROR")?(i=t.split(","),this.evtERROR(Ct(i[1]),Dt(i[2]))):d.startsWith(t,"SYNC")?this.evtSYNC(Ct(t.split(",")[1])):e=!1;return e},evtCtrlMessage:function(t){if(d.startsWith(t,"REQOK"))"REQOK"==t?this.evtREQOK_withoutReqId():this.evtREQOK(Ct(t.split(",")[1]));else if(d.startsWith(t,"REQERR")){var e=t.split(",");this.evtREQERR(Ct(e[1]),Ct(e[2]),Dt(e[3]))}else d.startsWith(t,"ERROR")&&(e=t.split(","),this.evtERROR(Ct(e[1]),Dt(e[2])))},evtTransportTimeout:function(){switch(this.traceEvent("transport.timeout"),this.state.s_m){case 120:case 121:this.suspendWS_Streaming(),this.disposeWS(),this.cause="ws.unavailable",this.state.s_m=115,this.state.traceState(),this.cancel_evtTransportTimeout(),this.entry_m115(Y.ws_unavailable);break;case 122:this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.timeout",this.state.s_m=112,this.state.traceState(),this.cancel_evtTransportTimeout(),this.entry_m112(Y.ws_timeout);break;case 130:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.timeout",this.state.s_m=112,this.state.traceState(),this.cancel_evtTransportTimeout(),this.entry_m112(Y.http_timeout);break;case 140:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ttl.timeout";var t=this.waitingInterval(this.delayCounter.get_currentRetryDelay(),this.connectTs);this.state.s_m=111,this.state.traceState(),this.cancel_evtTransportTimeout(),this.entry_m111(Y.http_error,t);break;case 150:if(null!=(s=this.state.s_tr))switch(s){case 220:0==this.options.sessionRecoveryTimeout?(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.timeout",this.state.goto_m_from_session(112),this.cancel_evtTransportTimeout(),this.evtEndSession(),this.entry_m112(Y.http_timeout)):(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="http.timeout",t=this.randomGenerator(this.options.firstRetryMaxDelay),this.state.goto_rec(),this.cancel_evtTransportTimeout(),this.entry_rec(t,Y.http_timeout));break;case 230:0==this.options.sessionRecoveryTimeout?(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ttl.timeout",this.state.goto_m_from_session(112),this.cancel_evtTransportTimeout(),this.evtEndSession(),this.entry_m112(Y.http_timeout)):(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="ttl.timeout",t=this.randomGenerator(this.options.firstRetryMaxDelay),this.state.goto_rec(),this.cancel_evtTransportTimeout(),this.entry_rec(t,Y.http_error));break;case 240:if(null!=(s=null!=(e=this.state.s_ws)?e.m:null))switch(s){case 500:this.disableWS(),this.disposeWS(),this.cause="ws.unavailable",this.state.clear_ws(),this.state.s_tr=200,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtSwitchTransport();break;case 501:0==this.options.sessionRecoveryTimeout?(this.disableWS(),this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.unavailable",this.state.goto_m_from_ws(112),this.exit_ws_to_m(),this.entry_m112(Y.ws_unavailable)):(this.disableWS(),this.disposeWS(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="ws.unavailable",t=this.randomGenerator(this.options.firstRetryMaxDelay),this.state.goto_rec_from_ws(),this.exit_ws(),this.entry_rec(t,Y.ws_unavailable));break;case 502:0==this.options.sessionRecoveryTimeout?(this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.timeout",this.state.goto_m_from_ws(112),this.exit_ws_to_m(),this.entry_m112(Y.ws_timeout)):(this.disposeWS(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="ws.timeout",t=this.randomGenerator(this.options.firstRetryMaxDelay),this.state.goto_rec_from_ws(),this.exit_ws(),this.entry_rec(t,Y.ws_timeout))}break;case 250:if(null!=(s=null!=(e=this.state.s_wp)?e.m:null))switch(s){case 600:case 601:this.disableWS(),this.disposeWS(),this.cause="ws.unavailable",this.state.clear_wp(),this.state.s_tr=200,this.state.traceState(),this.exit_wp(),this.evtSwitchTransport()}break;case 260:1001==this.state.s_rec&&(this.disposeHTTP(),this.state.s_rec=1002,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtCheckRecoveryTimeout(K.RRC_transport_timeout));break;case 270:var e,s;if(null!=(s=this.state.s_h)&&710==s&&null!=(s=null!=(e=this.state.s_hs)?e.m:null))switch(s){case 800:this.disableHTTP_Streaming(),this.cause="http.streaming.unavailable",this.state.s_hs.m=801,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtForcePolling(),this.schedule_evtTransportTimeout(this.options.retryDelay);break;case 801:0==this.options.sessionRecoveryTimeout?(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.timeout",this.state.goto_m_from_hs(112),this.exit_hs_to_m(),this.entry_m112(Y.http_timeout)):(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="http.timeout",t=this.randomGenerator(this.options.firstRetryMaxDelay),this.state.goto_rec_from_hs(),this.exit_hs_to_rec(),this.entry_rec(t,Y.http_timeout))}}}},evtTransportError:function(){switch(this.traceEvent("transport.error"),this.state.s_m){case 120:case 121:this.suspendWS_Streaming(),this.disposeWS(),this.cause="ws.unavailable",this.state.s_m=115,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtRetry(Y.ws_unavailable),this.evtRetryTimeout();break;case 122:this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.error";var t=this.waitingInterval(this.delayCounter.get_currentRetryDelay(),this.connectTs);this.state.s_m=112,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtRetry(Y.ws_error,t),this.schedule_evtRetryTimeout(t);break;case 130:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.error",t=this.waitingInterval(this.delayCounter.get_currentRetryDelay(),this.connectTs),this.state.s_m=112,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtRetry(Y.http_error,t),this.schedule_evtRetryTimeout(t);break;case 140:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ttl.error",t=this.waitingInterval(this.delayCounter.get_currentRetryDelay(),this.connectTs),this.state.s_m=111,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtRetry(Y.http_error,t),this.schedule_evtRetryTimeout(t);break;case 150:var e=this.state.s_tr;if(null!=e)switch(e){case 210:0==this.options.sessionRecoveryTimeout?(this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.error",this.state.clear_w(),this.state.goto_m_from_session(113),this.exit_w(),this.evtEndSession(),this.entry_m113(Y.ws_error)):(this.disposeWS(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="ws.error",t=this.randomGenerator(this.options.firstRetryMaxDelay),this.state.clear_w(),this.state.s_tr=260,this.state.s_rec=1e3,this.state.traceState(),this.exit_w(),this.entry_rec(t,Y.ws_error));break;case 220:0==this.options.sessionRecoveryTimeout?(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.error",t=this.waitingInterval(this.delayCounter.get_currentRetryDelay(),this.connectTs),this.state.goto_m_from_session(112),this.cancel_evtTransportTimeout(),this.evtEndSession(),this.evtRetry(Y.http_error,t),this.schedule_evtRetryTimeout(t)):(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="http.error",t=this.randomGenerator(this.options.firstRetryMaxDelay),this.state.goto_rec(),this.cancel_evtTransportTimeout(),this.entry_rec(t,Y.http_error));break;case 230:0==this.options.sessionRecoveryTimeout?(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ttl.error",t=this.waitingInterval(this.delayCounter.get_currentRetryDelay(),this.connectTs),this.state.goto_m_from_session(112),this.cancel_evtTransportTimeout(),this.evtEndSession(),this.evtRetry(Y.http_error,t),this.schedule_evtRetryTimeout(t)):(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="ttl.error",t=this.randomGenerator(this.options.firstRetryMaxDelay),this.state.goto_rec(),this.cancel_evtTransportTimeout(),this.entry_rec(t,Y.http_error));break;case 240:switch(Pe.sure(this.state.s_ws).m){case 500:this.disableWS(),this.disposeWS(),this.cause="ws.unavailable",this.state.clear_ws(),this.state.s_tr=200,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtSwitchTransport();break;case 501:0==this.options.sessionRecoveryTimeout?(this.disableWS(),this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.unavailable",this.state.goto_m_from_ws(112),this.exit_ws_to_m(),this.entry_m112(Y.ws_unavailable)):(this.disableWS(),this.disposeWS(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="ws.unavailable",t=this.randomGenerator(this.options.firstRetryMaxDelay),this.state.goto_rec_from_ws(),this.exit_ws(),this.entry_rec(t,Y.ws_unavailable));break;case 502:0==this.options.sessionRecoveryTimeout?(this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.error",this.state.goto_m_from_ws(112),this.exit_ws_to_m(),this.entry_m112(Y.ws_error)):(this.disposeWS(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="ws.error",t=this.randomGenerator(this.options.firstRetryMaxDelay),this.state.goto_rec_from_ws(),this.cancel_evtTransportTimeout(),this.entry_rec(t,Y.ws_error));break;case 503:0==this.options.sessionRecoveryTimeout?(this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.error",this.state.goto_m_from_ws(113),this.exit_ws_to_m(),this.entry_m113(Y.ws_error)):(this.disposeWS(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="ws.error",t=this.randomGenerator(this.options.firstRetryMaxDelay),this.state.goto_rec_from_ws(),this.exit_ws(),this.entry_rec(t,Y.ws_error))}break;case 250:switch(Pe.sure(this.state.s_wp).m){case 600:case 601:this.disableWS(),this.disposeWS(),this.cause="ws.unavailable",this.state.clear_wp(),this.state.s_tr=200,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtSwitchTransport();break;case 602:0==this.options.sessionRecoveryTimeout?(this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.error",this.state.goto_m_from_wp(113),this.exit_wp_to_m(),this.entry_m113(Y.ws_error)):(this.disposeWS(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="ws.error",t=this.randomGenerator(this.options.firstRetryMaxDelay),this.state.goto_rec_from_wp(),this.exit_wp(),this.entry_rec(t,Y.ws_error))}break;case 260:1001==this.state.s_rec&&(this.disposeHTTP(),this.state.s_rec=1002,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtCheckRecoveryTimeout(K.RRC_transport_error));break;case 270:switch(Pe.sure(this.state.s_h)){case 710:switch(Pe.sure(this.state.s_hs).m){case 800:case 801:0==this.options.sessionRecoveryTimeout?(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.error",this.state.goto_m_from_hs(112),this.exit_hs_to_m(),this.entry_m112(Y.http_error)):(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="http.error",t=this.randomGenerator(this.options.firstRetryMaxDelay),this.state.goto_rec_from_hs(),this.exit_hs_to_rec(),this.entry_rec(t,Y.http_error));break;case 802:0==this.options.sessionRecoveryTimeout?(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.error",this.state.goto_m_from_hs(113),this.exit_hs_to_m(),this.entry_m113(Y.http_error)):(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="http.error",t=this.randomGenerator(this.options.firstRetryMaxDelay),this.state.goto_rec_from_hs(),this.exit_hs_to_rec(),this.entry_rec(t,Y.http_error))}break;case 720:switch(Pe.sure(this.state.s_hp).m){case 900:case 901:case 902:case 903:case 904:0==this.options.sessionRecoveryTimeout?(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.error",this.state.goto_m_from_hp(112),this.exit_hp_to_m(),this.entry_m112(Y.http_error)):(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="http.error",t=this.randomGenerator(this.options.firstRetryMaxDelay),this.state.goto_rec_from_hp(),this.exit_hp_to_rec(),this.entry_rec(t,Y.http_error))}}}}},evtIdleTimeout:function(){if(this.traceEvent("idle.timeout"),null==(i=null!=(s=this.state.s_wp)?s.p:null))e=!1;else switch(i){case 610:case 611:case 613:e=!0;break;default:e=!1}if(e)if(0==this.options.sessionRecoveryTimeout)this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.idle.timeout",this.state.goto_m_from_wp(113),this.exit_wp_to_m(),this.entry_m113(Y.idle_timeout);else{this.disposeWS(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="ws.idle.timeout";var t=this.randomGenerator(this.options.firstRetryMaxDelay);this.state.goto_rec_from_wp(),this.exit_wp(),this.entry_rec(t,Y.idle_timeout)}else{var e,s,i;if(null==(i=null!=(s=this.state.s_hp)?s.m:null))e=!1;else switch(i){case 900:case 901:case 903:e=!0;break;default:e=!1}e&&(0==this.options.sessionRecoveryTimeout?(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.idle.timeout",this.state.goto_m_from_hp(112),this.exit_hp_to_m(),this.entry_m112(Y.idle_timeout)):(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="http.idle.timeout",t=this.randomGenerator(this.options.firstRetryMaxDelay),this.state.goto_rec_from_hp(),this.exit_hp_to_rec(),this.entry_rec(t,Y.idle_timeout)))}},evtPollingTimeout:function(){var t;this.traceEvent("polling.timeout"),612==(null!=(t=this.state.s_wp)?t.p:null)?(this.sendBindWS_Polling(),this.state.s_wp.p=613,this.state.traceState(),this.cancel_evtPollingTimeout(),this.schedule_evtIdleTimeout(ss.plus(Pe.sure(this.idleTimeout),this.options.retryDelay))):902==(null!=(t=this.state.s_hp)?t.m:null)&&(this.sendBindHTTP_Polling(),this.state.s_hp.m=903,this.state.traceState(),this.cancel_evtPollingTimeout(),this.schedule_evtIdleTimeout(ss.plus(Pe.sure(this.idleTimeout),this.options.retryDelay)))},evtKeepaliveTimeout:function(){var t;this.traceEvent("keepalive.timeout"),310==(null!=(t=this.state.s_w)?t.k:null)?(this.state.s_w.k=311,this.state.traceState(),this.cancel_evtKeepaliveTimeout(),this.schedule_evtStalledTimeout(this.options.stalledTimeout)):520==(null!=(t=this.state.s_ws)?t.k:null)?(this.state.s_ws.k=521,this.state.traceState(),this.cancel_evtKeepaliveTimeout(),this.schedule_evtStalledTimeout(this.options.stalledTimeout)):820==(null!=(t=this.state.s_hs)?t.k:null)&&(this.state.s_hs.k=821,this.state.traceState(),this.cancel_evtKeepaliveTimeout(),this.schedule_evtStalledTimeout(this.options.stalledTimeout))},evtStalledTimeout:function(){var t;this.traceEvent("stalled.timeout"),311==(null!=(t=this.state.s_w)?t.k:null)?(this.state.s_w.k=312,this.state.traceState(),this.cancel_evtStalledTimeout(),this.schedule_evtReconnectTimeout(this.options.reconnectTimeout)):521==(null!=(t=this.state.s_ws)?t.k:null)?(this.state.s_ws.k=522,this.state.traceState(),this.cancel_evtStalledTimeout(),this.schedule_evtReconnectTimeout(this.options.reconnectTimeout)):821==(null!=(t=this.state.s_hs)?t.k:null)&&(this.state.s_hs.k=822,this.state.traceState(),this.cancel_evtStalledTimeout(),this.schedule_evtReconnectTimeout(this.options.reconnectTimeout))},evtReconnectTimeout:function(){var t;if(this.traceEvent("reconnect.timeout"),312==(null!=(t=this.state.s_w)?t.k:null))if(0==this.options.sessionRecoveryTimeout)this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.stalled",this.state.goto_m_from_w(113),this.exit_w_to_m(),this.entry_m113(Y.stalled_timeout);else{this.disposeWS(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="ws.stalled";var e=this.randomGenerator(this.options.firstRetryMaxDelay);this.state.goto_rec_from_w(),this.exit_w(),this.entry_rec(e,Y.stalled_timeout)}else 522==(null!=(t=this.state.s_ws)?t.k:null)?0==this.options.sessionRecoveryTimeout?(this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.stalled",this.state.goto_m_from_ws(113),this.exit_ws_to_m(),this.entry_m113(Y.stalled_timeout)):(this.disposeWS(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="ws.stalled",e=this.randomGenerator(this.options.firstRetryMaxDelay),this.state.goto_rec_from_ws(),this.exit_ws(),this.entry_rec(e,Y.stalled_timeout)):822==(null!=(t=this.state.s_hs)?t.k:null)&&(0==this.options.sessionRecoveryTimeout?(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.stalled",this.state.goto_m_from_hs(113),this.exit_hs_to_m(),this.entry_m113(Y.stalled_timeout)):(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:TRYING-RECOVERY"),this.cause="http.stalled",e=this.randomGenerator(this.options.firstRetryMaxDelay),this.state.goto_rec_from_hs(),this.exit_hs_to_rec(),this.entry_rec(e,Y.stalled_timeout)))},evtRestartKeepalive:function(){var t;this.traceEvent("restart.keepalive"),null!=(null!=(t=this.state.s_w)?t.k:null)?(this.state.s_w.k=310,this.state.traceState(),this.exit_keepalive_unit(),this.schedule_evtKeepaliveTimeout(Pe.sure(this.keepaliveInterval))):null!=(null!=(t=this.state.s_ws)?t.k:null)?(this.state.s_ws.k=520,this.state.traceState(),this.exit_keepalive_unit(),this.schedule_evtKeepaliveTimeout(Pe.sure(this.keepaliveInterval))):null!=(null!=(t=this.state.s_hs)?t.k:null)&&(this.state.s_hs.k=820,this.state.traceState(),this.exit_keepalive_unit(),this.schedule_evtKeepaliveTimeout(Pe.sure(this.keepaliveInterval)))},evtWSOK:function(){switch(this.traceEvent("WSOK"),ri.isDebugEnabled()&&ri.debug("WSOK"),this.state.s_m){case 121:this.state.s_m=122,this.state.traceState();break;case 150:if(null!=(e=this.state.s_tr))switch(e){case 240:null!=(e=null!=(t=this.state.s_ws)?t.m:null)&&501==e&&(this.state.s_ws.m=502,this.state.traceState());break;case 250:var t,e;null!=(e=null!=(t=this.state.s_wp)?t.m:null)&&601==e&&(this.sendBindWS_FirstPolling(),this.state.s_wp.m=602,this.state.s_wp.p=610,this.state.s_wp.c=620,this.state.s_wp.s=630,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtSendPendingControls(),this.evtSendPendingMessages(),this.schedule_evtIdleTimeout(ss.plus(Pe.sure(this.idleTimeout),this.options.retryDelay)))}}},evtCONERR:function(t,e){this.traceEvent("CONERR"),ri.isDebugEnabled()&&ri.debug("CONERR "+t+" "+e);var s=Y.standardError(t,e),i=G.TC_standardError(t,e);if(122==this.state.s_m)switch(t){case 5:this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.conerr."+t,this.state.s_m=110,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtRetry(s),this.evtRetryTimeout();break;case 4:case 6:case 20:case 40:case 41:case 48:this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.conerr."+t;var n=this.waitingInterval(this.delayCounter.get_currentRetryDelay(),this.connectTs);this.state.s_m=112,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtRetry(s,n),this.schedule_evtRetryTimeout(n);break;default:this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_CONERR(t,e),this.state.s_m=100,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtTerminate(i)}else if(130==this.state.s_m)switch(t){case 5:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.conerr."+t,this.state.s_m=110,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtRetry(s),this.evtRetryTimeout();break;case 4:case 6:case 20:case 40:case 41:case 48:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.conerr."+t,n=this.waitingInterval(this.delayCounter.get_currentRetryDelay(),this.connectTs),this.state.s_m=112,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtRetry(s,n),this.schedule_evtRetryTimeout(n);break;default:this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_CONERR(t,e),this.state.s_m=100,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtTerminate(i)}else if(140==this.state.s_m)switch(t){case 5:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ttl.conerr."+t,this.state.s_m=110,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtRetry(s),this.evtRetryTimeout();break;case 4:case 6:case 20:case 40:case 41:case 48:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ttl.conerr."+t,n=this.waitingInterval(this.delayCounter.get_currentRetryDelay(),this.connectTs),this.state.s_m=112,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtRetry(s,n),this.schedule_evtRetryTimeout(n);break;default:this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_CONERR(t,e),this.state.s_m=100,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtTerminate(i)}else{var r,a;if(502==(null!=(r=this.state.s_ws)?r.m:null))switch(t){case 4:case 6:case 20:case 40:case 41:case 48:this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.conerr."+t,this.state.goto_m_from_ws(112),this.exit_ws_to_m(),this.entry_m112(Y.standardError(t,e));break;default:this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_CONERR(t,e),this.state.goto_m_from_ws(100),this.exit_ws_to_m(),this.evtTerminate(i)}else if(r=610==(null!=(a=this.state.s_wp)?a.p:null)||613==(null!=(a=this.state.s_wp)?a.p:null))switch(t){case 4:case 6:case 20:case 40:case 41:case 48:this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.conerr."+t,this.state.goto_m_from_wp(112),this.exit_wp_to_m(),this.entry_m112(Y.standardError(t,e));break;default:this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_CONERR(t,e),this.state.goto_m_from_wp(100),this.exit_wp_to_m(),this.evtTerminate(i)}else if(r=800==(null!=(a=this.state.s_hs)?a.m:null)||801==(null!=(a=this.state.s_hs)?a.m:null))switch(t){case 4:case 6:case 20:case 40:case 41:case 48:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.conerr."+t,this.state.goto_m_from_hs(112),this.exit_hs_to_m(),this.entry_m112(Y.standardError(t,e));break;default:this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_CONERR(t,e),this.state.goto_m_from_hs(100),this.exit_hs_to_m(),this.evtTerminate(i)}else if(r=900==(null!=(a=this.state.s_hp)?a.m:null)||903==(null!=(a=this.state.s_hp)?a.m:null))switch(t){case 4:case 6:case 20:case 40:case 41:case 48:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.conerr."+t,this.state.goto_m_from_hp(112),this.exit_hp_to_m(),this.entry_m112(Y.standardError(t,e));break;default:this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_CONERR(t,e),this.state.goto_m_from_hp(100),this.exit_hp_to_m(),this.evtTerminate(i)}else if(1001==this.state.s_rec)switch(t){case 4:case 6:case 20:case 40:case 41:case 48:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="recovery.conerr."+t,this.state.goto_m_from_rec(113),this.exit_rec_to_m(),this.entry_m113(s);break;default:this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_CONERR(t,e),this.state.goto_m_from_rec(100),this.exit_rec_to_m(),this.evtTerminate(i)}}},evtEND:function(t,e){this.traceEvent("END"),ri.isDebugEnabled()&&ri.debug("END "+t+" "+e);var s=Y.standardError(t,e),i=G.TC_standardError(t,e);if(300==(null!=(a=this.state.s_w)?a.p:null))switch(t){case 41:case 48:this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.end."+t;var n=this.randomGenerator(this.options.firstRetryMaxDelay);this.state.clear_w(),this.state.goto_m_from_session(113),this.exit_w(),this.evtEndSession(),this.evtRetry(Y.standardError(t,e),n),this.schedule_evtRetryTimeout(n);break;default:this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_END(t,e),this.state.clear_w(),this.state.goto_m_from_session(100),this.exit_w(),this.evtEndSession(),this.evtTerminate(i)}else if(502==(null!=(a=this.state.s_ws)?a.m:null))switch(t){case 41:case 48:this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.end."+t,this.state.goto_m_from_ws(112),this.exit_ws_to_m(),this.entry_m112(Y.standardError(t,e));break;default:this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_END(t,e),this.state.goto_m_from_ws(100),this.exit_ws_to_m(),this.evtTerminate(i)}else if(510==(null!=(a=this.state.s_ws)?a.p:null))switch(t){case 41:case 48:this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.end."+t,this.state.goto_m_from_ws(113),this.exit_ws_to_m(),this.entry_m113(s);break;default:this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_END(t,e),this.state.goto_m_from_ws(100),this.exit_ws_to_m(),this.evtTerminate(i)}else if(a=610==(null!=(r=this.state.s_wp)?r.p:null)||613==(null!=(r=this.state.s_wp)?r.p:null))switch(t){case 41:case 48:this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.end."+t,this.state.goto_m_from_wp(112),this.exit_wp_to_m(),this.entry_m112(Y.standardError(t,e));break;default:this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_END(t,e),this.state.goto_m_from_wp(100),this.exit_wp_to_m(),this.evtTerminate(i)}else if(611==(null!=(a=this.state.s_wp)?a.p:null))switch(t){case 41:case 48:this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.end."+t,this.state.goto_m_from_wp(113),this.exit_wp_to_m(),this.entry_m113(s);break;default:this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_END(t,e),this.state.goto_m_from_wp(100),this.exit_wp_to_m(),this.evtTerminate(i)}else if(a=800==(null!=(r=this.state.s_hs)?r.m:null)||801==(null!=(r=this.state.s_hs)?r.m:null))switch(t){case 41:case 48:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.end."+t,this.state.goto_m_from_hs(112),this.exit_hs_to_m(),this.entry_m112(Y.standardError(t,e));break;default:this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_END(t,e),this.state.goto_m_from_hs(100),this.exit_hs_to_m(),this.evtTerminate(i)}else if(810==(null!=(a=this.state.s_hs)?a.p:null))switch(t){case 41:case 48:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.end."+t,this.state.goto_m_from_hs(113),this.exit_hs_to_m(),this.entry_m113(s);break;default:this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_END(t,e),this.state.goto_m_from_hs(100),this.exit_hs_to_m(),this.evtTerminate(i)}else{var r,a;if(a=900==(null!=(r=this.state.s_hp)?r.m:null)||903==(null!=(r=this.state.s_hp)?r.m:null))switch(t){case 41:case 48:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.end."+t,this.state.goto_m_from_hp(112),this.exit_hp_to_m(),this.entry_m112(Y.standardError(t,e));break;default:this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_END(t,e),this.state.goto_m_from_hp(100),this.exit_hp_to_m(),this.evtTerminate(i)}else if(901==(null!=(a=this.state.s_hp)?a.m:null))switch(t){case 41:case 48:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.end."+t,this.state.goto_m_from_hp(113),this.exit_hp_to_m(),this.entry_m113(s);break;default:this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_END(t,e),this.state.goto_m_from_hp(100),this.exit_hp_to_m(),this.evtTerminate(i)}else if(1001==this.state.s_rec)switch(t){case 41:case 48:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="recovery.end."+t,this.state.goto_m_from_rec(113),this.exit_rec_to_m(),this.entry_m113(s);break;default:this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_END(t,e),this.state.goto_m_from_rec(100),this.exit_rec_to_m(),this.evtTerminate(i)}}},evtERROR:function(t,e){this.traceEvent("ERROR"),ri.isDebugEnabled()&&ri.debug("ERROR "+t+" "+e);var s,i=G.TC_standardError(t,e);300==(null!=(s=this.state.s_w)?s.p:null)?(this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_ERROR(t,e),this.state.clear_w(),this.state.goto_m_from_session(100),this.exit_w(),this.evtEndSession(),this.evtTerminate(i)):510==(null!=(s=this.state.s_ws)?s.p:null)?(this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_ERROR(t,e),this.state.goto_m_from_ws(100),this.exit_ws_to_m(),this.evtTerminate(i)):620==(null!=(s=this.state.s_wp)?s.c:null)?(this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_ERROR(t,e),this.state.goto_m_from_wp(100),this.exit_wp_to_m(),this.evtTerminate(i)):1102==this.state.s_ctrl&&(this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_ERROR(t,e),this.state.goto_m_from_ctrl(100),this.exit_ctrl_to_m(),this.evtTerminate(i))},evtREQOK_withoutReqId:function(){this.traceEvent("REQOK"),ri.isDebugEnabled()&&ri.debug("REQOK"),1102==this.state.s_ctrl&&(this.state.s_ctrl=1102,this.state.traceState())},evtREQOK:function(t){this.traceEvent("REQOK"),ri.isDebugEnabled()&&ri.debug("REQOK "+t);var e=!0;1302==this.state.s_swt&&t==this.swt_lastReqId?(this.state.s_swt=1303,this.state.traceState(),e=this.evtREQOK_TransportRegion(t)):1202==this.state.s_bw&&t==this.bw_lastReqId?(this.state.s_bw=1200,this.state.traceState(),e=this.evtREQOK_TransportRegion(t),this.evtCheckBW()):e=this.evtREQOK_Forward(t),e&&this.evtREQOK_TransportRegion(t)},evtREQOK_Forward:function(t){return!0},evtREQOK_TransportRegion:function(t){var e;return 300==(null!=(e=this.state.s_w)?e.p:null)?(this.state.s_w.p=300,this.state.traceState(),this.doREQOK(t),this.evtRestartKeepalive()):510==(null!=(e=this.state.s_ws)?e.p:null)?(this.state.s_ws.p=510,this.state.traceState(),this.doREQOK(t),this.evtRestartKeepalive()):620==(null!=(e=this.state.s_wp)?e.c:null)?(this.state.s_wp.c=620,this.state.traceState(),this.doREQOK(t)):1102==this.state.s_ctrl&&(this.state.s_ctrl=1102,this.state.traceState(),this.doREQOK(t)),!1},evtREQERR:function(t,e,s){this.traceEvent("REQERR"),ri.isDebugEnabled()&&ri.debug("REQERR "+t+" "+e+" "+s);var i=!0;1302==this.state.s_swt&&t==this.swt_lastReqId?(this.state.s_swt=1301,this.state.traceState(),i=this.evtREQERR_TransportRegion(t,e,s)):1202==this.state.s_bw&&t==this.bw_lastReqId?(this.state.s_bw=1200,this.state.traceState(),i=this.evtREQERR_TransportRegion(t,e,s),this.evtCheckBW()):i=this.evtREQERR_Forward(t,e,s),i&&this.evtREQERR_TransportRegion(t,e,s)},evtREQERR_Forward:function(t,e,s){return!0},evtREQERR_TransportRegion:function(t,e,s){var i,n=Y.standardError(e,s),r=G.TC_standardError(e,s);if(300==(null!=(i=this.state.s_w)?i.p:null))switch(e){case 20:this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.reqerr."+e;var a=this.randomGenerator(this.options.firstRetryMaxDelay);this.state.clear_w(),this.state.goto_m_from_session(113),this.exit_w(),this.evtEndSession(),this.evtRetry(Y.standardError(e,s),a),this.schedule_evtRetryTimeout(a);break;case 11:case 65:case 67:this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_REQERR(e,s),this.state.clear_w(),this.state.goto_m_from_session(100),this.exit_w(),this.evtEndSession(),this.evtTerminate(r);break;default:this.state.s_w.p=300,this.state.traceState(),this.doREQERR(t,e,s),this.evtRestartKeepalive()}else if(510==(null!=(i=this.state.s_ws)?i.p:null))switch(e){case 20:this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.reqerr."+e+")",this.state.goto_m_from_ws(113),this.exit_ws_to_m(),this.entry_m113(n);break;case 11:case 65:case 67:this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_REQERR(e,s),this.state.goto_m_from_ws(100),this.exit_ws_to_m(),this.evtTerminate(r);break;default:this.state.s_ws.p=510,this.state.traceState(),this.doREQERR(t,e,s),this.evtRestartKeepalive()}else if(620==(null!=(i=this.state.s_wp)?i.c:null))switch(e){case 20:this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="ws.reqerr."+e,this.state.goto_m_from_wp(113),this.exit_wp_to_m(),this.entry_m113(n);break;case 11:case 65:case 67:this.disposeWS(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_REQERR(e,s),this.state.goto_m_from_wp(100),this.exit_wp_to_m(),this.evtTerminate(r);break;default:this.state.s_wp.c=620,this.state.traceState(),this.doREQERR(t,e,s)}else if(1102==this.state.s_ctrl)switch(e){case 20:this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="http.reqerr."+e,this.state.goto_m_from_ctrl(113),this.exit_ctrl_to_m(),this.entry_m113(n);break;case 11:case 65:case 67:this.disposeHTTP(),this.notifyStatus("DISCONNECTED"),this.notifyServerError_REQERR(e,s),this.state.goto_m_from_ctrl(100),this.exit_ctrl_to_m(),this.evtTerminate(r);break;default:this.state.s_ctrl=1102,this.state.traceState(),this.doREQERR(t,e,s)}return!1},evtPROG:function(t){this.traceEvent("PROG");var e=Y.prog_mismatch(this.rec_serverProg,t);if(ri.isDebugEnabled()&&ri.debug("PROG "+t),300==(null!=(s=this.state.s_w)?s.p:null))t!=this.rec_serverProg?(this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="prog.mismatch."+t+"."+this.rec_serverProg,this.state.clear_w(),this.state.goto_m_from_session(113),this.exit_w(),this.evtEndSession(),this.entry_m113(e)):(this.state.s_w.p=300,this.state.traceState(),this.evtRestartKeepalive());else if(220==this.state.s_tr)t!=this.rec_serverProg?(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="prog.mismatch."+t+"."+this.rec_serverProg,this.state.goto_m_from_session(113),this.cancel_evtTransportTimeout(),this.evtEndSession(),this.entry_m113(e)):(this.state.s_tr=220,this.state.traceState());else if(230==this.state.s_tr)t!=this.rec_serverProg?(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="prog.mismatch."+t+"."+this.rec_serverProg,this.state.goto_m_from_session(113),this.cancel_evtTransportTimeout(),this.evtEndSession(),this.entry_m113(e)):(this.state.s_tr=230,this.state.traceState());else{var s;510==(null!=(s=this.state.s_ws)?s.p:null)?t!=this.rec_serverProg?(this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="prog.mismatch."+t+"."+this.rec_serverProg,this.state.goto_m_from_ws(113),this.exit_ws_to_m(),this.entry_m113(e)):(this.state.s_ws.p=510,this.state.traceState(),this.evtRestartKeepalive()):611==(null!=(s=this.state.s_wp)?s.p:null)?t!=this.rec_serverProg?(this.disposeWS(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="prog.mismatch."+t+"."+this.rec_serverProg,this.state.goto_m_from_wp(113),this.exit_wp_to_m(),this.entry_m113(e)):(this.state.s_wp.p=611,this.state.traceState()):810==(null!=(s=this.state.s_hs)?s.p:null)?t!=this.rec_serverProg?(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="prog.mismatch."+t+"."+this.rec_serverProg,this.state.goto_m_from_hs(113),this.exit_hs_to_m(),this.entry_m113(e)):(this.state.s_hs.p=810,this.state.traceState(),this.evtRestartKeepalive()):901==(null!=(s=this.state.s_hp)?s.m:null)?t!=this.rec_serverProg?(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="prog.mismatch."+t+"."+this.rec_serverProg,this.state.goto_m_from_hp(113),this.exit_hp_to_m(),this.entry_m113(e)):(this.state.s_hp.m=901,this.state.traceState()):1001==this.state.s_rec&&(t>this.rec_clientProg?(this.disposeHTTP(),this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="prog.mismatch."+t+"."+this.rec_serverProg,this.state.goto_m_from_rec(113),this.exit_rec_to_m(),this.entry_m113(e)):(this.state.s_rec=1001,this.state.traceState(),this.doPROG(t)))}},evtLOOP:function(t){if(this.traceEvent("LOOP"),ri.isDebugEnabled()&&ri.debug("LOOP "+t),300==(null!=(e=this.state.s_w)?e.p:null))this.closeWS(),this.cause="ws.loop",this.state.clear_w(),this.state.s_tr=200,this.state.traceState(),this.exit_w(),this.evtSwitchTransport();else if(220==this.state.s_tr)this.closeHTTP(),this.cause="http.loop",this.state.s_tr=200,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtSwitchTransport();else if(230==this.state.s_tr)this.closeHTTP(),this.cause="ttl.loop",this.state.s_tr=200,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtSwitchTransport();else{var e;510==(null!=(e=this.state.s_ws)?e.p:null)?(this.closeWS(),this.cause="ws.loop",this.state.clear_ws(),this.state.s_tr=200,this.state.traceState(),this.exit_ws(),this.evtSwitchTransport()):611==(null!=(e=this.state.s_wp)?e.p:null)?this.isSwitching()?(this.closeWS(),this.cause="ws.loop",this.state.clear_wp(),this.state.s_tr=200,this.state.traceState(),this.exit_wp(),this.evtSwitchTransport()):(this.doLOOP(t),this.state.s_wp.p=612,this.state.traceState(),this.cancel_evtIdleTimeout(),this.schedule_evtPollingTimeout(this.options.pollingInterval)):810==(null!=(e=this.state.s_hs)?e.p:null)?(this.closeHTTP(),this.cause="http.loop",this.state.s_hs.p=811,this.state.traceState(),this.evtSwitchTransport()):901==(null!=(e=this.state.s_hp)?e.m:null)?this.isSwitching()?(this.closeHTTP(),this.state.s_hp.m=904,this.state.traceState(),this.cancel_evtIdleTimeout(),this.evtSwitchTransport()):(this.doLOOP(t),this.closeHTTP(),this.state.s_hp.m=902,this.state.traceState(),this.cancel_evtIdleTimeout(),this.schedule_evtPollingTimeout(this.options.pollingInterval)):1001==this.state.s_rec&&(this.closeHTTP(),this.cause="recovery.loop",this.state.goto_200_from_rec(),this.exit_rec(),this.evtSwitchTransport())}},evtCONOK:function(t,e,s,i){if(this.traceEvent("CONOK"),ri.isDebugEnabled()&&ri.debug("CONOK "+t+" "+e+" "+s+" "+i),122==this.state.s_m)this.doCONOK_CreateWS(t,e,s,i),this.resetCurrentRetryDelay(),this.notifyStatus("CONNECTED:WS-STREAMING"),this.state.s_m=150,this.state.s_tr=210,this.state.s_w=new J(300,310,340),this.state.s_rhb=320,this.state.s_slw=330,this.state.s_swt=1300,this.state.s_bw=1200,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtSendPendingControls(),this.evtSendPendingMessages(),this.evtStartSession(),this.schedule_evtKeepaliveTimeout(Pe.sure(this.keepaliveInterval)),this.evtSelectRhb(),this.evtCheckTransport(),this.evtCheckBW();else if(130==this.state.s_m)this.doCONOK_CreateHTTP(t,e,s,i),this.resetCurrentRetryDelay(),this.notifyStatus("CONNECTED:STREAM-SENSING"),this.state.s_m=150,this.state.s_tr=220,this.state.s_swt=1300,this.state.s_bw=1200,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtStartSession(),this.schedule_evtTransportTimeout(this.options.retryDelay),this.evtCheckTransport(),this.evtCheckBW();else if(140==this.state.s_m)this.doCONOK_CreateHTTP(t,e,s,i),this.resetCurrentRetryDelay(),this.notifyStatus("CONNECTED:STREAM-SENSING"),this.state.s_m=150,this.state.s_tr=230,this.state.s_swt=1300,this.state.s_bw=1200,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtStartSession(),this.schedule_evtTransportTimeout(this.options.retryDelay),this.evtCheckTransport(),this.evtCheckBW();else{var n;502==(null!=(n=this.state.s_ws)?n.m:null)?(this.doCONOK_BindWS_Streaming(t,e,s,i),this.notifyStatus("CONNECTED:WS-STREAMING"),this.state.s_ws.m=503,this.state.s_ws.p=510,this.state.s_ws.k=520,this.state.s_ws.s=550,this.state.s_rhb=320,this.state.s_slw=330,this.state.traceState(),this.cancel_evtTransportTimeout(),this.evtSendPendingControls(),this.evtSendPendingMessages(),this.schedule_evtKeepaliveTimeout(Pe.sure(this.keepaliveInterval)),this.evtSelectRhb()):610==(null!=(n=this.state.s_wp)?n.p:null)?(this.doCONOK_BindWS_Polling(t,e,s,i),this.notifyStatus("CONNECTED:WS-POLLING"),this.state.s_wp.p=611,this.state.traceState()):613==(null!=(n=this.state.s_wp)?n.p:null)?(this.doCONOK_BindWS_Polling(t,e,s,i),this.state.s_wp.p=611,this.state.traceState()):800==(null!=(n=this.state.s_hs)?n.m:null)||801==(null!=(n=this.state.s_hs)?n.m:null)?(this.doCONOK_BindHTTP_Streaming(t,e,s,i),this.notifyStatus("CONNECTED:HTTP-STREAMING"),this.state.s_hs.m=802,this.state.s_hs.p=810,this.state.s_hs.k=820,this.state.s_rhb=320,this.state.s_slw=330,this.state.traceState(),this.cancel_evtTransportTimeout(),this.schedule_evtKeepaliveTimeout(Pe.sure(this.keepaliveInterval)),this.evtSelectRhb()):900==(null!=(n=this.state.s_hp)?n.m:null)?(this.doCONOK_BindHTTP_Polling(t,e,s,i),this.notifyStatus("CONNECTED:HTTP-POLLING"),this.state.s_hp.m=901,this.state.traceState()):903==(null!=(n=this.state.s_hp)?n.m:null)&&(this.doCONOK_BindHTTP_Polling(t,e,s,i),this.state.s_hp.m=901,this.state.traceState())}},evtSERVNAME:function(t){this.traceEvent("SERVNAME"),ri.isDebugEnabled()&&ri.debug("SERVNAME "+t),this.state.inPushing()&&(this.doSERVNAME(t),this.state.inStreaming()&&this.evtRestartKeepalive())},evtCLIENTIP:function(t){this.traceEvent("CLIENTIP"),ri.isDebugEnabled()&&ri.debug("CLIENTIP "+t),this.state.inPushing()&&(this.doCLIENTIP(t),this.state.inStreaming()&&this.evtRestartKeepalive())},evtCONS:function(t){this.traceEvent("CONS"),ri.isDebugEnabled()&&ri.debug("CONS "+l.string(t)),this.state.inPushing()&&(this.doCONS(t),this.state.inStreaming()&&this.evtRestartKeepalive())},evtPROBE:function(){this.traceEvent("PROBE"),ri.isDebugEnabled()&&ri.debug("PROBE"),this.clientEventDispatcher.onServerKeepalive(),this.state.inPushing()&&this.state.inStreaming()&&this.evtRestartKeepalive()},evtNOOP:function(){this.traceEvent("NOOP"),this.state.inPushing()&&this.state.inStreaming()&&this.evtRestartKeepalive()},evtSYNC:function(t){this.traceEvent("SYNC"),ri.isDebugEnabled()&&ri.debug("SYNC "+t);var e,s,i=!0;(s=300==(null!=(e=this.state.s_w)?e.p:null)||510==(null!=(e=this.state.s_ws)?e.p:null),!s&&810!=(null!=(s=this.state.s_hs)?s.p:null))?(!!(s=220==this.state.s_tr||230==this.state.s_tr||611==(null!=(e=this.state.s_wp)?e.p:null))||901==(null!=(s=this.state.s_hp)?s.m:null)||1001==this.state.s_rec)&&(i=this.evtSYNC_PushingRegion(t)):(i=this.evtSYNC_PushingRegion(t),this.evtRestartKeepalive());i&&this.evtSYNC_PushingRegion(t)},evtSYNC_PushingRegion:function(t){var e=1e3*t;if(null!=this.state.s_slw){var s=this.state.s_slw;if(null!=s)switch(s){case 330:this.doSYNC(e),this.state.s_slw=331,this.state.traceState();break;case 331:var i=this.doSYNC_G(e);this.state.s_slw=332,this.state.traceState(),this.evtCheckAvg(i);break;case 333:i=this.doSYNC_NG(e),this.state.s_slw=332,this.state.traceState(),this.evtCheckAvg(i)}}return!1},evtMSGDONE:function(t,e,s){this.traceEvent("MSGDONE"),ri.isDebugEnabled()&&ri.debug("MSGDONE "+t+" "+e+" "+s),this.state.inPushing()&&(this.isFreshData()?(this.doMSGDONE(t,e,s),this.state.inStreaming()&&this.evtRestartKeepalive()):(this.onStaleData(),this.state.inStreaming()&&this.evtRestartKeepalive()))},evtMSGFAIL:function(t,e,s,i){this.traceEvent("MSGFAIL"),ri.isDebugEnabled()&&ri.debug("MSGFAIL "+t+" "+e+" "+s+" "+i),this.state.inPushing()&&(this.isFreshData()?(this.doMSGFAIL(t,e,s,i),this.state.inStreaming()&&this.evtRestartKeepalive()):(this.onStaleData(),this.state.inStreaming()&&this.evtRestartKeepalive()))},evtU:function(t,e,s,i){this.traceEvent("U"),ri.isDebugEnabled()&&ri.debug(""+i),this.state.inPushing()&&(this.isFreshData()?(this.doU(t,e,s),this.state.inStreaming()&&this.evtRestartKeepalive()):(this.onStaleData(),this.state.inStreaming()&&this.evtRestartKeepalive()))},evtSUBOK:function(t,e,s){this.traceEvent("SUBOK"),ri.isDebugEnabled()&&ri.debug("SUBOK "+t+" "+e+" "+s),this.state.inPushing()&&(this.isFreshData()?(this.doSUBOK(t,e,s),this.state.inStreaming()&&this.evtRestartKeepalive()):(this.onStaleData(),this.state.inStreaming()&&this.evtRestartKeepalive()))},evtSUBCMD:function(t,e,s,i,n){this.traceEvent("SUBCMD"),ri.isDebugEnabled()&&ri.debug("SUBCMD "+t+" "+e+" "+s+" "+i+" "+n),this.state.inPushing()&&(this.isFreshData()?(this.doSUBCMD(t,e,s,i,n),this.state.inStreaming()&&this.evtRestartKeepalive()):(this.onStaleData(),this.state.inStreaming()&&this.evtRestartKeepalive()))},evtUNSUB:function(t){this.traceEvent("UNSUB"),ri.isDebugEnabled()&&ri.debug("UNSUB "+t),this.state.inPushing()&&(this.isFreshData()?(this.doUNSUB(t),this.state.inStreaming()&&this.evtRestartKeepalive()):(this.onStaleData(),this.state.inStreaming()&&this.evtRestartKeepalive()))},evtEOS:function(t,e){this.traceEvent("EOS"),ri.isDebugEnabled()&&ri.debug("EOS "+t+" "+e),this.state.inPushing()&&(this.isFreshData()?(this.doEOS(t,e),this.state.inStreaming()&&this.evtRestartKeepalive()):(this.onStaleData(),this.state.inStreaming()&&this.evtRestartKeepalive()))},evtCS:function(t,e){this.traceEvent("CS"),ri.isDebugEnabled()&&ri.debug("CS "+t+" "+e),this.state.inPushing()&&(this.isFreshData()?(this.doCS(t,e),this.state.inStreaming()&&this.evtRestartKeepalive()):(this.onStaleData(),this.state.inStreaming()&&this.evtRestartKeepalive()))},evtOV:function(t,e,s){this.traceEvent("OV"),ri.isDebugEnabled()&&ri.debug("OV "+t+" "+e+" "+s),this.state.inPushing()&&(this.isFreshData()?(this.doOV(t,e,s),this.state.inStreaming()&&this.evtRestartKeepalive()):(this.onStaleData(),this.state.inStreaming()&&this.evtRestartKeepalive()))},evtCONF:function(t,e){this.traceEvent("CONF"),ri.isDebugEnabled()&&ri.debug("CONF "+t+" "+l.string(e)),this.state.inPushing()&&(this.isFreshData()?(this.doCONF(t,e),this.state.inStreaming()&&this.evtRestartKeepalive()):(this.onStaleData(),this.state.inStreaming()&&this.evtRestartKeepalive()))},evtCheckAvg:function(t){if(this.traceEvent("check.avg"),332==this.state.s_slw)switch(t._hx_index){case 0:this.state.s_slw=331,this.state.traceState();break;case 1:this.state.s_slw=333,this.state.traceState();break;case 2:this.disableStreaming(),this.cause="slow",this.state.s_slw=334,this.state.traceState(),this.evtForcePolling()}},evtSendPendingControls:function(){this.traceEvent("send.pending.controls");var t,e=this.getPendingControls();340!=(null!=(t=this.state.s_w)?t.s:null)||h.empty(e)?550!=(null!=(t=this.state.s_ws)?t.s:null)||h.empty(e)?630!=(null!=(t=this.state.s_wp)?t.s:null)||h.empty(e)||(this.sendPengingControlsWS(e),this.state.s_wp.s=630,this.state.traceState()):(this.sendPengingControlsWS(e),this.state.s_ws.s=550,this.state.traceState(),this.evtRestartHeartbeat()):(this.sendPengingControlsWS(e),this.state.s_w.s=340,this.state.traceState(),this.evtRestartHeartbeat())},evtSendPendingMessages:function(){var t;this.traceEvent("send.pending.messages"),340==(null!=(t=this.state.s_w)?t.s:null)&&h.exists(this.messageManagers,(function(t){return t.isPending()}))?(this.sendPendingMessagesWS(),this.state.s_w.s=340,this.state.traceState(),this.genAckMessagesWS(),this.evtRestartHeartbeat()):550==(null!=(t=this.state.s_ws)?t.s:null)&&h.exists(this.messageManagers,(function(t){return t.isPending()}))?(this.sendPendingMessagesWS(),this.state.s_ws.s=550,this.state.traceState(),this.genAckMessagesWS(),this.evtRestartHeartbeat()):630==(null!=(t=this.state.s_wp)?t.s:null)&&h.exists(this.messageManagers,(function(t){return t.isPending()}))&&(this.sendPendingMessagesWS(),this.state.s_wp.s=630,this.state.traceState(),this.genAckMessagesWS())},evtSelectRhb:function(){this.traceEvent("select.rhb"),320==this.state.s_rhb&&(0==this.rhb_grantedInterval?0==this.options.reverseHeartbeatInterval?(this.state.s_rhb=321,this.state.traceState()):(this.rhb_currentInterval=this.options.reverseHeartbeatInterval,this.state.s_rhb=322,this.state.traceState(),this.schedule_evtRhbTimeout(this.rhb_currentInterval)):this.options.reverseHeartbeatInterval>0&&this.options.reverseHeartbeatInterval<Pe.sure(this.rhb_grantedInterval)?(this.rhb_currentInterval=this.options.reverseHeartbeatInterval,this.state.s_rhb=323,this.state.traceState(),this.schedule_evtRhbTimeout(this.rhb_currentInterval)):(this.rhb_currentInterval=this.rhb_grantedInterval,this.state.s_rhb=323,this.state.traceState(),this.schedule_evtRhbTimeout(Pe.sure(this.rhb_currentInterval))))},evtExtSetReverseHeartbeatInterval:function(){if(this.traceEvent("setReverseHeartbeatInterval"),null!=this.state.s_rhb){var t=this.state.s_rhb;if(null!=t)switch(t){case 321:0!=this.options.reverseHeartbeatInterval&&(this.rhb_currentInterval=this.options.reverseHeartbeatInterval,this.state.s_rhb=322,this.state.traceState(),this.schedule_evtRhbTimeout(this.rhb_currentInterval));break;case 322:0==this.options.reverseHeartbeatInterval?(this.state.s_rhb=321,this.state.traceState(),this.cancel_evtRhbTimeout()):(this.rhb_currentInterval=this.options.reverseHeartbeatInterval,this.state.s_rhb=322,this.state.traceState());break;case 323:this.options.reverseHeartbeatInterval>0&&this.options.reverseHeartbeatInterval<Pe.sure(this.rhb_grantedInterval)?(this.rhb_currentInterval=this.options.reverseHeartbeatInterval,this.state.s_rhb=323,this.state.traceState()):(this.rhb_currentInterval=this.rhb_grantedInterval,this.state.s_rhb=323,this.state.traceState())}}},evtRestartHeartbeat:function(){if(this.traceEvent("restart.heartbeat"),null!=this.state.s_rhb){var t=this.state.s_rhb;if(null!=t)switch(t){case 322:this.state.s_rhb=322,this.state.traceState(),this.cancel_evtRhbTimeout(),this.schedule_evtRhbTimeout(Pe.sure(this.rhb_currentInterval));break;case 323:this.state.s_rhb=323,this.state.traceState(),this.cancel_evtRhbTimeout(),this.schedule_evtRhbTimeout(Pe.sure(this.rhb_currentInterval));break;case 324:0==this.rhb_grantedInterval?0!=this.options.reverseHeartbeatInterval?(this.rhb_currentInterval=this.options.reverseHeartbeatInterval,this.state.s_rhb=322,this.state.traceState(),this.schedule_evtRhbTimeout(this.rhb_currentInterval)):(this.state.s_rhb=321,this.state.traceState()):this.options.reverseHeartbeatInterval>0&&this.options.reverseHeartbeatInterval<Pe.sure(this.rhb_grantedInterval)?(this.rhb_currentInterval=this.options.reverseHeartbeatInterval,this.state.s_rhb=323,this.state.traceState(),this.schedule_evtRhbTimeout(this.rhb_currentInterval)):(this.rhb_currentInterval=this.rhb_grantedInterval,this.state.s_rhb=323,this.state.traceState(),this.schedule_evtRhbTimeout(Pe.sure(this.rhb_currentInterval)))}}},evtRhbTimeout:function(){this.traceEvent("rhb.timeout"),(322==this.state.s_rhb||323==this.state.s_rhb)&&(this.state.s_rhb=324,this.state.traceState(),this.cancel_evtRhbTimeout(),this.evtSendHeartbeat())},evtDisposeCtrl:function(){this.traceEvent("du:dispose.ctrl"),this.disposeCtrl()},evtStartRecovery:function(){this.traceEvent("start.recovery"),1e3==this.state.s_rec&&(this.recoverTs=a.now()/1e3,this.state.s_rec=1e3,this.state.traceState())},evtRecoveryTimeout:function(){this.traceEvent("recovery.timeout"),1e3==this.state.s_rec&&(this.sendRecovery(),this.state.s_rec=1001,this.state.traceState(),this.cancel_evtRecoveryTimeout(),this.schedule_evtTransportTimeout(this.options.retryDelay))},evtCheckRecoveryTimeout:function(t){if(this.traceEvent("check.recovery.timeout"),1002==this.state.s_rec){var e=this.options.retryDelay;if(Ze.plus(this.connectTs,e)<Ze.plus(this.recoverTs,this.options.sessionRecoveryTimeout)){this.cause="recovery.error";var s=Ze.minus(a.now()/1e3,this.connectTs),i=e>Xe.toMillis(s)?ss.minus(e,Xe.toMillis(s)):ss.ZERO;this.state.s_rec=1003,this.state.traceState(),oi.isErrorEnabled()&&(i>0?oi.isErrorEnabled()&&oi.error("Retrying recovery in "+i+"ms. Cause: "+l.string(t)):oi.isErrorEnabled()&&oi.error("Retrying recovery. Cause: "+l.string(t))),this.schedule_evtRetryTimeout(i)}else this.notifyStatus("DISCONNECTED:WILL-RETRY"),this.cause="recovery.timeout",this.state.goto_m_from_rec(113),this.exit_rec_to_m(),this.entry_m113(Y.recovery_timeout)}},evtCreate:function(){this.traceEvent("du:create"),(20==this.state.s_du||23==this.state.s_du)&&(this.state.s_du=21,this.state.traceState())},evtCheckTransport:function(){if(this.traceEvent("check.transport"),1300==this.state.s_swt)if(220==this.state.s_tr||230==this.state.s_tr||260==this.state.s_tr)this.state.s_swt=1301,this.state.traceState();else{var t=this.getBestForBinding();t==V.BFB_ws_streaming&&(210==this.state.s_tr||240==this.state.s_tr)||t==V.BFB_http_streaming&&270==this.state.s_tr&&710==this.state.s_h||t==V.BFB_ws_polling&&250==this.state.s_tr||t==V.BFB_http_polling&&270==this.state.s_tr&&720==this.state.s_h?(this.state.s_swt=1301,this.state.traceState()):(this.state.s_swt=1302,this.state.traceState(),this.evtSendControl(Pe.sure(this.switchRequest)))}},evtCheckBW:function(){this.traceEvent("check.bw"),1200==this.state.s_bw&&(this.bw_requestedMaxBandwidth!=this.options.requestedMaxBandwidth&&this.options.realMaxBandwidth!=ps.BWUnmanaged?(this.bw_requestedMaxBandwidth=this.options.requestedMaxBandwidth,this.state.s_bw=1202,this.state.traceState(),this.evtSendControl(Pe.sure(this.constrainRequest))):(this.state.s_bw=1201,this.state.traceState()))},evtCheckCtrlRequests:function(){if(this.traceEvent("check.ctrl.requests"),1100==this.state.s_ctrl){var t=this.getPendingControls();h.empty(t)?h.exists(this.messageManagers,(function(t){return t.isPending()}))?(this.sendPendingMessagesHTTP(),this.state.s_ctrl=1102,this.state.traceState(),this.evtRestartHeartbeat(),this.schedule_evtCtrlTimeout(this.options.retryDelay)):324==this.state.s_rhb?(this.sendHeartbeatHTTP(),this.state.s_ctrl=1102,this.state.traceState(),this.evtRestartHeartbeat(),this.schedule_evtCtrlTimeout(this.options.retryDelay)):(this.state.s_ctrl=1101,this.state.traceState()):(this.sendPendingControlsHTTP(t),this.state.s_ctrl=1102,this.state.traceState(),this.evtRestartHeartbeat(),this.schedule_evtCtrlTimeout(this.options.retryDelay))}},evtCtrlDone:function(){this.traceEvent("ctrl.done"),1102==this.state.s_ctrl&&(this.closeCtrl(),this.state.s_ctrl=1100,this.state.traceState(),this.cancel_evtCtrlTimeout(),this.evtCheckCtrlRequests())},evtCtrlError:function(){if(this.traceEvent("ctrl.error"),1102==this.state.s_ctrl){this.disposeCtrl();var t=this.waitingInterval(this.options.retryDelay,this.ctrl_connectTs);this.state.s_ctrl=1103,this.state.traceState(),this.cancel_evtCtrlTimeout(),this.schedule_evtCtrlTimeout(t)}},evtCtrlTimeout:function(){if(this.traceEvent("ctrl.timeout"),null!=this.state.s_ctrl)if(1102==this.state.s_ctrl){this.disposeCtrl();var t=this.waitingInterval(this.options.retryDelay,this.ctrl_connectTs);this.state.s_ctrl=1103,this.state.traceState(),this.cancel_evtCtrlTimeout(),this.schedule_evtCtrlTimeout(t)}else 1103==this.state.s_ctrl&&(this.state.s_ctrl=1100,this.state.traceState(),this.cancel_evtCtrlTimeout(),this.evtCheckCtrlRequests())},evtSendControl:function(t){var e;this.traceEvent("send.control"),340==(null!=(e=this.state.s_w)?e.s:null)?(this.sendControlWS(t),this.state.s_w.s=340,this.state.traceState(),this.evtRestartHeartbeat()):550==(null!=(e=this.state.s_ws)?e.s:null)?(this.sendControlWS(t),this.state.s_ws.s=550,this.state.traceState(),this.evtRestartHeartbeat()):630==(null!=(e=this.state.s_wp)?e.s:null)?(this.sendControlWS(t),this.state.s_wp.s=630,this.state.traceState()):1101==this.state.s_ctrl&&(this.state.s_ctrl=1100,this.state.traceState(),this.evtCheckCtrlRequests())},evtSendHeartbeat:function(){var t;this.traceEvent("send.heartbeat"),340==(null!=(t=this.state.s_w)?t.s:null)?(this.sendHeartbeatWS(),this.state.s_w.s=340,this.state.traceState(),this.evtRestartHeartbeat()):550==(null!=(t=this.state.s_ws)?t.s:null)?(this.sendHeartbeatWS(),this.state.s_ws.s=550,this.state.traceState(),this.evtRestartHeartbeat()):1101==this.state.s_ctrl&&(this.state.s_ctrl=1100,this.state.traceState(),this.evtCheckCtrlRequests())},evtStartSession:function(){this.traceEvent("du:start.session"),oi.isInfoEnabled()&&oi.info("Starting new session: "+this.sessionId),21==this.state.s_du&&(this.state.s_du=22,this.state.traceState())},evtEndSession:function(){oi.isInfoEnabled()&&oi.info("Destroying session: "+this.sessionId)},evtRetry:function(t,e){this.traceEvent("du:retry"),oi.isErrorEnabled()&&(null!=e&&e>0?oi.isErrorEnabled()&&oi.error("Retrying connection in "+e+"ms. Cause: "+j(t)):oi.isErrorEnabled()&&oi.error("Retrying connection. Cause: "+j(t)));var s=!0;switch(this.state.s_du){case 21:this.resetSequenceMap(),this.state.s_du=23,this.state.traceState(),s=this.evtRetry_NextRegion(),this.genAbortMessages();break;case 22:this.disposeSession(),this.state.s_du=23,this.state.traceState(),s=this.evtRetry_NextRegion(),this.genAbortSubscriptions(),this.genAbortMessages()}s&&this.evtRetry_NextRegion()},evtRetry_NextRegion:function(){return!1},evtTerminate:function(t){if(this.traceEvent("du:terminate"),oi.isInfoEnabled()&&2==t._hx_index&&oi.isInfoEnabled()&&oi.info("Disconnected. Cause: Requested by user"),oi.isErrorEnabled())switch(t._hx_index){case 0:oi.isErrorEnabled()&&oi.error("Disconnected. Cause: "+t.code+" - "+t.msg);break;case 1:oi.isErrorEnabled()&&oi.error("Disconnected. Cause: "+t.error)}var e=!0;switch(this.state.s_du){case 20:case 21:case 23:this.disposeClient(),this.doUnistallPageLifecycle(),this.state.s_du=20,this.state.traceState(),e=this.evtTerminate_NextRegion(),this.genAbortMessages();break;case 22:this.disposeSession(),this.disposeClient(),this.doUnistallPageLifecycle(),this.state.s_du=20,this.state.traceState(),e=this.evtTerminate_NextRegion(),this.genAbortSubscriptions(),this.genAbortMessages()}e&&this.evtTerminate_NextRegion()},evtTerminate_NextRegion:function(){return this.evtTerminate_NetworkReachabilityRegion()},evtTerminate_NetworkReachabilityRegion:function(){switch(this.state.s_nr){case 1410:case 1411:case 1412:var t=this.nr_reachabilityManager;this.nr_reachabilityManager=null,this.state.s_nr=1400,this.state.traceState(),null!=t&&t.stopListening()}return!1},evtRetryTimeout:function(){switch(this.traceEvent("retry.timeout"),this.state.s_m){case 110:this.notifyStatus("CONNECTING"),this.sendCreateTTL(),this.state.s_m=140,this.state.traceState(),this.evtCreate(),this.schedule_evtTransportTimeout(6e4);break;case 111:this.notifyStatus("CONNECTING"),this.delayCounter.increase(),this.sendCreateTTL(),this.state.s_m=140,this.state.traceState(),this.cancel_evtRetryTimeout(),this.evtCreate(),this.schedule_evtTransportTimeout(6e4);break;case 112:this.delayCounter.increase(),this.state.s_m=116,this.state.traceState(),this.cancel_evtRetryTimeout(),this.evtSelectCreate();break;case 113:this.state.s_m=116,this.state.traceState(),this.cancel_evtRetryTimeout(),this.evtSelectCreate();break;case 115:this.state.s_m=116,this.state.traceState(),this.evtSelectCreate();break;case 150:1003==this.state.s_rec&&(this.sendRecovery(),this.state.s_rec=1001,this.state.traceState(),this.cancel_evtRetryTimeout(),this.schedule_evtTransportTimeout(this.options.retryDelay))}},evtExtSetForcedTransport:function(){this.traceEvent("setForcedTransport"),1301==this.state.s_swt&&(this.state.s_swt=1300,this.state.traceState(),this.evtCheckTransport())},evtExtSetRequestedMaxBandwidth:function(){this.traceEvent("setRequestedMaxBandwidth"),1201==this.state.s_bw&&(this.state.s_bw=1200,this.state.traceState(),this.evtCheckBW())},evtForceSlowing:function(){this.traceEvent("force.slowing"),1301==this.state.s_swt&&(this.state.s_swt=1300,this.state.traceState(),this.evtCheckTransport())},evtForcePolling:function(){this.traceEvent("force.polling"),1301==this.state.s_swt&&(this.state.s_swt=1300,this.state.traceState(),this.evtCheckTransport())},evtSendMessage:function(t){var e;this.traceEvent("send.message"),340==(null!=(e=this.state.s_w)?e.s:null)?(this.sendMsgWS(t),this.state.s_w.s=340,this.state.traceState(),t.evtWSSent(),this.evtRestartHeartbeat()):550==(null!=(e=this.state.s_ws)?e.s:null)?(this.sendMsgWS(t),this.state.s_ws.s=550,this.state.traceState(),t.evtWSSent(),this.evtRestartHeartbeat()):630==(null!=(e=this.state.s_wp)?e.s:null)?(this.sendMsgWS(t),this.state.s_wp.s=630,this.state.traceState(),t.evtWSSent()):1101==this.state.s_ctrl&&(this.state.s_ctrl=1100,this.state.traceState(),this.evtCheckCtrlRequests())},evtSwitchTransport:function(){this.traceEvent("switch.transport");var t=!0;1302!=this.state.s_swt&&1303!=this.state.s_swt||(this.state.s_swt=1300,this.state.traceState(),t=this.evtSwitchTransport_forwardToTransportRegion(),this.evtCheckTransport()),t&&this.evtSwitchTransport_forwardToTransportRegion()},evtSwitchTransport_forwardToTransportRegion:function(){var t,e=G.TC_otherError("Selected transport "+this.options.forcedTransport+" is not available");if(200==this.state.s_tr)switch(this.getBestForBinding()._hx_index){case 0:this.notifyStatus("DISCONNECTED"),this.state.goto_m_from_session(100),this.evtEndSession(),this.evtTerminate(e);break;case 1:this.openWS_Bind(),this.state.s_tr=240,this.state.s_ws=new $(500),this.state.traceState(),this.schedule_evtTransportTimeout(this.options.retryDelay);break;case 2:this.openWS_Bind(),this.state.s_tr=250,this.state.s_wp=new tt(600),this.state.traceState(),this.schedule_evtTransportTimeout(this.options.retryDelay);break;case 3:this.sendBindHTTP_Streaming(),this.state.s_tr=270,this.state.s_h=710,this.state.s_hs=new et(800),this.state.s_ctrl=1100,this.state.traceState(),this.evtCheckCtrlRequests(),this.schedule_evtTransportTimeout(this.options.retryDelay);break;case 4:this.sendBindHTTP_Polling(),this.state.s_tr=270,this.state.s_h=720,this.state.s_hp=new st(900),this.state.s_rhb=320,this.state.s_ctrl=1100,this.state.traceState(),this.evtCheckCtrlRequests(),this.schedule_evtIdleTimeout(ss.plus(Pe.sure(this.idleTimeout),this.options.retryDelay)),this.evtSelectRhb()}else if(811==(null!=(t=this.state.s_hs)?t.p:null))switch(this.getBestForBinding()._hx_index){case 0:this.notifyStatus("DISCONNECTED"),this.state.goto_m_from_hs(100),this.exit_hs_to_m(),this.evtTerminate(e);break;case 1:this.openWS_Bind(),this.state.clear_hs(),this.state.s_h=null,this.state.s_ctrl=null,this.state.s_tr=240,this.state.s_ws=new $(500),this.state.traceState(),this.exit_hs(),this.exit_ctrl(),this.schedule_evtTransportTimeout(this.options.retryDelay);break;case 2:this.openWS_Bind(),this.state.clear_hs(),this.state.s_h=null,this.state.s_ctrl=null,this.state.s_tr=250,this.state.s_wp=new tt(600),this.state.traceState(),this.exit_hs(),this.exit_ctrl(),this.schedule_evtTransportTimeout(this.options.retryDelay);break;case 3:this.sendBindHTTP_Streaming(),this.state.s_hs=new et(800),this.state.traceState(),this.exit_hs(),this.schedule_evtTransportTimeout(this.options.retryDelay);break;case 4:this.sendBindHTTP_Polling(),this.state.clear_hs(),this.state.s_h=720,this.state.s_hp=new st(900),this.state.s_rhb=320,this.state.traceState(),this.exit_hs(),this.schedule_evtIdleTimeout(ss.plus(Pe.sure(this.idleTimeout),this.options.retryDelay)),this.evtSelectRhb()}else if(904==(null!=(t=this.state.s_hp)?t.m:null))switch(this.getBestForBinding()._hx_index){case 0:this.notifyStatus("DISCONNECTED"),this.state.goto_m_from_hp(100),this.exit_hp_to_m(),this.evtTerminate(e);break;case 1:this.openWS_Bind(),this.state.clear_hp(),this.state.s_h=null,this.state.s_ctrl=null,this.state.s_tr=240,this.state.s_ws=new $(500),this.state.traceState(),this.exit_hp(),this.exit_ctrl(),this.schedule_evtTransportTimeout(this.options.retryDelay);break;case 2:this.openWS_Bind(),this.state.clear_hp(),this.state.s_h=null,this.state.s_ctrl=null,this.state.s_tr=250,this.state.s_wp=new tt(600),this.state.traceState(),this.exit_hp(),this.exit_ctrl(),this.schedule_evtTransportTimeout(this.options.retryDelay);break;case 3:this.sendBindHTTP_Streaming(),this.state.clear_hp(),this.state.s_h=710,this.state.s_hs=new et(800),this.state.traceState(),this.exit_hp(),this.schedule_evtTransportTimeout(this.options.retryDelay);break;case 4:this.sendBindHTTP_Polling(),this.state.s_hp=new st(900),this.state.s_rhb=320,this.state.traceState(),this.exit_hp(),this.schedule_evtIdleTimeout(ss.plus(Pe.sure(this.idleTimeout),this.options.retryDelay)),this.evtSelectRhb()}return!1},onFreshData:function(){if(this.rec_serverProg!=this.rec_clientProg)throw new Me("Assertion failure: rec_serverProg == rec_clientProg");this.rec_serverProg+=1,this.rec_clientProg+=1},onStaleData:function(){if(this.rec_serverProg>=this.rec_clientProg)throw new Me("Assertion failure: rec_serverProg < rec_clientProg");this.rec_serverProg+=1},isFreshData:function(){return this.rec_serverProg==this.rec_clientProg},openWS:function(t,e){var s=this,i=function(t){wi((function(){s.lock.synchronized((function(){t.isDisposed()||s.evtWSOpen()}))}))},n=function(t,e){wi((function(){s.lock.synchronized((function(){if(!t.isDisposed())try{s.evtMessage(e)}catch(t){var i=g.caught(t);oi.isErrorEnabled()&&oi.error(i.get_message()+"\n"+i.details()),s.evtExtDisconnect(G.TC_standardError(61,i.get_message()))}}))}))},r=function(t,e){wi((function(){s.lock.synchronized((function(){t.isDisposed()||s.evtTransportError()}))}))};return this.wsFactory(t,e,i,n,r)},openWS_Create:function(){this.connectTs=a.now()/1e3,this.serverInstanceAddress=this.getServerAddress(),this.ws=this.openWS(Es.build(this.serverInstanceAddress,"lightstreamer"),this.options.httpExtraHeaders)},openWS_Bind:function(){this.connectTs=a.now()/1e3,this.ws=this.openWS(Es.build(Pe.sure(this.serverInstanceAddress),"lightstreamer"),this.getHeadersForRequestOtherThanCreate())},sendCreateWS:function(){var t=new Ke;this.options.keepaliveInterval>0&&t.LS_keepalive_millis(this.options.keepaliveInterval),this.rhb_grantedInterval=this.options.reverseHeartbeatInterval,this.rhb_grantedInterval>0&&t.LS_inactivity_millis(this.rhb_grantedInterval),this.bw_requestedMaxBandwidth=this.options.requestedMaxBandwidth;var e=this.bw_requestedMaxBandwidth;null!=e&&0==e._hx_index&&t.LS_requested_max_bandwidth_Float(e.bw),null!=this.details.adapterSet&&t.LS_adapter_set(this.details.adapterSet),null!=this.details.user&&t.LS_user(this.details.user),t.LS_cid(ei),null!=this.sessionId&&t.LS_old_session(this.sessionId),this.options.slowingEnabled||t.LS_send_sync(!1),null!=this.cause&&(t.LS_cause(this.cause),this.cause=null),ri.isInfoEnabled()&&ri.info("Sending session create: "+l.string(t)),null!=this.details.password&&t.LS_password(this.details.password),Pe.sure(this.ws).send("wsok"),Pe.sure(this.ws).send("create_session\r\n"+t.getEncodedString())},sendBindWS_Streaming:function(){var t=new Ke;t.LS_session(Pe.sure(this.sessionId)),this.options.keepaliveInterval>0&&t.LS_keepalive_millis(this.options.keepaliveInterval),this.rhb_grantedInterval=this.options.reverseHeartbeatInterval,this.rhb_grantedInterval>0&&t.LS_inactivity_millis(this.rhb_grantedInterval),this.options.slowingEnabled||t.LS_send_sync(!1),null!=this.cause&&(t.LS_cause(this.cause),this.cause=null),ri.isInfoEnabled()&&ri.info("Sending session bind: "+l.string(t)),Pe.sure(this.ws).send("wsok"),Pe.sure(this.ws).send("bind_session\r\n"+t.getEncodedString())},sendBindWS_FirstPolling:function(){var t=new Ke;t.LS_session(Pe.sure(this.sessionId)),t.LS_polling(!0),t.LS_polling_millis(this.options.pollingInterval),this.idleTimeout=this.options.idleTimeout,t.LS_idle_millis(this.idleTimeout),null!=this.cause&&(t.LS_cause(this.cause),this.cause=null),ri.isInfoEnabled()&&ri.info("Sending session bind: "+l.string(t)),Pe.sure(this.ws).send("bind_session\r\n"+t.getEncodedString())},sendBindWS_Polling:function(){var t=new Ke;t.LS_polling(!0),t.LS_polling_millis(this.options.pollingInterval),this.idleTimeout=this.options.idleTimeout,t.LS_idle_millis(this.idleTimeout),null!=this.cause&&(t.LS_cause(this.cause),this.cause=null),ri.isInfoEnabled()&&ri.info("Sending session bind: "+l.string(t)),Pe.sure(this.ws).send("bind_session\r\n"+t.getEncodedString())},sendDestroyWS:function(t){null==t&&(t="api");var e=new Ke;e.LS_reqId(this.generateFreshReqId()),e.LS_op("destroy"),e.LS_close_socket(!0),e.LS_cause(t),ri.isInfoEnabled()&&ri.info("Sending session destroy: "+l.string(e)),Pe.sure(this.ws).send("control\r\n"+e.getEncodedString())},sendHttpRequest:function(t,e,s){var i=this,n=function(t,e){wi((function(){i.lock.synchronized((function(){if(!t.isDisposed())try{i.evtMessage(e)}catch(t){var s=g.caught(t);oi.isErrorEnabled()&&oi.error(s.get_message()+"\n"+s.details()),i.evtExtDisconnect(G.TC_standardError(61,s.get_message()))}}))}))},r=function(t,e){wi((function(){i.lock.synchronized((function(){t.isDisposed()||i.evtTransportError()}))}))};return this.httpFactory(t,e.getEncodedString(),s,n,r,(function(t){}))},sendCreateHTTP:function(){var t=new Ke;t.LS_polling(!0),t.LS_polling_millis(0),t.LS_idle_millis(0),this.bw_requestedMaxBandwidth=this.options.requestedMaxBandwidth;var e=this.bw_requestedMaxBandwidth;null!=e&&0==e._hx_index&&t.LS_requested_max_bandwidth_Float(e.bw),null!=this.details.adapterSet&&t.LS_adapter_set(this.details.adapterSet),null!=this.details.user&&t.LS_user(this.details.user),t.LS_cid(ei),null!=this.sessionId&&t.LS_old_session(this.sessionId),null!=this.cause&&(t.LS_cause(this.cause),this.cause=null),ri.isInfoEnabled()&&ri.info("Sending session create: "+l.string(t)),null!=this.details.password&&t.LS_password(this.details.password),this.connectTs=a.now()/1e3,this.serverInstanceAddress=this.getServerAddress(),this.http=this.sendHttpRequest(Es.build(this.serverInstanceAddress,"/lightstreamer"+ii+"/create_session.txt?LS_protocol="+Js),t,this.options.httpExtraHeaders)},sendBindHTTP_Streaming:function(){var t=new Ke;t.LS_session(Pe.sure(this.sessionId)),t.LS_content_length(this.options.contentLength),this.options.keepaliveInterval>0&&t.LS_keepalive_millis(this.options.keepaliveInterval),this.rhb_grantedInterval=this.options.reverseHeartbeatInterval,this.rhb_grantedInterval>0&&t.LS_inactivity_millis(this.rhb_grantedInterval),this.options.slowingEnabled||t.LS_send_sync(!1),null!=this.cause&&(t.LS_cause(this.cause),this.cause=null),ri.isInfoEnabled()&&ri.info("Sending session bind: "+l.string(t)),this.connectTs=a.now()/1e3,this.http=this.sendHttpRequest(Es.build(Pe.sure(this.serverInstanceAddress),"/lightstreamer/bind_session.txt?LS_protocol="+Js),t,this.getHeadersForRequestOtherThanCreate())},sendBindHTTP_Polling:function(){var t=new Ke;t.LS_session(Pe.sure(this.sessionId)),t.LS_polling(!0),t.LS_polling_millis(this.options.pollingInterval),this.idleTimeout=this.options.idleTimeout,t.LS_idle_millis(this.idleTimeout),null!=this.cause&&(t.LS_cause(this.cause),this.cause=null),this.rhb_grantedInterval=0,ri.isInfoEnabled()&&ri.info("Sending session bind: "+l.string(t)),this.connectTs=a.now()/1e3,this.http=this.sendHttpRequest(Es.build(Pe.sure(this.serverInstanceAddress),"/lightstreamer/bind_session.txt?LS_protocol="+Js),t,this.getHeadersForRequestOtherThanCreate())},sendCreateTTL:function(){var t=new Ke;t.LS_ttl_millis("unlimited"),t.LS_polling(!0),t.LS_polling_millis(0),t.LS_idle_millis(0),this.bw_requestedMaxBandwidth=this.options.requestedMaxBandwidth;var e=this.bw_requestedMaxBandwidth;null!=e&&0==e._hx_index&&t.LS_requested_max_bandwidth_Float(e.bw),null!=this.details.adapterSet&&t.LS_adapter_set(this.details.adapterSet),null!=this.details.user&&t.LS_user(this.details.user),t.LS_cid(ei),null!=this.sessionId&&t.LS_old_session(this.sessionId),null!=this.cause&&(t.LS_cause(this.cause),this.cause=null),ri.isInfoEnabled()&&ri.info("Sending session create: "+l.string(t)),null!=this.details.password&&t.LS_password(this.details.password),this.connectTs=a.now()/1e3,this.serverInstanceAddress=this.getServerAddress(),this.http=this.sendHttpRequest(Es.build(this.serverInstanceAddress,"/lightstreamer"+ii+"/create_session.txt?LS_protocol="+Js),t,this.options.httpExtraHeaders)},sendRecovery:function(){var t=new Ke;t.LS_session(Pe.sure(this.sessionId)),t.LS_recovery_from(this.rec_clientProg),t.LS_polling(!0),t.LS_polling_millis(0),t.LS_idle_millis(0),null!=this.cause&&(t.LS_cause(this.cause),this.cause=null),ri.isInfoEnabled()&&ri.info("Sending session recovery: "+l.string(t)),this.connectTs=a.now()/1e3,this.http=this.sendHttpRequest(Es.build(Pe.sure(this.serverInstanceAddress),"/lightstreamer/bind_session.txt?LS_protocol="+Js),t,this.getHeadersForRequestOtherThanCreate())},disposeWS:function(){null!=this.ws&&(this.ws.dispose(),this.ws=null)},closeWS:function(){null!=this.ws&&(this.ws.dispose(),this.ws=null)},suspendWS_Streaming:function(){oi.isWarnEnabled()&&oi.warn("Websocket suspended"),this.suspendedTransports.insert("WS-STREAMING")},disableWS:function(){oi.isWarnEnabled()&&oi.warn("Websocket disabled"),this.disabledTransports=this.disabledTransports.union(["WS-STREAMING","WS-POLLING"])},disableHTTP_Streaming:function(){oi.isWarnEnabled()&&oi.warn("HTTP streaming disabled"),this.disabledTransports=this.disabledTransports.union(["HTTP-STREAMING"])},disableStreaming:function(){oi.isWarnEnabled()&&oi.warn("Streaming disabled"),this.disabledTransports=this.disabledTransports.union(["WS-STREAMING","HTTP-STREAMING"])},enableAllTransports:function(){oi.isInfoEnabled()&&(this.disabledTransports.count()>0||this.suspendedTransports.count()>0)&&oi.isInfoEnabled()&&oi.info("Transports enabled again."),this.disabledTransports=new je,this.suspendedTransports=new je},disposeHTTP:function(){null!=this.http&&(this.http.dispose(),this.http=null)},closeHTTP:function(){null!=this.http&&(this.http.dispose(),this.http=null)},disposeCtrl:function(){null!=this.ctrl_http&&(this.ctrl_http.dispose(),this.ctrl_http=null)},closeCtrl:function(){null!=this.ctrl_http&&(this.ctrl_http.dispose(),this.ctrl_http=null)},notifyStatus:function(t){var e=this.m_status;this.m_status=t,e!=t&&(oi.isInfoEnabled()&&oi.info("Status: "+t),this.clientEventDispatcher.onStatusChange(t))},getBestForCreating:function(){if(0==this.getBestForBinding()._hx_index)return H.BFC_none;var t=this.options.forcedTransport,e=this.suspendedTransports.union(this.disabledTransports.toArray()),s=this.options.httpExtraHeaders,i=null==s||h.empty(s);if(null==t)return i?e.contains("WS-STREAMING")?H.BFC_http:H.BFC_ws:H.BFC_http;switch(t){case"WS":case"WS-STREAMING":return i?e.contains("WS-STREAMING")?H.BFC_http:H.BFC_ws:H.BFC_http;default:return H.BFC_http}},getBestForBinding:function(){var t=this.options.forcedTransport,e=this.disabledTransports,s=this.options.httpExtraHeaders,i=null==s||h.empty(s),n=this.options.httpExtraHeadersOnSessionCreationOnly;if(null==t)return i||n?e.contains("WS-STREAMING")?e.contains("HTTP-STREAMING")?e.contains("WS-POLLING")?V.BFB_http_polling:V.BFB_ws_polling:V.BFB_http_streaming:V.BFB_ws_streaming:e.contains("HTTP-STREAMING")?V.BFB_http_polling:V.BFB_http_streaming;switch(t){case"HTTP":return e.contains("HTTP-STREAMING")?V.BFB_http_polling:V.BFB_http_streaming;case"HTTP-POLLING":return V.BFB_http_polling;case"HTTP-STREAMING":return e.contains("HTTP-STREAMING")?V.BFB_none:V.BFB_http_streaming;case"WS":return i||n?e.contains("WS-STREAMING")?e.contains("WS-POLLING")?V.BFB_none:V.BFB_ws_polling:V.BFB_ws_streaming:V.BFB_none;case"WS-POLLING":return i||n?e.contains("WS-POLLING")?V.BFB_none:V.BFB_ws_polling:V.BFB_none;case"WS-STREAMING":return i||n?e.contains("WS-STREAMING")?V.BFB_none:V.BFB_ws_streaming:V.BFB_none}},resetCurrentRetryDelay:function(){this.delayCounter.reset(this.options.retryDelay)},notifyServerErrorIfCauseIsError:function(t){switch(t._hx_index){case 0:this.clientEventDispatcher.onServerError(t.code,t.msg);break;case 1:this.clientEventDispatcher.onServerError(61,t.error)}},notifyServerError_CONERR:function(t,e){this.clientEventDispatcher.onServerError(t,e)},notifyServerError_END:function(t,e){0<t&&t<30||t>39?this.clientEventDispatcher.onServerError(39,e):this.clientEventDispatcher.onServerError(t,e)},notifyServerError_ERROR:function(t,e){this.clientEventDispatcher.onServerError(t,e)},notifyServerError_REQERR:function(t,e){11==t?this.clientEventDispatcher.onServerError(21,e):this.clientEventDispatcher.onServerError(t,e)},doCONOK:function(t,e,s,i,n){this.sessionId=t,this.details.setSessionId(t),this.requestLimit=e,null!=s?(this.keepaliveInterval=s,this.options.setKeepaliveInterval(s)):null!=i&&(this.idleTimeout=i,this.options.setIdleTimeout(i)),"*"==n||this.options.serverInstanceAddressIgnored||(n=Es.completeControlLink(n,this.getServerAddress()),this.serverInstanceAddress=n,this.details.setServerInstanceAddress(n))},doCONOK_CreateWS:function(t,e,s,i){this.doCONOK(t,e,s,null,i)},doCONOK_BindWS_Streaming:function(t,e,s,i){this.doCONOK(t,e,s,null,i)},doCONOK_BindWS_Polling:function(t,e,s,i){this.doCONOK(t,e,null,s,i)},doCONOK_CreateHTTP:function(t,e,s,i){this.doCONOK(t,e,null,null,i)},doCONOK_BindHTTP_Streaming:function(t,e,s,i){this.doCONOK(t,e,s,null,i)},doCONOK_BindHTTP_Polling:function(t,e,s,i){this.doCONOK(t,e,null,s,i)},doSERVNAME:function(t){this.details.setServerSocketName(t)},doCLIENTIP:function(t){this.details.setClientIp(t);var e=this.lastKnownClientIp;null!=e&&e!=t&&(oi.isInfoEnabled()&&oi.info("Client IP changed: "+e+" -> "+t),this.enableAllTransports()),this.lastKnownClientIp=t},doCONS:function(t){this.options.setRealMaxBandwidth(t)},doLOOP:function(t){this.options.setPollingInterval(t)},doPROG:function(t){if(t>this.rec_clientProg)throw new Me("Assertion failure: prog <= rec_clientProg");this.rec_serverProg=t},doMSGDONE:function(t,e,s){this.onFreshData();var i=this.messageManagers.filter((function(s){return s.sequence==t&&s.prog==e}));if(i.values.length-i.nRemoved>1)throw new Me("Assertion failure: messages.length <= 1");for(var n=new Ne(i);n.hasNext();)n.next().evtMSGDONE(s)},doMSGFAIL:function(t,e,s,i){if(this.onFreshData(),39==s){var n=l.parseInt(i);if(null==n)throw new Me("Assertion failure: count != null");for(var r=e-n+1,a=e+1;r<a;){var o=this.messageManagers.filter(function(e){return function(s){return s.sequence==t&&s.prog==e[0]}}([r++]));if(o.values.length-o.nRemoved>1)throw new Me("Assertion failure: messages.length <= 1");for(var h=new Ne(o);h.hasNext();)h.next().evtMSGFAIL(s,i)}}else{if(o=this.messageManagers.filter((function(s){return s.sequence==t&&s.prog==e})),o.values.length-o.nRemoved>1)throw new Me("Assertion failure: messages.length <= 1");for(h=new Ne(o);h.hasNext();)h.next().evtMSGFAIL(s,i)}},doU:function(t,e,s){this.onFreshData();var i=this.subscriptionManagers._innerMap.h[t];null!=i?i.evtU(e,s):new Wt(t,this).evtU(e,s)},doSUBOK:function(t,e,s){this.onFreshData();var i=this.subscriptionManagers._innerMap.h[t];null!=i?i.evtSUBOK(e,s):new Wt(t,this).evtSUBOK(e,s)},doSUBCMD:function(t,e,s,i,n){this.onFreshData();var r=this.subscriptionManagers._innerMap.h[t];null!=r?r.evtSUBCMD(e,s,i,n):new Wt(t,this).evtSUBCMD(e,s,i,n)},doUNSUB:function(t){this.onFreshData();var e=this.subscriptionManagers._innerMap.h[t];null!=e&&e.evtUNSUB()},doEOS:function(t,e){this.onFreshData();var s=this.subscriptionManagers._innerMap.h[t];null!=s?s.evtEOS(e):new Wt(t,this).evtEOS(e)},doCS:function(t,e){this.onFreshData();var s=this.subscriptionManagers._innerMap.h[t];null!=s?s.evtCS(e):new Wt(t,this).evtCS(e)},doOV:function(t,e,s){this.onFreshData();var i=this.subscriptionManagers._innerMap.h[t];null!=i?i.evtOV(e,s):new Wt(t,this).evtOV(e,s)},doCONF:function(t,e){this.onFreshData();var s=this.subscriptionManagers._innerMap.h[t];null!=s?s.evtCONF(e):new Wt(t,this).evtCONF(e)},doREQOK:function(t){for(var e=this.subscriptionManagers,s=e.keys();s.hasNext();)e.get(s.next()).evtREQOK(t);this.subscriptionManagers._orderedKeys.compact();for(var i=new Ne(this.messageManagers);i.hasNext();)i.next().evtREQOK(t);this.messageManagers.compact()},doREQERR:function(t,e,s){for(var i=this.subscriptionManagers,n=i.keys();n.hasNext();)i.get(n.next()).evtREQERR(t,e,s);this.subscriptionManagers._orderedKeys.compact();for(var r=new Ne(this.messageManagers);r.hasNext();)r.next().evtREQERR(t,e,s);this.messageManagers.compact()},doSYNC:function(t){this.slw_refTime=a.now()/1e3,this.slw_avgDelayMs=-t},doSYNC_G:function(t){var e=this.diffTimeSync(t);return e>this.slw_hugeDelayMs&&e>2*this.slw_avgDelayMs?this.slw_avgDelayMs>this.slw_maxAvgDelayMs&&this.options.slowingEnabled?z.SCR_bad:z.SCR_not_good:(this.slw_avgDelayMs=this.slowAvg(e),this.slw_avgDelayMs>this.slw_maxAvgDelayMs&&this.options.slowingEnabled?z.SCR_bad:(this.slw_avgDelayMs<60&&(this.slw_avgDelayMs=0),z.SCR_good))},doSYNC_NG:function(t){var e=this.diffTimeSync(t);return e>this.slw_hugeDelayMs&&e>2*this.slw_avgDelayMs?(this.slw_avgDelayMs=this.slowAvg(e),this.slw_avgDelayMs>this.slw_maxAvgDelayMs&&this.options.slowingEnabled?z.SCR_bad:(this.slw_avgDelayMs<60&&(this.slw_avgDelayMs=0),z.SCR_good)):(this.slw_avgDelayMs=this.slowAvg(e),this.slw_avgDelayMs>this.slw_maxAvgDelayMs&&this.options.slowingEnabled?z.SCR_bad:(this.slw_avgDelayMs<60&&(this.slw_avgDelayMs=0),z.SCR_not_good))},diffTimeSync:function(t){return Ze.minus(a.now()/1e3,this.slw_refTime)-t},slowAvg:function(t){return this.slw_avgDelayMs*this.slw_m+t*(1-this.slw_m)},schedule_evtTransportTimeout:function(t){this.transportTimer=this.createTimer("transport.timeout",t,Vs(this,this.evtTransportTimeout))},schedule_evtRetryTimeout:function(t){this.retryTimer=this.createTimer("retry.timeout",t,Vs(this,this.evtRetryTimeout))},schedule_evtRecoveryTimeout:function(t){this.recoveryTimer=this.createTimer("recovery.timeout",t,Vs(this,this.evtRecoveryTimeout))},schedule_evtIdleTimeout:function(t){this.idleTimer=this.createTimer("idle.timeout",t,Vs(this,this.evtIdleTimeout))},schedule_evtPollingTimeout:function(t){this.pollingTimer=this.createTimer("polling.timeout",t,Vs(this,this.evtPollingTimeout))},schedule_evtCtrlTimeout:function(t){this.ctrlTimer=this.createTimer("ctrl.timeout",t,Vs(this,this.evtCtrlTimeout))},schedule_evtKeepaliveTimeout:function(t){this.keepaliveTimer=this.createTimer("keepalive.timeout",t,Vs(this,this.evtKeepaliveTimeout))},schedule_evtStalledTimeout:function(t){this.stalledTimer=this.createTimer("stalled.timeout",t,Vs(this,this.evtStalledTimeout))},schedule_evtReconnectTimeout:function(t){this.reconnectTimer=this.createTimer("reconnect.timeout",t,Vs(this,this.evtReconnectTimeout))},schedule_evtRhbTimeout:function(t){this.rhbTimer=this.createTimer("rhb.timeout",t,Vs(this,this.evtRhbTimeout))},createTimer:function(t,e,s){var i=this;return this.timerFactory(t,e,(function(t){i.lock.synchronized((function(){t.isCanceled()||s()}))}))},cancel_evtTransportTimeout:function(){null!=this.transportTimer&&(this.transportTimer.cancel(),this.transportTimer=null)},cancel_evtRetryTimeout:function(){null!=this.retryTimer&&(this.retryTimer.cancel(),this.retryTimer=null)},cancel_evtKeepaliveTimeout:function(){null!=this.keepaliveTimer&&(this.keepaliveTimer.cancel(),this.keepaliveTimer=null)},cancel_evtStalledTimeout:function(){null!=this.stalledTimer&&(this.stalledTimer.cancel(),this.stalledTimer=null)},cancel_evtReconnectTimeout:function(){null!=this.reconnectTimer&&(this.reconnectTimer.cancel(),this.reconnectTimer=null)},cancel_evtRhbTimeout:function(){null!=this.rhbTimer&&(this.rhbTimer.cancel(),this.rhbTimer=null)},cancel_evtIdleTimeout:function(){null!=this.idleTimer&&(this.idleTimer.cancel(),this.idleTimer=null)},cancel_evtPollingTimeout:function(){null!=this.pollingTimer&&(this.pollingTimer.cancel(),this.pollingTimer=null)},cancel_evtCtrlTimeout:function(){null!=this.ctrlTimer&&(this.ctrlTimer.cancel(),this.ctrlTimer=null)},cancel_evtRecoveryTimeout:function(){null!=this.recoveryTimer&&(this.recoveryTimer.cancel(),this.recoveryTimer=null)},waitingInterval:function(t,e){var s=Ze.minus(a.now()/1e3,e);return s<t?t-s:0},exit_tr:function(){this.evtEndSession()},entry_m111:function(t,e){this.evtRetry(t,e),this.schedule_evtRetryTimeout(e)},entry_m112:function(t){var e=this.waitingInterval(this.delayCounter.get_currentRetryDelay(),this.connectTs);this.evtRetry(t,e),this.schedule_evtRetryTimeout(e)},entry_m113:function(t){var e=this.randomPause(this.options.firstRetryMaxDelay);this.evtRetry(t,e),this.schedule_evtRetryTimeout(e)},entry_m115:function(t){this.evtRetry(t),this.evtRetryTimeout()},entry_rec:function(t,e){oi.isErrorEnabled()&&oi.error("Recovering connection in "+t+" ms. Cause: "+j(e)),this.evtStartRecovery(),this.schedule_evtRecoveryTimeout(t)},exit_w:function(){this.cancel_evtKeepaliveTimeout(),this.cancel_evtStalledTimeout(),this.cancel_evtReconnectTimeout(),this.cancel_evtRhbTimeout()},exit_ws:function(){this.cancel_evtTransportTimeout(),this.cancel_evtKeepaliveTimeout(),this.cancel_evtStalledTimeout(),this.cancel_evtReconnectTimeout(),this.cancel_evtRhbTimeout()},exit_wp:function(){this.cancel_evtTransportTimeout(),this.cancel_evtIdleTimeout(),this.cancel_evtPollingTimeout()},exit_hs:function(){this.cancel_evtTransportTimeout(),this.cancel_evtKeepaliveTimeout(),this.cancel_evtStalledTimeout(),this.cancel_evtReconnectTimeout(),this.cancel_evtRhbTimeout()},exit_hp:function(){this.cancel_evtIdleTimeout(),this.cancel_evtPollingTimeout(),this.cancel_evtRhbTimeout()},exit_ctrl:function(){this.cancel_evtCtrlTimeout(),this.evtDisposeCtrl()},exit_rec:function(){this.cancel_evtRecoveryTimeout(),this.cancel_evtTransportTimeout(),this.cancel_evtRetryTimeout()},exit_keepalive_unit:function(){this.cancel_evtKeepaliveTimeout(),this.cancel_evtStalledTimeout(),this.cancel_evtReconnectTimeout()},exit_w_to_m:function(){this.exit_w(),this.exit_tr()},exit_ws_to_m:function(){this.exit_ws(),this.exit_tr()},exit_wp_to_m:function(){this.exit_wp(),this.exit_tr()},exit_hs_to_m:function(){this.exit_ctrl(),this.exit_hs(),this.exit_tr()},exit_hs_to_rec:function(){this.exit_ctrl(),this.exit_hs()},exit_hp_to_m:function(){this.exit_ctrl(),this.exit_hp(),this.exit_tr()},exit_hp_to_rec:function(){this.exit_ctrl(),this.exit_hp()},exit_ctrl_to_m:function(){this.exit_ctrl(),this.exit_hs(),this.exit_hp(),this.exit_tr()},exit_rec_to_m:function(){this.exit_rec(),this.exit_tr()},randomPause:function(t){return this.randomGenerator(t)},generateFreshReqId:function(){return this.m_nextReqId+=1,this.m_nextReqId},generateFreshSubId:function(){return this.m_nextSubId+=1,this.m_nextSubId},genAbortSubscriptions:function(){for(var t=this.subscriptionManagers,e=t.keys();e.hasNext();)t.get(e.next()).evtExtAbort();this.subscriptionManagers._orderedKeys.compact()},genAckMessagesWS:function(){for(var t=new Ne(this.messageManagers.filter((function(t){return t.isPending()})));t.hasNext();)t.next().evtWSSent()},genAbortMessages:function(){for(var t=new Ne(this.messageManagers);t.hasNext();)t.next().evtAbort();this.messageManagers.compact()},resetSequenceMap:function(){this.sequenceMap.h=Object.create(null)},isSwitching:function(){return 150==this.state.s_m&&(1302==this.state.s_swt||1303==this.state.s_swt)},encodeSwitch:function(t){var e=new Ke;return this.swt_lastReqId=this.generateFreshReqId(),e.LS_reqId(this.swt_lastReqId),e.LS_op("force_rebind"),t&&e.LS_close_socket(!0),null!=this.cause&&(e.LS_cause(this.cause),this.cause=null),ri.isInfoEnabled()&&ri.info("Sending transport switch: "+l.string(e)),e.getEncodedString()},encodeConstrain:function(){var t=new Ke;this.bw_lastReqId=this.generateFreshReqId(),t.LS_reqId(this.bw_lastReqId),t.LS_op("constrain");var e=Pe.sure(this.bw_requestedMaxBandwidth);switch(e._hx_index){case 0:t.LS_requested_max_bandwidth_Float(e.bw);break;case 1:t.LS_requested_max_bandwidth("unlimited")}return ri.isInfoEnabled()&&ri.info("Sending bandwidth constrain: "+l.string(t)),t.getEncodedString()},getPendingControls:function(){var t=[];Pe.sure(this.switchRequest).isPending()&&t.push(Pe.sure(this.switchRequest)),Pe.sure(this.constrainRequest).isPending()&&t.push(Pe.sure(this.constrainRequest));for(var e=this.subscriptionManagers,s=e.keys();s.hasNext();){var i=e.get(s.next());i.isPending()&&t.push(i)}return t},sendControlWS:function(t){Pe.sure(this.ws).send(t.encodeWS())},sendMsgWS:function(t){Pe.sure(this.ws).send(t.encodeWS())},sendPengingControlsWS:function(t){this.sendBatchWS(this.prepareBatchWS("control",t,Pe.sure(this.requestLimit)))},sendPendingMessagesWS:function(){for(var t=[],e=new Ne(this.messageManagers);e.hasNext();){var s=e.next();s.isPending()&&t.push(s)}this.sendBatchWS(this.prepareBatchWS("msg",t,Pe.sure(this.requestLimit)))},sendBatchWS:function(t){for(var e=0;e<t.length;){var s=t[e++];Pe.sure(this.ws).send(s)}},sendHeartbeatWS:function(){ri.isInfoEnabled()&&ri.info("Heartbeat request"),Pe.sure(this.ws).send("heartbeat\r\n\r\n")},sendPendingControlsHTTP:function(t){this.sendBatchHTTP(this.prepareBatchHTTP(t,Pe.sure(this.requestLimit)),"control")},sendPendingMessagesHTTP:function(){for(var t=[],e=new Ne(this.messageManagers);e.hasNext();){var s=e.next();s.isPending()&&t.push(s)}this.sendBatchHTTP(this.prepareBatchHTTP(t,Pe.sure(this.requestLimit)),"msg")},sendHeartbeatHTTP:function(){ri.isInfoEnabled()&&ri.info("Heartbeat request"),this.sendBatchHTTP("\r\n","heartbeat")},sendBatchHTTP:function(t,e){var s=this;this.ctrl_connectTs=a.now()/1e3;var i=Es.build(Pe.sure(this.serverInstanceAddress),"/lightstreamer/"+e+".txt?LS_protocol="+Js+"&LS_session="+this.sessionId),n=this.getHeadersForRequestOtherThanCreate(),r=function(t,e){s.lock.synchronized((function(){t.isDisposed()||s.evtCtrlMessage(e)}))},o=function(t,e){s.lock.synchronized((function(){t.isDisposed()||s.evtCtrlError()}))},h=function(t){s.lock.synchronized((function(){t.isDisposed()||s.evtCtrlDone()}))};this.ctrl_http=this.ctrlFactory(i,t,n,r,o,h)},prepareBatchWS:function(t,e,s){if(e.length<=0)throw new Me("Assertion failure: pendings.length > 0");for(var i=[],n=0,r=e[0].encode(!0);n<e.length;){var a=new Ft;for(a.addSubRequest(t),a.addSubRequest(r),++n;n<e.length&&(r=e[n].encode(!0),a.addSubRequestOnlyIfBodyIsLessThan(r,s));)++n;i.push(a.getBody())}return i},prepareBatchHTTP:function(t,e){if(t.length<=0)throw new Me("Assertion failure: pendings.length > 0");var s=new Ft,i=0,n=t[0].encode(!1);for(s.addSubRequest(n),i=1;i<t.length&&(n=t[i].encode(!1),s.addSubRequestOnlyIfBodyIsLessThan(n,e));)++i;return s.getBody()},getHeadersForRequestOtherThanCreate:function(){return this.options.httpExtraHeadersOnSessionCreationOnly?null:this.options.httpExtraHeaders},getServerAddress:function(){var t=this.details.serverAddress;return null!=t?t:Pe.sure(this.defaultServerAddress)},relateSubManager:function(t){if(null!=this.subscriptionManagers._innerMap.h[t.subId])throw new Me("Assertion failure: subscriptionManagers[subManager.subId] == null");this.subscriptionManagers.set(t.subId,t)},unrelateSubManager:function(t){this.subscriptionManagers.remove(t.subId)},isRelatedWithSubManager:function(t){return h.has(this.subscriptionManagers,t)},relateMsgManager:function(t){this.messageManagers.values.push(new Le(t))},unrelateMsgManager:function(t){this.messageManagers.remove(t)},getAndSetNextMsgProg:function(t){var e=this.sequenceMap.h[t];return null==e&&(e=1),this.sequenceMap.h[t]=e+1,e},onPropertyChange:function(t){this.clientEventDispatcher.onPropertyChange(t)},traceEvent:function(t){ai.isTraceEnabled()&&ai.trace("event: "+t+" "+this.state.toString())},connect:function(){var t=this.details.getServerAddress();if(null==t)throw new Me("Configure the server address before trying to connect");hi.isInfoEnabled()&&hi.info("Connection requested: details: "+l.string(this.details)+" options: "+l.string(this.options)+" env: "+l.string(Te.instance)),this.defaultServerAddress=t,this.evtExtConnect()},disconnect:function(){hi.isInfoEnabled()&&hi.info("Disconnection requested"),this.evtExtDisconnect(G.TC_api)},getStatus:function(){return this.m_status},sendMessage:function(t,e,s,i,n){if(n||!this.state.inDisconnected()&&!this.state.inRetryUnit())if(null!=e){if(!new r("^[a-zA-Z0-9_]*$","").match(e))throw new v("The given sequence name is not valid. Use only alphanumeric characters plus underscore or null");var a=new rt(t,e,s,i,n,this);hi.isInfoEnabled()&&hi.info("Message sending requested: "+l.string(a)),a.evtExtSendMessage()}else a=new rt(t,"UNORDERED_MESSAGES",s,i,n,this),hi.isInfoEnabled()&&hi.info("Message sending requested: "+l.string(a)),a.evtExtSendMessage();else{if(hi.isInfoEnabled()){var o=new ks;o.h.text=t,o.h.sequence=null!=e?e:"UNORDERED_MESSAGES",o.h.timeout=null==s?"null":""+s,o.h.enqueueWhileDisconnected=null==n?"null":""+n,hi.isInfoEnabled()&&hi.info("Message sending requested: "+(null==o?"null":ks.stringify(o.h)))}if(ci.isWarnEnabled()&&ci.warn("Message "+(null!=e?e:"UNORDERED_MESSAGES")+" "+t+" aborted"),null!=i){var h=new nt;h.addListener(i),h.onAbort(t,!1)}}},subscribeExt:function(t,e){if(null==e&&(e=!1),t.isActive())throw new Me("Cannot subscribe to an active Subscription");if(null==t.fetchItems()&&null==t.getItemGroup())throw new v("Specify property 'items' or 'itemGroup'");if(null==t.fetchFields()&&null==t.getFieldSchema())throw new v("Specify property 'fields' or 'fieldSchema'");var s=new Ut(t,this);hi.isInfoEnabled()&&hi.info((e?"Internal subscription":"Subscription")+" requested: subId: "+s.subId+" "+l.string(t)),s.evtExtSubscribe()},unsubscribe:function(t){var e=t.fetch_subManager();if(null!=e){if(!this.isRelatedWithSubManager(e))throw new v("The Subscription is not subscribed to this Client");hi.isInfoEnabled()&&hi.info("Unsubscription requested: subId: "+e.subId+" "+l.string(t)),e.evtExtUnsubscribe()}},getSubscriptions:function(){for(var t=[],e=this.subscriptionManagers,s=e.keys();s.hasNext();){var i=e.get(s.next()),n=i instanceof Ut?i:null;if(null!=n){var r=n.m_subscription;r.isActive()&&!r.isInternal()&&t.push(r)}}return t},__class__:W};var H=i["com.lightstreamer.client.internal._ClientMachine.BestForCreatingEnum"]={__ename__:!0,__constructs__:null,BFC_ws:{_hx_name:"BFC_ws",_hx_index:0,__enum__:"com.lightstreamer.client.internal._ClientMachine.BestForCreatingEnum",toString:s},BFC_http:{_hx_name:"BFC_http",_hx_index:1,__enum__:"com.lightstreamer.client.internal._ClientMachine.BestForCreatingEnum",toString:s},BFC_none:{_hx_name:"BFC_none",_hx_index:2,__enum__:"com.lightstreamer.client.internal._ClientMachine.BestForCreatingEnum",toString:s}};H.__constructs__=[H.BFC_ws,H.BFC_http,H.BFC_none];var V=i["com.lightstreamer.client.internal._ClientMachine.BestForBindingEnum"]={__ename__:!0,__constructs__:null,BFB_none:{_hx_name:"BFB_none",_hx_index:0,__enum__:"com.lightstreamer.client.internal._ClientMachine.BestForBindingEnum",toString:s},BFB_ws_streaming:{_hx_name:"BFB_ws_streaming",_hx_index:1,__enum__:"com.lightstreamer.client.internal._ClientMachine.BestForBindingEnum",toString:s},BFB_ws_polling:{_hx_name:"BFB_ws_polling",_hx_index:2,__enum__:"com.lightstreamer.client.internal._ClientMachine.BestForBindingEnum",toString:s},BFB_http_streaming:{_hx_name:"BFB_http_streaming",_hx_index:3,__enum__:"com.lightstreamer.client.internal._ClientMachine.BestForBindingEnum",toString:s},BFB_http_polling:{_hx_name:"BFB_http_polling",_hx_index:4,__enum__:"com.lightstreamer.client.internal._ClientMachine.BestForBindingEnum",toString:s}};V.__constructs__=[V.BFB_none,V.BFB_ws_streaming,V.BFB_ws_polling,V.BFB_http_streaming,V.BFB_http_polling];var z=i["com.lightstreamer.client.internal._ClientMachine.SyncCheckResult"]={__ename__:!0,__constructs__:null,SCR_good:{_hx_name:"SCR_good",_hx_index:0,__enum__:"com.lightstreamer.client.internal._ClientMachine.SyncCheckResult",toString:s},SCR_not_good:{_hx_name:"SCR_not_good",_hx_index:1,__enum__:"com.lightstreamer.client.internal._ClientMachine.SyncCheckResult",toString:s},SCR_bad:{_hx_name:"SCR_bad",_hx_index:2,__enum__:"com.lightstreamer.client.internal._ClientMachine.SyncCheckResult",toString:s}};z.__constructs__=[z.SCR_good,z.SCR_not_good,z.SCR_bad];var Y=i["com.lightstreamer.client.internal._ClientMachine.RetryCause"]={__ename__:!0,__constructs__:null,standardError:(e=function(t,e){return{_hx_index:0,code:t,msg:e,__enum__:"com.lightstreamer.client.internal._ClientMachine.RetryCause",toString:s}},e._hx_name="standardError",e.__params__=["code","msg"],e),ws_unavailable:{_hx_name:"ws_unavailable",_hx_index:1,__enum__:"com.lightstreamer.client.internal._ClientMachine.RetryCause",toString:s},ws_error:{_hx_name:"ws_error",_hx_index:2,__enum__:"com.lightstreamer.client.internal._ClientMachine.RetryCause",toString:s},http_error:{_hx_name:"http_error",_hx_index:3,__enum__:"com.lightstreamer.client.internal._ClientMachine.RetryCause",toString:s},idle_timeout:{_hx_name:"idle_timeout",_hx_index:4,__enum__:"com.lightstreamer.client.internal._ClientMachine.RetryCause",toString:s},stalled_timeout:{_hx_name:"stalled_timeout",_hx_index:5,__enum__:"com.lightstreamer.client.internal._ClientMachine.RetryCause",toString:s},ws_timeout:{_hx_name:"ws_timeout",_hx_index:6,__enum__:"com.lightstreamer.client.internal._ClientMachine.RetryCause",toString:s},http_timeout:{_hx_name:"http_timeout",_hx_index:7,__enum__:"com.lightstreamer.client.internal._ClientMachine.RetryCause",toString:s},recovery_timeout:{_hx_name:"recovery_timeout",_hx_index:8,__enum__:"com.lightstreamer.client.internal._ClientMachine.RetryCause",toString:s},prog_mismatch:(e=function(t,e){return{_hx_index:9,expected:t,actual:e,__enum__:"com.lightstreamer.client.internal._ClientMachine.RetryCause",toString:s}},e._hx_name="prog_mismatch",e.__params__=["expected","actual"],e),page_frozen:{_hx_name:"page_frozen",_hx_index:10,__enum__:"com.lightstreamer.client.internal._ClientMachine.RetryCause",toString:s}};Y.__constructs__=[Y.standardError,Y.ws_unavailable,Y.ws_error,Y.http_error,Y.idle_timeout,Y.stalled_timeout,Y.ws_timeout,Y.http_timeout,Y.recovery_timeout,Y.prog_mismatch,Y.page_frozen];var G=i["com.lightstreamer.client.internal._ClientMachine.TerminationCause"]={__ename__:!0,__constructs__:null,TC_standardError:(e=function(t,e){return{_hx_index:0,code:t,msg:e,__enum__:"com.lightstreamer.client.internal._ClientMachine.TerminationCause",toString:s}},e._hx_name="TC_standardError",e.__params__=["code","msg"],e),TC_otherError:(e=function(t){return{_hx_index:1,error:t,__enum__:"com.lightstreamer.client.internal._ClientMachine.TerminationCause",toString:s}},e._hx_name="TC_otherError",e.__params__=["error"],e),TC_api:{_hx_name:"TC_api",_hx_index:2,__enum__:"com.lightstreamer.client.internal._ClientMachine.TerminationCause",toString:s}};G.__constructs__=[G.TC_standardError,G.TC_otherError,G.TC_api];var K=i["com.lightstreamer.client.internal._ClientMachine.RecoveryRetryCause"]={__ename__:!0,__constructs__:null,RRC_transport_timeout:{_hx_name:"RRC_transport_timeout",_hx_index:0,__enum__:"com.lightstreamer.client.internal._ClientMachine.RecoveryRetryCause",toString:s},RRC_transport_error:{_hx_name:"RRC_transport_error",_hx_index:1,__enum__:"com.lightstreamer.client.internal._ClientMachine.RecoveryRetryCause",toString:s}};function j(t){switch(t._hx_index){case 0:return t.code+" - "+t.msg;case 1:return"Websocket transport not available";case 2:return"Websocket error";case 3:return"HTTP error";case 4:return"idleTimeout expired";case 5:return"stalledTimeout expired";case 6:return"Websocket connect timeout expired";case 7:return"HTTP connect timeout expired";case 8:return"sessionRecoveryTimeout expired";case 9:return"Recovery counter mismatch: expected "+t.expected+" but found "+t.actual;case 10:return"page frozen"}}K.__constructs__=[K.RRC_transport_timeout,K.RRC_transport_error];var Q=function(){};Q.__name__=!0,Q.__isInterface__=!0,Q.prototype={__class__:Q};var X=function(t){this.client=t};X.__name__=!0,X.__interfaces__=[Q],X.prototype={isPending:function(){return 150==this.client.state.s_m&&1302==this.client.state.s_swt},encode:function(t){return this.client.encodeSwitch(t)},encodeWS:function(){return"control\r\n"+this.encode(!0)},__class__:X};var Z=function(t){this.client=t};Z.__name__=!0,Z.__interfaces__=[Q],Z.prototype={isPending:function(){return 1202==this.client.state.s_bw},encode:function(t){return this.client.encodeConstrain()},encodeWS:function(){return"control\r\n"+this.encode(!0)},__class__:Z};var J=function(t,e,s){this.p=t,this.k=e,this.s=s};J.__name__=!0,J.prototype={toString:function(){return"<w_p="+this.p+" w_k="+this.k+" w_s="+this.s+">"},__class__:J};var $=function(t){this.m=t};$.__name__=!0,$.prototype={toString:function(){var t="<ws_m="+this.m;return null!=this.p&&(t+=" ws_p="+this.p),null!=this.k&&(t+=" ws_k="+this.k),null!=this.s&&(t+=" ws_s="+this.s),t+=">"},__class__:$};var tt=function(t){this.m=t};tt.__name__=!0,tt.prototype={toString:function(){var t="<wp_m="+this.m;return null!=this.p&&(t+=" wp_p="+this.p),null!=this.c&&(t+=" wp_c="+this.c),null!=this.s&&(t+=" wp_s="+this.s),t+=">"},__class__:tt};var et=function(t){this.m=t};et.__name__=!0,et.prototype={toString:function(){var t="<hs_m="+this.m;return null!=this.p&&(t+=" hs_p="+this.p),null!=this.k&&(t+=" hs_k="+this.k),t+=">"},__class__:et};var st=function(t){this.m=t};st.__name__=!0,st.prototype={toString:function(){return"<hp_m="+this.m+">"},__class__:st};var it=function(){this.s_mpn=new Et,this.s_m=100,this.s_du=20,this.s_nr=1400};it.__name__=!0,it.prototype={goto_m_from_w:function(t){this.clear_w(),this.goto_m_from_session(t)},goto_m_from_ws:function(t){this.clear_ws(),this.goto_m_from_session(t)},goto_rec_from_w:function(){this.clear_w(),this.goto_rec()},goto_rec_from_ws:function(){this.clear_ws(),this.goto_rec()},goto_m_from_wp:function(t){this.clear_wp(),this.goto_m_from_session(t)},goto_rec_from_wp:function(){this.clear_wp(),this.goto_rec()},goto_m_from_hs:function(t){this.clear_hs(),this.s_ctrl=null,this.s_h=null,this.goto_m_from_session(t)},goto_m_from_rec:function(t){this.s_tr=null,this.goto_m_from_session(t)},goto_rec_from_hs:function(){this.clear_hs(),this.s_ctrl=null,this.s_h=null,this.goto_rec()},goto_m_from_hp:function(t){this.clear_hp(),this.s_ctrl=null,this.s_h=null,this.goto_m_from_session(t)},goto_rec_from_hp:function(){this.clear_hp(),this.s_ctrl=null,this.s_h=null,this.goto_rec()},goto_rec:function(){this.s_tr=260,this.s_rec=1e3,this.traceState()},goto_m_from_session:function(t){this.s_tr=null,this.s_swt=null,this.s_bw=null,this.s_m=t,this.traceState()},goto_m_from_ctrl:function(t){this.clear_hs(),this.clear_hp(),this.s_ctrl=null,this.s_h=null,this.goto_m_from_session(t)},goto_200_from_rec:function(){this.s_rec=null,this.s_tr=200,this.traceState()},clear_w:function(){this.s_w=null,this.s_rhb=null,this.s_slw=null},clear_ws:function(){this.s_ws=null,this.s_rhb=null,this.s_slw=null},clear_wp:function(){this.s_wp=null},clear_hs:function(){this.s_hs=null,this.s_rhb=null,this.s_slw=null},clear_hp:function(){this.s_hp=null,this.s_rhb=null},isSwitching:function(){return 150==this.s_m&&(1302==this.s_swt||1303==this.s_swt)},inPushing:function(){return!!this.inStreaming()||this.inPolling()},inStreaming:function(){var t,e;return!!(e=300==(null!=(t=this.s_w)?t.p:null)||510==(null!=(t=this.s_ws)?t.p:null))||810==(null!=(e=this.s_hs)?e.p:null)},inPolling:function(){var t;if(220!=this.s_tr&&230!=this.s_tr){var e=this.s_wp;t=611==(null!=e?e.p:null)}else t=!0;return!!(!!t||901==(null!=(t=this.s_hp)?t.m:null))||1001==this.s_rec},inRetryUnit:function(){switch(this.s_m){case 110:case 111:case 112:case 113:case 114:case 115:case 116:return!0;default:return!1}},inDisconnected:function(){return 100==this.s_m},toString:function(){var t="<m="+this.s_m;return t+=" du="+this.s_du,null!=this.s_tr&&(t+=" tr="+this.s_tr),null!=this.s_w&&(t+=" "+l.string(this.s_w)),null!=this.s_ws&&(t+=" "+l.string(this.s_ws)),null!=this.s_wp&&(t+=" "+l.string(this.s_wp)),null!=this.s_hs&&(t+=" "+l.string(this.s_hs)),null!=this.s_hp&&(t+=" "+l.string(this.s_hp)),null!=this.s_rec&&(t+=" rec="+this.s_rec),null!=this.s_h&&(t+=" h="+this.s_h),null!=this.s_ctrl&&(t+=" ctrl="+this.s_ctrl),null!=this.s_swt&&(t+=" swt="+this.s_swt),null!=this.s_bw&&(t+=" bw="+this.s_bw),null!=this.s_rhb&&(t+=" rhb="+this.s_rhb),null!=this.s_slw&&(t+=" slw="+this.s_slw),t+=" nr="+this.s_nr,null!=this.s_mpn&&(t+=" "+l.string(this.s_mpn)),t+=">"},traceState:function(){ai.isTraceEnabled()&&ai.trace("goto: "+this.toString())},__class__:it};var nt=function(){T.call(this)};nt.__name__=!0,nt.__super__=T,nt.prototype=n(T.prototype,{onAbort:function(t,e){this.dispatchToAll((function(s){null!=s.onAbort&&s.onAbort(t,e)}))},onDeny:function(t,e,s){this.dispatchToAll((function(i){null!=i.onDeny&&i.onDeny(t,e,s)}))},onDiscarded:function(t){this.dispatchToAll((function(e){null!=e.onDiscarded&&e.onDiscarded(t)}))},onError:function(t){this.dispatchToAll((function(e){null!=e.onError&&e.onError(t)}))},onProcessed:function(t,e){this.dispatchToAll((function(s){null!=s.onProcessed&&s.onProcessed(t,e)}))},__class__:nt});var rt=function(t,e,s,i,n,r){this.eventDispatcher=new nt,this.txt=t,this.sequence=e,this.prog="UNORDERED_MESSAGES"!=e||null!=i?r.getAndSetNextMsgProg(e):-1,this.maxWait=s,this.delegate=i,null!=i&&this.eventDispatcher.addListener(i),this.enqueueWhileDisconnected=n,this.client=r,this.s_m=null!=i?10:"UNORDERED_MESSAGES"!=e?20:30,r.relateMsgManager(this)};rt.__name__=!0,rt.__interfaces__=[Q],rt.prototype={finalize:function(){this.client.unrelateMsgManager(this)},evtExtSendMessage:function(){switch(this.traceEvent("sendMessage"),this.s_m){case 10:this.goto(11),this.client.evtSendMessage(this);break;case 20:this.goto(21),this.client.evtSendMessage(this);break;case 30:this.goto(31),this.client.evtSendMessage(this)}},evtMSGFAIL:function(t,e){switch(this.traceEvent("MSGFAIL"),this.s_m){case 10:this.finalize(),this.goto(13);break;case 11:case 12:this.doMSGFAIL(t,e),this.finalize(),this.goto(14)}},evtMSGDONE:function(t){switch(this.traceEvent("MSGDONE"),this.s_m){case 10:this.finalize(),this.goto(13);break;case 11:case 12:this.doMSGDONE(t),this.finalize(),this.goto(13)}},evtREQOK:function(t){switch(this.traceEvent("REQOK"),this.s_m){case 11:t==this.lastReqId&&this.goto(12);break;case 21:t==this.lastReqId&&(this.finalize(),this.goto(22));break;case 31:t==this.lastReqId&&(this.finalize(),this.goto(33))}},evtREQERR:function(t,e,s){switch(this.traceEvent("REQERR"),this.s_m){case 11:t==this.lastReqId&&(this.doREQERR(e,s),this.finalize(),this.goto(14));break;case 21:t==this.lastReqId&&(this.finalize(),this.goto(23));break;case 31:t==this.lastReqId&&(this.finalize(),this.goto(34))}},evtAbort:function(){switch(this.traceEvent("abort"),this.s_m){case 11:case 12:this.doAbort(),this.finalize(),this.goto(15);break;case 21:ci.isWarnEnabled()&&ci.warn("Message "+this.sequence+":"+this.prog+" aborted"),this.finalize(),this.goto(24);break;case 31:ci.isWarnEnabled()&&ci.warn("Message "+this.sequence+":"+this.prog+" aborted"),this.finalize(),this.goto(35)}},evtWSSent:function(){this.traceEvent("ws.sent"),31==this.s_m&&(this.finalize(),this.goto(32))},isPending:function(){return 11==this.s_m||21==this.s_m||31==this.s_m},encode:function(t){return this.encodeMsg(t)},encodeWS:function(){return"msg\r\n"+this.encode(!0)},doMSGDONE:function(t){this.fireOnProcessed(t)},doMSGFAIL:function(t,e){38==t||39==t?this.fireOnDiscarded():t<=0?this.fireOnDeny(t,e):32!=t&&33!=t&&this.fireOnError()},doREQERR:function(t,e){32!=t&&33!=t&&this.fireOnError()},doAbort:function(){this.fireOnAbort()},encodeMsg:function(t){var e="UNORDERED_MESSAGES"!=this.sequence,s=null!=this.delegate,i=new Ke;return this.lastReqId=this.client.generateFreshReqId(),i.LS_reqId(this.lastReqId),i.LS_message(this.txt),e&&s?(i.LS_sequence(this.sequence),i.LS_msg_prog(this.prog),this.maxWait>=0&&i.LS_max_wait(this.maxWait)):!e&&s?i.LS_msg_prog(this.prog):e&&!s?(i.LS_outcome(!1),i.LS_sequence(this.sequence),i.LS_msg_prog(this.prog),this.maxWait>=0&&i.LS_max_wait(this.maxWait)):e||s||(i.LS_outcome(!1),t&&i.LS_ack(!1)),ri.isInfoEnabled()&&ri.info("Sending message: "+l.string(i)),i.getEncodedString()},fireOnProcessed:function(t){ci.isInfoEnabled()&&ci.info("Message "+this.sequence+":"+this.prog+" processed"),this.eventDispatcher.onProcessed(this.txt,t)},fireOnDiscarded:function(){ci.isWarnEnabled()&&ci.warn("Message "+this.sequence+":"+this.prog+" discarded"),this.eventDispatcher.onDiscarded(this.txt)},fireOnDeny:function(t,e){ci.isWarnEnabled()&&ci.warn("Message "+this.sequence+":"+this.prog+" denied: "+t+" - "+e),this.eventDispatcher.onDeny(this.txt,t,e)},fireOnError:function(){ci.isWarnEnabled()&&ci.warn("Message "+this.sequence+":"+this.prog+" failed"),this.eventDispatcher.onError(this.txt)},fireOnAbort:function(){ci.isWarnEnabled()&&ci.warn("Message "+this.sequence+":"+this.prog+" aborted"),this.eventDispatcher.onAbort(this.txt,!1)},traceEvent:function(t){ai.isTraceEnabled()&&ai.trace("msg#"+t+"("+this.sequence+":"+this.prog+") in "+this.s_m)},goto:function(t){this.s_m=t,ai.isTraceEnabled()&&ai.trace("msg#goto("+this.sequence+":"+this.prog+") "+this.s_m)},toString:function(){var t=Ce._new();return Ce.set(t,"text",this.txt),Ce.set(t,"sequence",this.sequence),Ce.set(t,"prog",this.prog),Ce.set(t,"timeout",this.maxWait),Ce.set(t,"enqueueWhileDisconnected",this.enqueueWhileDisconnected),ks.stringify(t.h)},__class__:rt};var at=function(t,e,s){this.items=new Ps,this.s_m=1,this.lock=e.lock,this.client=e,this.subscription=t,this.m_subId=s};at.__name__=!0,at.prototype={finalize:function(){},evtAbort:function(){this.traceEvent("abort"),1==this.s_m?(this.doAbort(),this.goto(1)):2==this.s_m&&(this.doAbort(),this.goto(1),this.genDisposeItems())},evtOnSUB:function(t,e,s,i,n){this.traceEvent("onSUB"),1==this.s_m&&(this.doSUB(t,e),this.goto(2))},evtOnCONF:function(t){this.traceEvent("onCONF"),2==this.s_m&&(this.doCONF(t),this.goto(2))},evtOnCS:function(t){this.traceEvent("onCS"),2==this.s_m&&(this.doCS(t),this.goto(2))},evtOnEOS:function(t){this.traceEvent("onEOS"),2==this.s_m&&(this.doEOS(t),this.goto(2))},evtUpdate:function(t,e){this.traceEvent("update"),2==this.s_m&&(this.doUpdate(t,e),this.goto(2))},evtUnsubscribe:function(){this.traceEvent("unsubscribe"),1==this.s_m?(this.finalize(),this.goto(3)):2==this.s_m&&(this.finalize(),this.goto(3),this.genDisposeItems())},evtOnUNSUB:function(){this.traceEvent("onUNSUB"),2==this.s_m&&(this.finalize(),this.goto(3),this.genDisposeItems())},evtDispose:function(){this.traceEvent("dispose"),1!=this.s_m&&2!=this.s_m||(this.finalize(),this.goto(3),this.genDisposeItems())},evtSetRequestedMaxFrequency:function(t){},getValue:function(t,e){var s=this.items.h[t];return null!=s?s.getValue(e):null},getCommandValue:function(t,e,s){throw new Me("Unsupported operation")},createItem:function(t){throw new Me("Abstract method")},doSUB:function(t,e){var s=this.subscription.fetchItems(),i=this.subscription.fetchFields();if(null!=s&&t!=s.length)throw new Me("Assertion failure: items != null ? nItems == items.length : true");if(null!=i&&e!=i.length)throw new Me("Assertion failure: fields != null ? nFields == fields.length : true")},doUpdate:function(t,e){this.selectItem(t).evtUpdate(e)},doEOS:function(t){this.selectItem(t).evtOnEOS()},doCS:function(t){this.selectItem(t).evtOnCS()},doCONF:function(t){this.realMaxFrequency=t,this.subscription.fireOnRealMaxFrequency(t,this.m_subId)},doAbort:function(){this.realMaxFrequency=null},genDisposeItems:function(){for(var t=this.items.copy(),e=t.keys();e.hasNext();)t.get(e.next()).evtDispose(this)},selectItem:function(t){var e=this.items.h[t];return null==e&&(e=this.createItem(t),this.items.h[t]=e),e},unrelate:function(t){this.items.remove(t)},traceEvent:function(t){ai.isTraceEnabled()&&ai.trace("sub#mod#"+t+"("+this.m_subId+") in "+this.s_m)},goto:function(t){this.s_m=t,ai.isTraceEnabled()&&ai.trace("sub#mod#goto("+this.m_subId+") "+this.s_m)},__class__:at};var ot=function(t,e,s){at.call(this,t,e,s)};ot.__name__=!0,ot.__super__=at,ot.prototype=n(at.prototype,{evtOnSUB:function(t,e,s,i,n){this.traceEvent("onSUB"),1==this.s_m&&(this.doSUBCMD(t,e,s,i),this.goto(2))},getCommandValue:function(t,e,s){var i=this.items.h[t];return null!=i?i.getCommandValue(e,s):null},doSUBCMD:function(t,e,s,i){var n=this.subscription.fetchItems(),r=this.subscription.fetchFields();if(null!=n&&t!=n.length)throw new Me("Assertion failure: items != null ? nItems == items.length : true");if(null!=r&&e!=r.length)throw new Me("Assertion failure: fields != null ? nFields == fields.length : true");if(null!=r&&s-1!=r.indexOf("command"))throw new Me('Assertion failure: fields != null ? cmdIdx - 1 == fields.indexOf("command") : true');if(null!=r&&i-1!=r.indexOf("key"))throw new Me('Assertion failure: fields != null ? keyIdx - 1 == fields.indexOf("key") : true')},__class__:ot});var ht=function(t,e,s){ot.call(this,t,e,s)};ht.__name__=!0,ht.__super__=ot,ht.prototype=n(ot.prototype,{createItem:function(t){return new Yt(t,this.subscription,this.client,this.m_subId)},__class__:ht});var ut=function(t,e,s){ot.call(this,t,e,s)};ut.__name__=!0,ut.__super__=ot,ut.prototype=n(ot.prototype,{evtOnSUB:function(t,e,s,i,n){this.traceEvent("onSUB"),1==this.s_m&&(this.doSUBCMD2Level(t,e,s,i,n),this.goto(2))},evtSetRequestedMaxFrequency:function(t){switch(this.traceEvent("setRequestedMaxFrequency"),this.s_m){case 1:case 2:this.doSetRequestedMaxFrequency(t),this.goto(this.s_m),this.genSetRequestedMaxFrequency()}},evtOnRealMaxFrequency2LevelAdded:function(t){this.traceEvent("onRealMaxFrequency2LevelAdded"),2==this.s_m&&(this.doAggregateFrequenciesWhenFreqIsAdded(t),this.goto(2))},evtOnRealMaxFrequency2LevelRemoved:function(){this.traceEvent("onRealMaxFrequency2LevelRemoved"),2==this.s_m&&(this.doAggregateFrequenciesWhenFreqIsRemoved(),this.goto(2))},evtOnCONF:function(t){this.traceEvent("onCONF"),2==this.s_m&&(this.doCONF2Level(t),this.doAggregateFrequenciesWhenFreqIsAdded(t),this.goto(2))},createItem:function(t){return new Gt(t,this.subscription,this,this.client,this.m_subId)},doSUBCMD2Level:function(t,e,s,i,n){var r=this.subscription.fetchItems(),a=this.subscription.fetchFields();if(null!=r&&t!=r.length)throw new Me("Assertion failure: items != null ? nItems == items.length : true");if(null!=a&&e!=a.length)throw new Me("Assertion failure: fields != null ? nFields == fields.length : true");if(null!=a&&s-1!=a.indexOf("command"))throw new Me('Assertion failure: fields != null ? cmdIdx - 1 == fields.indexOf("command") : true');if(null!=a&&i-1!=a.indexOf("key"))throw new Me('Assertion failure: fields != null ? keyIdx - 1 == fields.indexOf("key") : true');this.requestedMaxFrequency=n},doSetRequestedMaxFrequency:function(t){this.requestedMaxFrequency=t},genSetRequestedMaxFrequency:function(){for(var t=this.items,e=t.keys();e.hasNext();)U.__cast(t.get(e.next()),Gt).evtSetRequestedMaxFrequency()},doCONF2Level:function(t){this.realMaxFrequency=t},maxFreq:function(t,e){var s;if(null==t)s=e;else switch(t._hx_index){case 0:var i=t.freq;if(null==e)s=t;else switch(e._hx_index){case 0:s=_s.RFreqLimited(Math.max(i,e.freq));break;case 1:s=e}break;case 1:s=t}return s},doAggregateFrequenciesWhenFreqIsAdded:function(t){var e=this.maxFreq(this.aggregateRealMaxFrequency,t),s=this.aggregateRealMaxFrequency;this.aggregateRealMaxFrequency=e,bs(s,e)||this.subscription.fireOnRealMaxFrequency(e,this.m_subId)},doAggregateFrequenciesWhenFreqIsRemoved:function(){for(var t=this.realMaxFrequency,e=!1,s=this.items,i=s.keys();i.hasNext();){for(var n=U.__cast(s.get(i.next()),Gt).keys.h,r=Object.keys(n),a=r.length,o=0;o<a;)if((t=this.maxFreq(t,U.__cast(n[r[o++]],te).realMaxFrequency))==_s.RFreqUnlimited){e=!0;break}if(e)break}var h=this.aggregateRealMaxFrequency;this.aggregateRealMaxFrequency=t,bs(h,t)||this.subscription.fireOnRealMaxFrequency(t,this.m_subId)},__class__:ut});var lt=function(t,e,s){at.call(this,t,e,s)};lt.__name__=!0,lt.__super__=at,lt.prototype=n(at.prototype,{createItem:function(t){return new Kt(t,this.subscription,this.client,this.m_subId)},__class__:lt});var ct=function(t,e,s){at.call(this,t,e,s)};ct.__name__=!0,ct.__super__=at,ct.prototype=n(at.prototype,{createItem:function(t){return new Qt(t,this.subscription,this.client,this.m_subId)},__class__:ct});var dt=function(t,e,s){at.call(this,t,e,s)};dt.__name__=!0,dt.__super__=at,dt.prototype=n(at.prototype,{createItem:function(t){return new Xt(t,this.subscription,this.client,this.m_subId)},__class__:dt});var _t=function(t,e){this.mpn_badge_reset_requested=!1,this.mpn_filter_pendings=[],this.mpn_snapshotSet=new je,this.mpn_candidate_devices=[],this.mpnSubscriptionManagers=new xe,W.call(this,t,e),this.mpnRegisterRequest=new St(this),this.mpnFilterUnsubscriptionRequest=new yt(this),this.mpnBadgeResetRequest=new bt(this)};_t.__name__=!0,_t.__super__=W,_t.prototype=n(W.prototype,{evtExtConnect_NextRegion:function(){return this.evtExtConnect_MpnRegion()},evtExtConnect_MpnRegion:function(){var t=!0;return 401==this.state.s_mpn.m&&(this.state.s_mpn.m=403,this.state.traceState(),t=this.evtExtConnect_NetworkReachabilityRegion(),this.genSendMpnRegister()),t&&this.evtExtConnect_NetworkReachabilityRegion(),!1},evtREQOK_Forward:function(t){this.traceEvent("mpn:REQOK");var e=!0;return 403==this.state.s_mpn.m&&t==this.mpn_lastRegisterReqId?(this.state.s_mpn.m=404,this.state.traceState(),e=this.evtREQOK_TransportRegion(t)):406==this.state.s_mpn.m&&t==this.mpn_lastRegisterReqId?(this.state.s_mpn.m=407,this.state.traceState(),e=this.evtREQOK_TransportRegion(t)):453==this.state.s_mpn.tk&&t==this.mpn_lastRegisterReqId?(this.state.s_mpn.tk=454,this.state.traceState(),e=this.evtREQOK_TransportRegion(t)):432==this.state.s_mpn.ft&&t==this.mpn_filter_lastDeactivateReqId?(this.doREQMpnUnsubscribeFilter(),this.state.s_mpn.ft=430,this.state.traceState(),e=this.evtREQOK_TransportRegion(t),this.evtMpnCheckFilter()):442==this.state.s_mpn.bg&&t==this.mpn_badge_lastResetReqId&&(this.doREQOKMpnResetBadge(),e=this.evtREQOK_TransportRegion(t),this.state.s_mpn.bg=440,this.state.traceState(),this.evtMpnCheckReset()),e},evtREQERR_Forward:function(t,e,s){this.traceEvent("mpn:REQERR");var i=!0;return 403==this.state.s_mpn.m&&t==this.mpn_lastRegisterReqId?(this.notifyDeviceError(e,s),this.state.s_mpn.m=402,this.state.traceState(),i=this.evtREQERR_TransportRegion(t,e,s),this.evtMpnCheckNext()):406==this.state.s_mpn.m&&t==this.mpn_lastRegisterReqId?(this.notifyDeviceError(e,s),this.state.s_mpn.m=408,this.state.traceState(),i=this.evtREQERR_TransportRegion(t,e,s),this.evtMpnCheckNext()):453==this.state.s_mpn.tk&&t==this.mpn_lastRegisterReqId?(this.notifyDeviceError(e,s),this.state.s_mpn.tk=452,this.state.traceState(),i=this.evtREQERR_TransportRegion(t,e,s),this.evtMpnCheckNext()):432==this.state.s_mpn.ft&&t==this.mpn_filter_lastDeactivateReqId?(this.doREQMpnUnsubscribeFilter(),this.state.s_mpn.ft=430,this.state.traceState(),i=this.evtREQERR_TransportRegion(t,e,s),this.evtMpnCheckFilter()):442==this.state.s_mpn.bg&&t==this.mpn_badge_lastResetReqId&&(this.doREQERRMpnResetBadge(),this.notifyOnBadgeResetFailed(e,s),this.state.s_mpn.bg=440,this.state.traceState(),i=this.evtREQERR_TransportRegion(t,e,s),this.evtMpnCheckReset()),i},evtRetry_NextRegion:function(){return this.evtRetry_MpnRegion()},evtRetry_MpnRegion:function(){switch(this.state.s_mpn.m){case 403:case 404:this.state.s_mpn.m=403,this.state.traceState();break;case 405:this.doRemoveMpnSpecialListeners(),this.state.s_mpn.m=406,this.state.s_mpn.st=null,this.state.s_mpn.tk=null,this.state.s_mpn.sbs=null,this.state.s_mpn.ft=null,this.state.s_mpn.bg=null,this.state.traceState(),this.genUnsubscribeMpnSpecialItems();break;case 406:case 407:this.state.s_mpn.m=406,this.state.traceState()}return!1},evtTerminate_NextRegion:function(){return this.evtTerminate_MpnRegion()},evtTerminate_MpnRegion:function(){var t=!0;switch(this.state.s_mpn.m){case 403:case 404:case 406:case 407:this.state.s_mpn.m=401,this.state.traceState(),t=this.evtTerminate_NetworkReachabilityRegion(),this.evtResetMpnDevice();break;case 405:this.doRemoveMpnSpecialListeners(),this.state.s_mpn.m=401,this.state.s_mpn.st=null,this.state.s_mpn.tk=null,this.state.s_mpn.sbs=null,this.state.s_mpn.ft=null,this.state.s_mpn.bg=null,this.state.traceState(),t=this.evtTerminate_NetworkReachabilityRegion(),this.genUnsubscribeMpnSpecialItems(),this.evtResetMpnDevice()}return t&&this.evtTerminate_NetworkReachabilityRegion(),!1},evtMessage:function(t){if(!W.prototype.evtMessage.call(this,t))if(d.startsWith(t,"MPNREG")){var e=t.split(",");this.evtMPNREG(e[1],e[2])}else d.startsWith(t,"MPNZERO")?this.evtMPNZERO(t.split(",")[1]):d.startsWith(t,"MPNOK")?(e=t.split(","),this.evtMPNOK(Ct(e[1]),e[2])):d.startsWith(t,"MPNDEL")?this.evtMPNDEL(t.split(",")[1]):d.startsWith(t,"MPNCONF")&&this.evtMPNCONF(t.split(",")[1]);return!0},evtExtMpnRegister:function(){this.traceEvent("mpn.register"),400==this.state.s_mpn.m||401==this.state.s_mpn.m?(this.state.s_mpn.m=402,this.state.traceState(),this.evtMpnCheckNext()):451==this.state.s_mpn.tk&&(this.state.s_mpn.tk=452,this.state.traceState(),this.evtMpnCheckNext())},evtMpnCheckNext:function(){this.traceEvent("mpn.check.next"),402==this.state.s_mpn.m?h.empty(this.mpn_candidate_devices)?(this.state.s_mpn.m=401,this.state.traceState(),this.evtResetMpnDevice()):(this.doRegisterMpnDevice(),this.state.s_mpn.m=403,this.state.traceState(),this.genSendMpnRegister()):408==this.state.s_mpn.m?h.empty(this.mpn_candidate_devices)?(this.state.s_mpn.m=401,this.state.traceState(),this.evtResetMpnDevice()):(this.doRegisterMpnDevice(),this.state.s_mpn.m=406,this.state.traceState(),this.genSendMpnRegister()):452==this.state.s_mpn.tk&&(h.empty(this.mpn_candidate_devices)?(this.doRemoveMpnSpecialListeners(),this.state.s_mpn.m=401,this.state.s_mpn.st=null,this.state.s_mpn.tk=null,this.state.s_mpn.sbs=null,this.state.s_mpn.ft=null,this.state.s_mpn.bg=null,this.state.traceState(),this.genUnsubscribeMpnSpecialItems(),this.evtResetMpnDevice()):(this.doRegisterMpnDevice(),this.state.s_mpn.tk=453,this.state.traceState(),this.genSendMpnRegister()))},evtResetMpnDevice:function(){this.traceEvent("reset.mpn.device"),401==this.state.s_mpn.m&&(this.doResetMpnDevice(),this.notifyDeviceReset(),this.state.s_mpn.m=401,this.state.traceState())},evtMpnError:function(t,e){this.traceEvent("mpn.error"),405==this.state.s_mpn.m&&(this.doRemoveMpnSpecialListeners(),this.notifyDeviceError(t,e),this.state.s_mpn.m=401,this.state.s_mpn.st=null,this.state.s_mpn.sbs=null,this.state.s_mpn.ft=null,this.state.s_mpn.bg=null,this.state.s_mpn.tk=null,this.state.traceState(),this.genUnsubscribeMpnSpecialItems(),this.evtResetMpnDevice())},evtMPNREG:function(t,e){this.traceEvent("MPNREG"),ri.isDebugEnabled()&&ri.debug("MPNREG "+t+" "+e);var s=!0;if(this.state.inPushing())if(this.isFreshData()){this.doMPNREG();var i=this.state.inStreaming();s=this.evtMPNREG_MpnRegion(t,e),i&&this.evtRestartKeepalive()}else this.onStaleData(),i=this.state.inStreaming(),s=this.evtMPNREG_MpnRegion(t,e),i&&this.evtRestartKeepalive();s&&this.evtMPNREG_MpnRegion(t,e)},evtMPNREG_MpnRegion:function(t,e){return 403==this.state.s_mpn.m||404==this.state.s_mpn.m?(this.doMPNREG_Register(t,e),this.notifyDeviceRegistered(0),this.state.s_mpn.m=405,this.state.s_mpn.st=410,this.state.s_mpn.sbs=420,this.state.s_mpn.ft=430,this.state.s_mpn.bg=440,this.state.s_mpn.tk=450,this.state.traceState(),this.genDeviceActive(),this.genSubscribeSpecialItems(),this.evtMpnCheckPending(),this.evtSUBS_Init(),this.evtMpnCheckFilter(),this.evtMpnCheckReset()):406==this.state.s_mpn.m||407==this.state.s_mpn.m?t==this.mpn_deviceId&&e==this.mpn_adapterName?(this.doMPNREG_Register(t,e),this.notifyDeviceRegistered(0),this.state.s_mpn.m=405,this.state.s_mpn.st=410,this.state.s_mpn.sbs=420,this.state.s_mpn.ft=430,this.state.s_mpn.bg=440,this.state.s_mpn.tk=450,this.state.traceState(),this.genDeviceActive(),this.genSubscribeSpecialItems(),this.evtMpnCheckPending(),this.evtSUBS_Init(),this.evtMpnCheckFilter(),this.evtMpnCheckReset()):(this.doMPNREG_Error(),this.notifyDeviceError_DifferentDevice(),this.state.s_mpn.m=408,this.state.traceState(),this.evtMpnCheckNext()):453!=this.state.s_mpn.tk&&454!=this.state.s_mpn.tk||(t==this.mpn_deviceId&&e==this.mpn_adapterName?(this.doMPNREG_RefreshToken(t,e),this.state.s_mpn.tk=450,this.state.traceState(),this.evtMpnCheckPending()):(this.doMPNREG_Error(),this.notifyDeviceError_DifferentDevice(),this.state.s_mpn.tk=452,this.state.traceState(),this.evtMpnCheckNext())),!1},evtMPNZERO:function(t){this.traceEvent("MPNZERO"),ri.isDebugEnabled()&&ri.debug("MPNZERO "+t),this.state.inPushing()&&(this.isFreshData()?(this.doMPNZERO(t),this.state.inStreaming()&&this.evtRestartKeepalive()):(this.onStaleData(),this.state.inStreaming()&&this.evtRestartKeepalive()))},evtMPNOK:function(t,e){this.traceEvent("MPNOK"),ri.isDebugEnabled()&&ri.debug("MPNOK "+t+" "+e),this.state.inPushing()&&(this.isFreshData()?(this.doMPNOK(t,e),this.state.inStreaming()&&this.evtRestartKeepalive()):(this.onStaleData(),this.state.inStreaming()&&this.evtRestartKeepalive()))},evtMPNDEL:function(t){this.traceEvent("MPNDEL"),ri.isDebugEnabled()&&ri.debug("MPNDEL "+t),this.state.inPushing()&&(this.isFreshData()?(this.doMPNDEL(t),this.state.inStreaming()&&this.evtRestartKeepalive()):(this.onStaleData(),this.state.inStreaming()&&this.evtRestartKeepalive()))},evtMPNCONF:function(t){this.traceEvent("MPNCONF"),ri.isDebugEnabled()&&ri.debug("MPNCONF "+t),this.state.inPushing()&&(this.isFreshData()?(this.doMPNCONF(t),this.state.inStreaming()&&this.evtRestartKeepalive()):(this.onStaleData(),this.state.inStreaming()&&this.evtRestartKeepalive()))},evtDEV_Update:function(t,e){this.traceEvent("DEV.update"),410==this.state.s_mpn.st?"ACTIVE"==t?(Pe.sure(this.mpn_device).isRegistered()||this.notifyDeviceRegistered(e),this.state.s_mpn.st=410,this.state.traceState()):"SUSPENDED"==t&&(Pe.sure(this.mpn_device).isSuspended()||this.notifyDeviceSuspended(e),this.state.s_mpn.st=411,this.state.traceState()):411==this.state.s_mpn.st&&"ACTIVE"==t&&(this.notifyDeviceResume(e),this.state.s_mpn.st=410,this.state.traceState())},evtMpnCheckPending:function(){this.traceEvent("mpn.check.pending"),450==this.state.s_mpn.tk&&(h.empty(this.mpn_candidate_devices)?(this.state.s_mpn.tk=451,this.state.traceState()):(this.state.s_mpn.tk=452,this.state.traceState(),this.evtMpnCheckNext()))},evtSUBS_Init:function(){this.traceEvent("SUBS.init"),420==this.state.s_mpn.sbs&&(this.doClearMpnSnapshot(),this.state.s_mpn.sbs=421,this.state.traceState())},evtSUBS_Update:function(t,e){this.traceEvent("SUBS.update");var s=e.getValue("command"),i=e.getValue("status");null!=this.state.s_mpn.sbs&&this.exists(t)?(this.state.traceState(),this.genSUBS_update(t,e)):421==this.state.s_mpn.sbs&&"DELETE"!=s&&!this.exists(t)||423==this.state.s_mpn.sbs&&"DELETE"!=s&&!this.exists(t)?null==i?(this.doAddToMpnSnapshot(t),this.state.s_mpn.sbs=423,this.state.traceState()):(this.doRemoveFromMpnSnapshot(t),this.doAddMpnSubscription(t),this.state.s_mpn.sbs=423,this.state.traceState(),this.genSUBS_update(t,e)):424!=this.state.s_mpn.sbs||this.exists(t)||("DELETE"==s?this.mpn_snapshotSet.contains(t)&&(1==this.mpn_snapshotSet.count()?(this.doRemoveFromMpnSnapshot(t),this.state.s_mpn.sbs=424,this.state.traceState(),this.notifyOnSubscriptionsUpdated()):(this.doRemoveFromMpnSnapshot(t),this.state.s_mpn.sbs=424,this.state.traceState())):null!=i&&(this.mpn_snapshotSet.contains(t)?1==this.mpn_snapshotSet.count()?(this.doRemoveFromMpnSnapshot(t),this.doAddMpnSubscription(t),this.state.s_mpn.sbs=424,this.state.traceState(),this.genSUBS_update(t,e),this.notifyOnSubscriptionsUpdated()):(this.doRemoveFromMpnSnapshot(t),this.doAddMpnSubscription(t),this.state.s_mpn.sbs=424,this.state.traceState(),this.genSUBS_update(t,e)):0==this.mpn_snapshotSet.count()?(this.doAddMpnSubscription(t),this.state.s_mpn.sbs=424,this.state.traceState(),this.genSUBS_update(t,e),this.notifyOnSubscriptionsUpdated()):(this.doAddMpnSubscription(t),this.state.s_mpn.sbs=424,this.state.traceState(),this.genSUBS_update(t,e))))},evtSUBS_EOS:function(){this.traceEvent("SUBS.EOS"),421==this.state.s_mpn.sbs?(this.state.s_mpn.sbs=424,this.state.traceState(),this.genSUBS_EOS(),this.notifyOnSubscriptionsUpdated()):423==this.state.s_mpn.sbs&&(this.mpn_snapshotSet.count()>0?(this.state.s_mpn.sbs=424,this.state.traceState(),this.genSUBS_EOS()):(this.state.s_mpn.sbs=424,this.state.traceState(),this.genSUBS_EOS(),this.notifyOnSubscriptionsUpdated()))},evtExtMpnUnsubscribeFilter:function(){this.traceEvent("mpn.unsubscribe.filter"),431==this.state.s_mpn.ft&&(this.state.s_mpn.ft=430,this.state.traceState(),this.evtMpnCheckFilter())},evtMpnCheckFilter:function(){this.traceEvent("mpn.check.filter"),430==this.state.s_mpn.ft&&(h.empty(this.mpn_filter_pendings)?(this.state.s_mpn.ft=431,this.state.traceState()):(this.state.s_mpn.ft=432,this.state.traceState(),this.genSendMpnUnsubscribeFilter()))},evtExtMpnResetBadge:function(){this.traceEvent("mpn.reset.badge"),441==this.state.s_mpn.bg&&(this.state.s_mpn.bg=440,this.state.traceState(),this.evtMpnCheckReset())},evtMpnCheckReset:function(){this.traceEvent("mpn.check.reset"),440==this.state.s_mpn.bg&&(this.mpn_badge_reset_requested?(this.state.s_mpn.bg=442,this.state.traceState(),this.genSendMpnResetBadge()):(this.state.s_mpn.bg=441,this.state.traceState()))},doREQOK:function(t){W.prototype.doREQOK.call(this,t);for(var e=new Ne(this.mpnSubscriptionManagers);e.hasNext();)e.next().evtREQOK(t);this.mpnSubscriptionManagers.compact()},doREQERR:function(t,e,s){W.prototype.doREQERR.call(this,t,e,s);for(var i=new Ne(this.mpnSubscriptionManagers);i.hasNext();)i.next().evtREQERR(t,e,s);this.mpnSubscriptionManagers.compact()},genAbortSubscriptions:function(){W.prototype.genAbortSubscriptions.call(this);for(var t=new Ne(this.mpnSubscriptionManagers);t.hasNext();)t.next().evtAbort();this.mpnSubscriptionManagers.compact()},getPendingControls:function(){var t=W.prototype.getPendingControls.call(this);this.mpnRegisterRequest.isPending()&&t.push(this.mpnRegisterRequest);for(var e=new Ne(this.mpnSubscriptionManagers.filter((function(t){return t.isPending()})));e.hasNext();)t.push(e.next());return this.mpnFilterUnsubscriptionRequest.isPending()&&t.push(this.mpnFilterUnsubscriptionRequest),this.mpnBadgeResetRequest.isPending()&&t.push(this.mpnBadgeResetRequest),t},doRegisterMpnDevice:function(){if(h.empty(this.mpn_candidate_devices))throw new Me("Assertion failure: !mpn_candidate_devices.empty()");this.mpn_device=this.mpn_candidate_devices.shift()},doRemoveMpnSpecialListeners:function(){this.mpn_deviceSubscription.removeListener(this.mpn_deviceListener),this.mpn_deviceListener.disable(),this.mpn_deviceListener=null,this.mpn_itemSubscription.removeListener(this.mpn_itemListener),this.mpn_itemListener.disable(),this.mpn_itemListener=null},genSendMpnRegister:function(){this.evtSendControl(this.mpnRegisterRequest)},genUnsubscribeMpnSpecialItems:function(){this.client.unsubscribe(Pe.sure(this.mpn_deviceSubscription)),this.client.unsubscribe(Pe.sure(this.mpn_itemSubscription))},doResetMpnDevice:function(){this.mpn_deviceId=null,this.mpn_deviceToken=null,this.mpn_adapterName=null,this.mpn_lastRegisterReqId=null,this.mpn_deviceSubscription=null,this.mpn_itemSubscription=null,this.mpn_deviceListener=null,this.mpn_itemListener=null,this.mpn_snapshotSet.removeAll(),be(this.mpn_filter_pendings),this.mpn_filter_lastDeactivateReqId=null,this.mpn_badge_reset_requested=!1,this.mpn_badge_lastResetReqId=null},notifyDeviceReset:function(){Pe.sure(this.mpn_device).onReset()},notifyDeviceError:function(t,e){Pe.sure(this.mpn_device).onError(t,e)},doMPNREG:function(){this.onFreshData()},doMPNREG_Register:function(t,e){if(null==this.mpn_device)throw new Me("Assertion failure: mpn_device != null");this.mpn_deviceId=t,this.mpn_deviceToken=this.mpn_device.getDeviceToken(),this.mpn_adapterName=e,this.mpn_device.setDeviceId(t,e),this.createSpecialItems(t,e)},doMPNZERO:function(t){this.onFreshData(),null!=this.mpn_deviceId&&t==this.mpn_deviceId&&Pe.sure(this.mpn_device).fireOnBadgeReset()},createSpecialItems:function(t,e){this.mpn_deviceListener=new mt(this);var s=new D("MERGE",["DEV-"+t].slice(),["status","status_timestamp"].slice());s.setInternal(),s.setDataAdapter(e),s.setRequestedMaxFrequency("unfiltered"),s.addListener(this.mpn_deviceListener),this.mpn_deviceSubscription=s,this.mpn_itemListener=new gt(this);var i=new D("COMMAND",["SUBS-"+t].slice(),["key","command"].slice());i.setInternal(),i.setDataAdapter(e),i.setRequestedMaxFrequency("unfiltered"),i.setCommandSecondLevelFields(["status","status_timestamp","notification_format","trigger","group","schema","adapter","mode","requested_buffer_size","requested_max_frequency"].slice()),i.setCommandSecondLevelDataAdapter(e),i.addListener(this.mpn_itemListener),this.mpn_itemSubscription=i},genDeviceActive:function(){for(var t=new Ne(this.mpnSubscriptionManagers);t.hasNext();)t.next().evtDeviceActive();this.mpnSubscriptionManagers.compact()},genSubscribeSpecialItems:function(){if(null==this.mpn_deviceSubscription)throw new Me("Assertion failure: mpn_deviceSubscription != null");if(null==this.mpn_itemSubscription)throw new Me("Assertion failure: mpn_itemSubscription != null");this.subscribeExt(this.mpn_deviceSubscription,!0),this.subscribeExt(this.mpn_itemSubscription,!0)},doMPNREG_Error:function(){},notifyDeviceError_DifferentDevice:function(){Pe.sure(this.mpn_device).onError(62,"DeviceId or Adapter Name has unexpectedly been changed")},doMPNREG_RefreshToken:function(t,e){if(null==this.mpn_device)throw new Me("Assertion failure: mpn_device != null");this.mpn_deviceToken=this.mpn_device.getDeviceToken(),this.mpn_device.setDeviceId(t,e)},notifyDeviceRegistered:function(t){Pe.sure(this.mpn_device).onRegistered(t)},notifyDeviceSuspended:function(t){Pe.sure(this.mpn_device).onSuspend(t)},notifyDeviceResume:function(t){Pe.sure(this.mpn_device).onResume(t)},doClearMpnSnapshot:function(){this.mpn_snapshotSet.removeAll()},exists:function(t){return h.exists(this.mpnSubscriptionManagers,(function(e){return e.fetch_mpnSubId()==t}))},genSUBS_update:function(t,e){for(var s=new Ne(this.mpnSubscriptionManagers);s.hasNext();){var i=s.next();t==i.fetch_mpnSubId()&&i.evtMpnUpdate(e)}this.mpnSubscriptionManagers.compact()},doAddToMpnSnapshot:function(t){this.mpn_snapshotSet.insert(t)},doRemoveFromMpnSnapshot:function(t){this.mpn_snapshotSet.remove(t)},doAddMpnSubscription:function(t){new Rt(Tt.Ctor2(t,this)).start()},notifyOnSubscriptionsUpdated:function(){Pe.sure(this.mpn_device).fireOnSubscriptionsUpdated()},genSUBS_EOS:function(){for(var t=new Ne(this.mpnSubscriptionManagers);t.hasNext();)t.next().evtMpnEOS();this.mpnSubscriptionManagers.compact()},genSendMpnUnsubscribeFilter:function(){this.evtSendControl(this.mpnFilterUnsubscriptionRequest)},genSendMpnResetBadge:function(){this.evtSendControl(this.mpnBadgeResetRequest)},doREQMpnUnsubscribeFilter:function(){this.mpn_filter_pendings.shift()},doREQOKMpnResetBadge:function(){this.mpn_badge_reset_requested=!1},doREQERRMpnResetBadge:function(){this.mpn_badge_reset_requested=!1},notifyOnBadgeResetFailed:function(t,e){Pe.sure(this.mpn_device).fireOnBadgeResetFailed(t,e)},doMPNOK:function(t,e){this.onFreshData();for(var s=new Ne(this.mpnSubscriptionManagers);s.hasNext();){var i=s.next();i.m_subId==t&&i.evtMPNOK(e)}this.mpnSubscriptionManagers.compact()},doMPNDEL:function(t){this.onFreshData();for(var e=new Ne(this.mpnSubscriptionManagers);e.hasNext();){var s=e.next();s.fetch_mpnSubId()==t&&s.evtMPNDEL()}this.mpnSubscriptionManagers.compact()},doMPNCONF:function(t){this.onFreshData()},encodeMpnRegister:function(){if(null==this.mpn_device)throw new Me("Assertion failure: mpn_device != null");var t=new Ke,e=this.mpn_device.getDeviceToken(),s=this.mpn_device.getPreviousDeviceToken();return this.mpn_lastRegisterReqId=this.generateFreshReqId(),t.LS_reqId(this.mpn_lastRegisterReqId),t.LS_op("register"),t.PN_type(this.mpn_device.getPlatform()),t.PN_appId(this.mpn_device.getApplicationId()),null==s||s==e?t.PN_deviceToken(e):(t.PN_deviceToken(s),t.PN_newDeviceToken(e)),ri.isInfoEnabled()&&ri.info("Sending MPNDevice register: "+l.string(t)),t.getEncodedString()},encodeMpnRefreshToken:function(){if(null==this.mpn_device)throw new Me("Assertion failure: mpn_device != null");var t=new Ke;return this.mpn_lastRegisterReqId=this.generateFreshReqId(),t.LS_reqId(this.mpn_lastRegisterReqId),t.LS_op("register"),t.PN_type(this.mpn_device.getPlatform()),t.PN_appId(this.mpn_device.getApplicationId()),t.PN_deviceToken(Pe.sure(this.mpn_deviceToken)),t.PN_newDeviceToken(this.mpn_device.getDeviceToken()),t.LS_cause("refresh.token"),ri.isInfoEnabled()&&ri.info("Sending MPNDevice refresh: "+l.string(t)),t.getEncodedString()},encodeMpnRestore:function(){if(null==this.mpn_device)throw new Me("Assertion failure: mpn_device != null");var t=new Ke;return this.mpn_lastRegisterReqId=this.generateFreshReqId(),t.LS_reqId(this.mpn_lastRegisterReqId),t.LS_op("register"),t.PN_type(this.mpn_device.getPlatform()),t.PN_appId(this.mpn_device.getApplicationId()),t.PN_deviceToken(Pe.sure(this.mpn_deviceToken)),t.PN_newDeviceToken(this.mpn_device.getDeviceToken()),t.LS_cause("restore.token"),ri.isInfoEnabled()&&ri.info("Sending MPNDevice restore: "+l.string(t)),t.getEncodedString()},encodeDeactivateFilter:function(){var t=new Ke;switch(this.mpn_filter_lastDeactivateReqId=this.generateFreshReqId(),t.LS_reqId(this.mpn_filter_lastDeactivateReqId),t.LS_op("deactivate"),t.PN_deviceId(Pe.sure(this.mpn_deviceId)),this.mpn_filter_pendings[0]._hx_index){case 1:t.PN_subscriptionStatus("ACTIVE");break;case 2:t.PN_subscriptionStatus("TRIGGERED")}return ri.isInfoEnabled()&&ri.info("Sending multiple MPNSubscription deactivate: "+l.string(t)),t.getEncodedString()},encodeBadgeReset:function(){var t=new Ke;return this.mpn_badge_lastResetReqId=this.generateFreshReqId(),t.LS_reqId(this.mpn_badge_lastResetReqId),t.LS_op("reset_badge"),t.PN_deviceId(Pe.sure(this.mpn_deviceId)),ri.isInfoEnabled()&&ri.info("Sending MPNDevice badge reset: "+l.string(t)),t.getEncodedString()},relate:function(t){if(h.has(this.mpnSubscriptionManagers,t))throw new Me("Assertion failure: !mpnSubscriptionManagers.contains(subManager)");this.mpnSubscriptionManagers.values.push(new Le(t))},unrelate:function(t){this.mpnSubscriptionManagers.remove(t)},fetch_mpn_deviceId:function(){return this.mpn_deviceId},fetch_mpn_device:function(){return this.mpn_device},registerForMpn:function(t){if(null==t)throw new v("Device cannot be null");this.mpn_candidate_devices.push(t),hi.isInfoEnabled()&&hi.info("MPN registration requested: "+l.string(t)),this.evtExtMpnRegister()},subscribeMpn:function(t,e){if(null==this.mpn_device)throw new Me(mi);if(t.isActive())throw new v(fi);if(null==t.getNotificationFormat())throw new v(gi);if(null==t.getItems()&&null==t.getItemGroup())throw new v("Specify property 'items' or 'itemGroup'");if(null==t.getFields()&&null==t.getFieldSchema())throw new v("Specify property 'fields' or 'fieldSchema'");var s=new Rt(Tt.Ctor1(t,e,this));hi.isInfoEnabled()&&hi.info("MPN Subscription requested: subId: "+s.m_subId+" "+l.string(t)+" coalescing: "+(null==e?"null":""+e)),s.evtExtMpnSubscribe()},unsubscribeMpn:function(t){if(null==this.mpn_device)throw new Me(mi);var e=t.fetch_subManager();if(null!=e){if(!h.has(this.mpnSubscriptionManagers,e))throw new Me("The MPNSubscription is not subscribed to this Client");hi.isInfoEnabled()&&hi.info("MPN Unsubscription requested: pnSubId: "+t.getSubscriptionId()+" "+l.string(t)),e.evtExtMpnUnsubscribe()}},unsubscribeMpnSubscriptions:function(t){if(null==this.mpn_device)throw new Me(mi);var e=vt(t);this.mpn_filter_pendings.push(e),hi.isInfoEnabled()&&hi.info("Multiple MPN Unsubscriptions requested: "+l.string(e)),this.evtExtMpnUnsubscribeFilter()},getMpnSubscriptions:function(t){if(null==this.mpn_device)throw new Me(mi);var e;switch(vt(t)._hx_index){case 0:e=this.mpnSubscriptionManagers.map((function(t){return t.m_subscription})).filter((function(t){return t.fetch_status()==pe.Subscribed||t.fetch_status()==pe.Triggered}));break;case 1:e=this.mpnSubscriptionManagers.map((function(t){return t.m_subscription})).filter((function(t){return t.fetch_status()==pe.Subscribed}));break;case 2:e=this.mpnSubscriptionManagers.map((function(t){return t.m_subscription})).filter((function(t){return t.fetch_status()==pe.Triggered}))}for(var s=Object.create(null),i=new Ne(e);i.hasNext();){var n=i.next(),r=n.getSubscriptionId();if(null!=r){var a=s[r];null==a?s[r]=[n]:a.push(n)}}for(var o=[],h=Object.keys(s),u=h.length,l=0;l<u;){for(var c=s[h[l++]],d=!1,_=0;_<c.length;)if(i=c[_],++_,!i.fetch_madeByServer()){o.push(i),d=!0;break}d||null==c[0]||o.push(c[0])}return o},findMpnSubscription:function(t){if(null==t)throw new v("Subscription id must be not null");if(null==this.mpn_device)throw new Me(mi);for(var e=new Ne(this.mpnSubscriptionManagers);e.hasNext();){var s=e.next();if(s.m_subscription.getSubscriptionId()==t)return s.m_subscription}return null},__class__:_t});var pt=i["com.lightstreamer.client.internal._MpnClientMachine.MPNSubscriptionStatus"]={__ename__:!0,__constructs__:null,ALL:{_hx_name:"ALL",_hx_index:0,__enum__:"com.lightstreamer.client.internal._MpnClientMachine.MPNSubscriptionStatus",toString:s},SUBSCRIBED:{_hx_name:"SUBSCRIBED",_hx_index:1,__enum__:"com.lightstreamer.client.internal._MpnClientMachine.MPNSubscriptionStatus",toString:s},TRIGGERED:{_hx_name:"TRIGGERED",_hx_index:2,__enum__:"com.lightstreamer.client.internal._MpnClientMachine.MPNSubscriptionStatus",toString:s}};pt.__constructs__=[pt.ALL,pt.SUBSCRIBED,pt.TRIGGERED];var ft=function(t){this.m_disabled=!1,this.client=t};ft.__name__=!0,ft.__interfaces__=[C],ft.prototype={disable:function(){var t=this;this.client.lock.synchronized((function(){return t.m_disabled=!0}))},synchronized:function(t){var e=this;this.client.lock.synchronized((function(){e.m_disabled||t()}))},onClearSnapshot:function(t,e){},onCommandSecondLevelItemLostUpdates:function(t,e){},onCommandSecondLevelSubscriptionError:function(t,e,s){},onEndOfSnapshot:function(t,e){},onItemLostUpdates:function(t,e,s){},onItemUpdate:function(t){},onListenEnd:function(t){},onListenStart:function(t){},onSubscription:function(){},onSubscriptionError:function(t,e){},onUnsubscription:function(){},onRealMaxFrequency:function(t){},__class__:ft};var mt=function(t){ft.call(this,t)};mt.__name__=!0,mt.__super__=ft,mt.prototype=n(ft.prototype,{onItemUpdate:function(t){var e=this;this.synchronized((function(){var s=t.getValue("status"),i=t.getValue("status_timestamp");null!=s&&e.client.evtDEV_Update(s,Lt(null!=i?i:"0"))}))},onSubscriptionError:function(t,e){var s=this;this.synchronized((function(){s.client.evtMpnError(62,"MPN device activation can't be completed (62/1)")}))},onUnsubscription:function(){var t=this;this.synchronized((function(){t.client.evtMpnError(62,"MPN device activation can't be completed (62/2)")}))},__class__:mt});var gt=function(t){ft.call(this,t)};function vt(t){if(null==t)return pt.ALL;switch(t){case"ALL":return pt.ALL;case"SUBSCRIBED":return pt.SUBSCRIBED;case"TRIGGERED":return pt.TRIGGERED;default:throw new v("The given value is not valid for this setting. Use null, ALL, TRIGGERED or SUBSCRIBED instead")}}gt.__name__=!0,gt.__super__=ft,gt.prototype=n(ft.prototype,{onItemUpdate:function(t){var e=this;this.synchronized((function(){var s=t.getValue("key");null!=s&&e.client.evtSUBS_Update(s.substring(4),t)}))},onEndOfSnapshot:function(t,e){var s=this;this.synchronized((function(){s.client.evtSUBS_EOS()}))},onSubscriptionError:function(t,e){var s=this;this.synchronized((function(){s.client.evtMpnError(62,"MPN device activation can't be completed (62/3)")}))},onUnsubscription:function(){var t=this;this.synchronized((function(){t.client.evtMpnError(62,"MPN device activation can't be completed (62/4)")}))},onCommandSecondLevelSubscriptionError:function(t,e,s){this.synchronized((function(){_i.isWarnEnabled()&&_i.warn("MPN device can't complete the subscription of "+s)}))},__class__:gt});var St=function(t){this.client=t};St.__name__=!0,St.__interfaces__=[Q],St.prototype={isPending:function(){return 403==this.client.state.s_mpn.m||406==this.client.state.s_mpn.m||453==this.client.state.s_mpn.tk},encode:function(t){if(403==this.client.state.s_mpn.m)return this.client.encodeMpnRegister();if(406==this.client.state.s_mpn.m)return this.client.encodeMpnRestore();if(453==this.client.state.s_mpn.tk)return this.client.encodeMpnRefreshToken();throw new Me("Can't encode register request")},encodeWS:function(){return"control\r\n"+this.encode(!0)},__class__:St};var yt=function(t){this.client=t};yt.__name__=!0,yt.__interfaces__=[Q],yt.prototype={isPending:function(){return 432==this.client.state.s_mpn.ft},encode:function(t){if(this.isPending())return this.client.encodeDeactivateFilter();throw new Me("Can't encode unsubscription request")},encodeWS:function(){return"control\r\n"+this.encode(!0)},__class__:yt};var bt=function(t){this.client=t};bt.__name__=!0,bt.__interfaces__=[Q],bt.prototype={isPending:function(){return 442==this.client.state.s_mpn.bg},encode:function(t){if(this.isPending())return this.client.encodeBadgeReset();throw new Me("Can't encode badge reset request")},encodeWS:function(){return"control\r\n"+this.encode(!0)},__class__:bt};var Et=function(){this.m=400};Et.__name__=!0,Et.prototype={toString:function(){var t="<mpn_m="+this.m;return null!=this.st&&(t+=" mpn_st="+this.st),null!=this.tk&&(t+=" mpn_tk="+this.tk),null!=this.sbs&&(t+=" mpn_sbs="+this.sbs),null!=this.ft&&(t+=" mpn_ft="+this.ft),null!=this.bg&&(t+=" mpn_bg="+this.bg),t+=">"},__class__:Et};var wt=function(t,e){this.s_tu=30,this.s_fu=20,this.s_uu=10,this.s_m=t,this.manager=e};wt.__name__=!0,wt.prototype={toString:function(){var t="<m="+this.s_m;return t+=" uu="+this.s_uu,t+=" fu="+this.s_fu,t+=" tu="+this.s_tu,null!=this.s_st&&(t+=" st="+this.s_st),null!=this.s_ab&&(t+=" ab="+this.s_ab),null!=this.s_ct&&(t+=" ct="+this.s_ct),t+=">"},traceState:function(){ai.isTraceEnabled()&&ai.trace("mpn#sub#goto("+this.manager.m_subId+":"+this.manager.fetch_mpnSubId()+") "+this.toString())},__class__:wt};var Tt=i["com.lightstreamer.client.internal._MpnSubscriptionManager.CtorArgs"]={__ename__:!0,__constructs__:null,Ctor1:(e=function(t,e,i){return{_hx_index:0,sub:t,coalescing:e,client:i,__enum__:"com.lightstreamer.client.internal._MpnSubscriptionManager.CtorArgs",toString:s}},e._hx_name="Ctor1",e.__params__=["sub","coalescing","client"],e),Ctor2:(e=function(t,e){return{_hx_index:1,mpnSubId:t,client:e,__enum__:"com.lightstreamer.client.internal._MpnSubscriptionManager.CtorArgs",toString:s}},e._hx_name="Ctor2",e.__params__=["mpnSubId","client"],e)};Tt.__constructs__=[Tt.Ctor1,Tt.Ctor2];var Rt=function(t){var e=null,s=null,i=null,n=null;switch(t._hx_index){case 0:e=t.sub,s=t.coalescing,i=t.client;break;case 1:n=t.mpnSubId,i=t.client}null==n?(this.lock=i.lock,this.m_subId=i.generateFreshSubId(),this.m_coalescing=s,this.m_initFormat=e.getNotificationFormat(),this.m_initTrigger=e.getTriggerExpression(),this.m_subscription=e,this.m_client=i,this.state=new wt(40,this),this.m_subscription.relate(this),this.m_client.relate(this)):(this.lock=i.lock,this.m_subId=null,this.m_coalescing=!1,this.m_initFormat=null,this.m_initTrigger=null,this.m_subscription=new me("MERGE",null,null),this.m_subscription.reInit(n),this.m_client=i,this.state=new wt(45,this),this.m_subscription.relate(this),this.m_client.relate(this))};Rt.__name__=!0,Rt.__interfaces__=[Q],Rt.prototype={finalize:function(){this.m_subscription.reset(),this.m_client.unrelate(this),this.m_subscription.unrelate(this)},fetch_mpnSubId:function(){return this.m_subscription.fetch_mpnSubId()},start:function(){},evtExtMpnUnsubscribe:function(){this.traceEvent("unsubscribe");var t=!0;41==this.state.s_m?(this.notifyStatus(pe.Unknown),this.notifyOnSubscriptionDiscarded(),this.finalize(),this.state.s_m=50,this.state.traceState(),t=this.evtExtMpnUnsubscribe_UnsubRegion()):71==this.state.s_ct&&(this.state.s_ct=70,this.state.traceState(),t=this.evtExtMpnUnsubscribe_UnsubRegion(),this.evtCheck()),t&&this.evtExtMpnUnsubscribe_UnsubRegion()},evtExtMpnUnsubscribe_UnsubRegion:function(){return this.traceEvent("unsubscribe"),(10==this.state.s_uu||12==this.state.s_uu)&&(this.state.s_uu=11,this.state.traceState()),!1},evtAbort:function(){this.traceEvent("abort"),41==this.state.s_m?(this.notifyStatus(pe.Unknown),this.notifyOnSubscriptionDiscarded(),this.finalize(),this.state.s_m=50,this.state.traceState()):42==this.state.s_m||43==this.state.s_m?(this.notifyStatus(pe.Unknown),this.notifyOnSubscriptionAbort(),this.finalize(),this.state.s_m=50,this.state.traceState()):44==this.state.s_m&&(this.state.s_m=44,this.state.traceState(),this.evtAbort_AbortRegion())},evtAbort_AbortRegion:function(){this.traceEvent("abort");var t=!0;80==this.state.s_ab&&(this.state.s_ab=81,this.state.traceState(),t=this.evtAbort_ControlRegion()),t&&this.evtAbort_ControlRegion()},evtAbort_ControlRegion:function(){return this.traceEvent("abort"),70!=this.state.s_ct&&71!=this.state.s_ct&&72!=this.state.s_ct&&73!=this.state.s_ct&&74!=this.state.s_ct||(this.state.s_ct=76,this.state.traceState(),this.evtAbortFormat(),this.evtAbortTrigger(),this.evtAbortUnsubscribe()),!1},evtRestoreSession:function(){this.traceEvent("restore.session"),76==this.state.s_ct&&(this.state.s_ct=70,this.state.traceState(),this.evtCheck())},evtREQOK:function(t){this.traceEvent("REQOK");var e=!0;22==this.state.s_fu&&t==this.m_lastConfigureReqId?(this.state.s_fu=20,this.state.traceState(),e=this.evtREQOK_TriggerRegion(t)):23==this.state.s_fu&&t==this.m_lastConfigureReqId&&(this.state.s_fu=21,this.state.traceState(),e=this.evtREQOK_TriggerRegion(t)),e&&this.evtREQOK_TriggerRegion(t)},evtREQOK_TriggerRegion:function(t){this.traceEvent("REQOK");var e=!0;return 32==this.state.s_tu&&t==this.m_lastConfigureReqId?(this.state.s_tu=30,this.state.traceState(),e=this.evtREQOK_MainRegion(t)):33==this.state.s_tu&&t==this.m_lastConfigureReqId&&(this.state.s_tu=31,this.state.traceState(),e=this.evtREQOK_MainRegion(t)),e&&this.evtREQOK_MainRegion(t),!1},evtREQOK_MainRegion:function(t){return this.traceEvent("REQOK"),42==this.state.s_m&&t==this.m_lastActivateReqId?(this.state.s_m=43,this.state.traceState()):44==this.state.s_m&&(this.state.s_m=44,this.state.traceState(),this.evtREQOK_ControlRegion(t)),!1},evtREQOK_ControlRegion:function(t){this.traceEvent("REQOK"),72==this.state.s_ct&&t==this.m_lastDeactivateReqId?(this.notifyStatus(pe.Unknown),this.notifyOnUnsubscription(),this.notifyOnSubscriptionsUpdated(),this.finalize(),this.state.s_m=52,this.state.s_st=null,this.state.s_ct=null,this.state.s_ab=null,this.state.traceState()):73!=this.state.s_ct&&74!=this.state.s_ct||t!=this.m_lastConfigureReqId||(this.state.s_ct=70,this.state.traceState(),this.evtCheck())},evtREQERR:function(t,e,s){this.traceEvent("REQERR");var i=!0;11==this.state.s_uu&&t==this.m_lastDeactivateReqId&&(this.notifyOnUnsubscriptionError(e,s),this.state.s_uu=12,this.state.traceState(),i=this.evtREQERR_FormatRegion(t,e,s)),i&&this.evtREQERR_FormatRegion(t,e,s)},evtREQERR_FormatRegion:function(t,e,s){this.traceEvent("REQERR");var i=!0;return 22==this.state.s_fu&&t==this.m_lastConfigureReqId?(this.notifyOnModificationError_Format(e,s),this.state.s_fu=20,this.state.traceState(),i=this.evtREQERR_TriggerRegion(t,e,s)):23==this.state.s_fu&&t==this.m_lastConfigureReqId&&(this.state.s_fu=21,this.state.traceState(),i=this.evtREQERR_TriggerRegion(t,e,s)),i&&this.evtREQERR_TriggerRegion(t,e,s),!1},evtREQERR_TriggerRegion:function(t,e,s){this.traceEvent("REQERR");var i=!0;return 32==this.state.s_tu&&t==this.m_lastConfigureReqId?(this.notifyOnModificationError_Trigger(e,s),this.state.s_tu=30,this.state.traceState(),i=this.evtREQERR_MainRegion(t,e,s)):33==this.state.s_tu&&t==this.m_lastConfigureReqId&&(this.state.s_tu=31,this.state.traceState(),i=this.evtREQERR_MainRegion(t,e,s)),i&&this.evtREQERR_MainRegion(t,e,s),!1},evtREQERR_MainRegion:function(t,e,s){return this.traceEvent("REQERR"),42==this.state.s_m&&t==this.m_lastActivateReqId?(this.notifyStatus(pe.Unknown),this.notifyOnSubscriptionError(e,s),this.finalize(),this.state.s_m=50,this.state.traceState()):44==this.state.s_m&&(this.state.s_m=44,this.state.traceState(),this.evtREQERR_ControlRegion(t,e,s)),!1},evtREQERR_ControlRegion:function(t,e,s){this.traceEvent("REQERR"),72==this.state.s_ct&&t==this.m_lastDeactivateReqId?(this.state.s_ct=70,this.state.traceState(),this.evtCheck()):73!=this.state.s_ct&&74!=this.state.s_ct||t!=this.m_lastConfigureReqId||(this.state.s_ct=70,this.state.traceState(),this.evtCheck())},evtAbortUnsubscribe:function(){this.traceEvent("abort.unsubscribe"),11==this.state.s_uu&&(this.notifyOnUnsubscriptionAbort(),this.state.s_uu=12,this.state.traceState())},evtExtMpnSetFormat:function(){this.traceEvent("setFormat");var t=!0;20==this.state.s_fu?(this.state.s_fu=21,this.state.traceState(),t=this.evtExtMpnSetFormat_ControlRegion()):22==this.state.s_fu&&(this.state.s_fu=23,this.state.traceState(),t=this.evtExtMpnSetFormat_ControlRegion()),t&&this.evtExtMpnSetFormat_ControlRegion()},evtExtMpnSetFormat_ControlRegion:function(){return this.traceEvent("setFormat"),71==this.state.s_ct&&(this.state.s_ct=70,this.state.traceState(),this.evtCheck()),!1},evtExtMpnSetTrigger:function(){this.traceEvent("setTrigger");var t=!0;30==this.state.s_tu?(this.state.s_tu=31,this.state.traceState(),t=this.evtExtMpnSetTrigger_ControlRegion()):32==this.state.s_tu&&(this.state.s_tu=33,this.state.traceState(),t=this.evtExtMpnSetTrigger_ControlRegion()),t&&this.evtExtMpnSetTrigger_ControlRegion()},evtExtMpnSetTrigger_ControlRegion:function(){return this.traceEvent("setTrigger"),71==this.state.s_ct&&(this.state.s_ct=70,this.state.traceState(),this.evtCheck()),!1},evtChangeFormat:function(){this.traceEvent("change.format"),21==this.state.s_fu&&(this.doSetCurrentFormat(),this.state.s_fu=22,this.state.traceState())},evtChangeTrigger:function(){this.traceEvent("change.trigger"),31==this.state.s_tu&&(this.doSetCurrentTrigger(),this.state.s_tu=32,this.state.traceState())},evtAbortFormat:function(){switch(this.traceEvent("abort.format"),this.state.s_fu){case 21:case 22:case 23:this.notifyOnModificationAbort_Format(),this.state.s_fu=20,this.state.traceState()}},evtAbortTrigger:function(){switch(this.traceEvent("abort.trigger"),this.state.s_tu){case 31:case 32:case 33:this.notifyOnModificationAbort_Trigger(),this.state.s_tu=30,this.state.traceState()}},evtCheck:function(){this.traceEvent("check"),70==this.state.s_ct&&(11==this.state.s_uu?(this.state.s_ct=72,this.state.traceState(),this.genSendUnsubscribe()):21==this.state.s_fu?(this.state.s_ct=74,this.state.traceState(),this.evtChangeFormat(),this.genSendConfigure()):31==this.state.s_tu?(this.state.s_ct=73,this.state.traceState(),this.evtChangeTrigger(),this.genSendConfigure()):(this.state.s_ct=71,this.state.traceState()))},evtExtMpnSubscribe:function(){this.traceEvent("subscribe"),40==this.state.s_m&&(405==this.m_client.state.s_mpn.m?(this.notifyStatus(pe.Active),this.state.s_m=42,this.state.traceState(),this.genSendSubscribe()):(this.notifyStatus(pe.Active),this.state.s_m=41,this.state.traceState()))},evtDeviceActive:function(){this.traceEvent("device.active"),41==this.state.s_m&&(this.state.s_m=42,this.state.traceState(),this.genSendSubscribe())},evtMPNOK:function(t){this.traceEvent("MPNOK"),(42==this.state.s_m||43==this.state.s_m)&&(this.doMPNOK(t),this.notifyStatus(pe.Subscribed),this.notifyOnSubscription(),this.notifyOnSubscriptionsUpdated(),this.state.s_m=44,this.state.s_st=60,this.state.s_ct=70,this.state.s_ab=80,this.state.traceState(),this.evtCheck())},evtMPNDEL:function(){this.traceEvent("MPNDEL"),72==this.state.s_ct&&(this.notifyStatus(pe.Unknown),this.notifyOnUnsubscription(),this.notifyOnSubscriptionsUpdated(),this.finalize(),this.state.s_m=52,this.state.s_st=null,this.state.s_ct=null,this.state.s_ab=null,this.state.traceState())},evtMpnUpdate:function(t){this.traceEvent("update");var e=t.getValue("status_timestamp"),s=t.getValue("status");s=null!=s?s.toUpperCase():null;var i=t.getValue("command");i=null!=i?i.toUpperCase():null,44==this.state.s_m&&"DELETE"==i?(this.notifyStatus(pe.Unknown),this.notifyOnUnsubscription(),this.notifyOnSubscriptionsUpdated(),this.finalize(),this.state.s_m=52,this.state.s_st=null,this.state.s_ct=null,this.state.s_ab=null,this.state.traceState()):45==this.state.s_m?"ACTIVE"==s?(this.notifyStatus(pe.Subscribed,e),this.notifyOnSubscription(),this.notifyUpdate(t),this.state.s_m=44,this.state.s_st=60,this.state.s_ct=70,this.state.s_ab=80,this.state.traceState(),this.evtCheck()):"TRIGGERED"==s&&(this.notifyStatus(pe.Triggered,e),this.notifyOnSubscription(),this.notifyOnTriggered(),this.notifyUpdate(t),this.state.s_m=44,this.state.s_st=61,this.state.s_ct=70,this.state.s_ab=80,this.state.traceState(),this.evtCheck()):44==this.state.s_m&&(this.state.s_m=44,this.state.traceState(),this.evtMpnUpdate_AbortRegion(t))},evtMpnUpdate_AbortRegion:function(t){this.traceEvent("update");var e=!0;81==this.state.s_ab&&(this.state.s_ab=80,this.state.traceState(),e=this.evtMpnUpdate_StatusRegion(t),this.evtRestoreSession()),e&&this.evtMpnUpdate_StatusRegion(t)},evtMpnUpdate_StatusRegion:function(t){this.traceEvent("update");var e=t.getValue("status_timestamp"),s=t.getValue("status");return s=null!=s?s.toUpperCase():null,60==this.state.s_st?"ACTIVE"==s?(this.notifyUpdate(t),this.state.s_st=60,this.state.traceState()):"TRIGGERED"==s&&(this.notifyStatus(pe.Triggered,e),this.notifyOnTriggered(),this.notifyUpdate(t),this.state.s_st=61,this.state.traceState()):61==this.state.s_st&&("ACTIVE"==s?(this.notifyStatus(pe.Subscribed,e),this.notifyUpdate(t),this.state.s_st=60,this.state.traceState()):"TRIGGERED"==s&&(this.notifyUpdate(t),this.state.s_st=61,this.state.traceState())),!1},evtMpnEOS:function(){this.traceEvent("EOS"),81==this.state.s_ab&&(this.notifyStatus(pe.Unknown),this.notifyOnUnsubscription(),this.notifyOnSubscriptionsUpdated(),this.finalize(),this.state.s_m=51,this.state.s_st=null,this.state.s_ct=null,this.state.s_ab=null,this.state.traceState())},isPending:function(){return 42==this.state.s_m||72==this.state.s_ct||73==this.state.s_ct||74==this.state.s_ct},encode:function(t){if(42==this.state.s_m)return this.encodeActivate();if(72==this.state.s_ct)return this.encodeDeactivate();if(73==this.state.s_ct||74==this.state.s_ct)return this.encodeConfigure();throw new Me("Can't encode request")},encodeWS:function(){return"control\r\n"+this.encode(!0)},encodeActivate:function(){var t=new Ke;this.m_lastActivateReqId=this.m_client.generateFreshReqId(),t.LS_reqId(this.m_lastActivateReqId),t.LS_op("activate"),t.LS_subId(Pe.sure(this.m_subId)),t.LS_mode(Pe.sure(this.m_subscription.fetch_mode()));var e=this.m_subscription.getItemGroup(),s=this.m_subscription.getItems();null!=e?t.LS_group(e):null!=s&&t.LS_group(Oe.copy(s,s).join(" "));var i=this.m_subscription.getFieldSchema(),n=this.m_subscription.getFields();null!=i?t.LS_schema(i):null!=n&&t.LS_schema(Oe.copy(n,n).join(" "));var r=this.m_subscription.getDataAdapter();null!=r&&t.LS_data_adapter(r);var a=this.m_subscription.fetch_requestedMaxFrequency();if(null!=a)switch(a._hx_index){case 0:t.LS_requested_max_frequency_Float(a.max);break;case 1:t.LS_requested_max_frequency("unlimited")}var o=this.m_subscription.fetch_requestedBufferSize();if(null!=o)switch(o._hx_index){case 0:t.LS_requested_buffer_size_Int(o.size);break;case 1:t.LS_requested_buffer_size("unlimited")}t.PN_deviceId(Pe.sure(this.m_client.fetch_mpn_deviceId())),t.PN_notificationFormat(Pe.sure(this.m_initFormat));var h=this.m_initTrigger;return null!=h&&t.PN_trigger(h),this.m_coalescing&&t.PN_coalescing(!0),ri.isInfoEnabled()&&ri.info("Sending MPNSubscription activate: "+l.string(t)),t.getEncodedString()},encodeDeactivate:function(){var t=new Ke;return this.m_lastDeactivateReqId=this.m_client.generateFreshReqId(),t.LS_reqId(this.m_lastDeactivateReqId),t.LS_op("deactivate"),t.PN_deviceId(Pe.sure(this.m_client.fetch_mpn_deviceId())),t.PN_subscriptionId(Pe.sure(this.m_subscription.getSubscriptionId())),ri.isInfoEnabled()&&ri.info("Sending MPNSubscription deactivate: "+l.string(t)),t.getEncodedString()},encodeConfigure:function(){var t=new Ke;this.m_lastConfigureReqId=this.m_client.generateFreshReqId(),t.LS_reqId(this.m_lastConfigureReqId),t.LS_op("pn_reconf"),t.LS_mode(Pe.sure(this.m_subscription.fetch_mode()));var e=this.m_subscription.getItemGroup(),s=this.m_subscription.getItems();null!=e?t.LS_group(e):null!=s&&t.LS_group(Oe.copy(s,s).join(" "));var i=this.m_subscription.getFieldSchema(),n=this.m_subscription.getFields();null!=i?t.LS_schema(i):null!=n&&t.LS_schema(Oe.copy(n,n).join(" "));var r=this.m_subscription.getDataAdapter();if(null!=r&&t.LS_data_adapter(r),t.PN_deviceId(Pe.sure(this.m_client.fetch_mpn_deviceId())),t.PN_subscriptionId(Pe.sure(this.m_subscription.getSubscriptionId())),74==this.state.s_ct&&t.PN_notificationFormat(Pe.sure(this.m_currentFormat)),73==this.state.s_ct){var a=this.m_currentTrigger;t.PN_trigger(null!=a?a:"")}return ri.isInfoEnabled()&&ri.info("Sending MPNSubscription configuration: "+l.string(t)),t.getEncodedString()},genSendSubscribe:function(){this.m_client.evtSendControl(this)},genSendConfigure:function(){this.m_client.evtSendControl(this)},genSendUnsubscribe:function(){this.m_client.evtSendControl(this)},notifyStatus:function(t,e){this.m_subscription.changeStatus(t,e)},notifyOnSubscriptionError:function(t,e){this.m_subscription.fireOnSubscriptionError(t,e)},notifyOnSubscriptionAbort:function(){this.m_subscription.fireOnSubscriptionError(54,"The request was aborted because the operation could not be completed")},notifyOnSubscriptionDiscarded:function(){this.m_subscription.fireOnSubscriptionError(55,"The request was discarded because the operation could not be completed")},notifyOnUnsubscriptionError:function(t,e){this.m_subscription.fireOnUnsubscriptionError(t,e)},notifyOnUnsubscriptionAbort:function(){this.m_subscription.fireOnUnsubscriptionError(54,"The request was aborted because the operation could not be completed")},doMPNOK:function(t){this.m_subscription.setSubscriptionId(t)},notifyOnSubscription:function(){this.m_subscription.fireOnSubscription()},notifyOnUnsubscription:function(){this.m_subscription.fireOnUnsubscription()},notifyOnTriggered:function(){this.m_subscription.fireOnTriggered()},notifyOnSubscriptionsUpdated:function(){Pe.sure(this.m_client.fetch_mpn_device()).fireOnSubscriptionsUpdated()},notifyUpdate:function(t){this.m_subscription.changeStatusTs(t.getValue("status_timestamp")),this.m_subscription.changeMode(t.getValue("mode")),this.m_subscription.changeAdapter(t.getValue("adapter")),this.m_subscription.changeGroup(t.getValue("group")),this.m_subscription.changeSchema(t.getValue("schema")),this.m_subscription.changeFormat(t.getValue("notification_format")),this.m_subscription.changeTrigger(t.getValue("trigger")),this.m_subscription.changeBufferSize(t.getValue("requested_buffer_size")),this.m_subscription.changeMaxFrequency(t.getValue("requested_max_frequency"))},doSetCurrentFormat:function(){this.m_currentFormat=this.m_subscription.fetch_requestedFormat()},doSetCurrentTrigger:function(){this.m_currentTrigger=this.m_subscription.fetch_requestedTrigger()},notifyOnModificationError_Format:function(t,e){this.m_subscription.fireOnModificationError(t,e,"notification_format")},notifyOnModificationAbort_Format:function(){this.m_subscription.fireOnModificationError(54,"The request was aborted because the operation could not be completed","notification_format")},notifyOnModificationError_Trigger:function(t,e){this.m_subscription.fireOnModificationError(t,e,"trigger")},notifyOnModificationAbort_Trigger:function(){this.m_subscription.fireOnModificationError(54,"The request was aborted because the operation could not be completed","trigger")},traceEvent:function(t){ai.isTraceEnabled()&&ai.trace("mpn#sub#"+t+"("+this.m_subId+":"+this.fetch_mpnSubId()+") in "+l.string(this.state))},__class__:Rt};var It=function(t,e,s){this.subId=t,this.itemIdx=e,this.values=s};function Ct(t){return Pe.sure(l.parseInt(t))}function xt(t){return Pe.sure(parseFloat(t))}function Lt(t){return Ct(t)}function Nt(t){for(var e=Mt(t,",")+1,s=Mt(t,",",e)+1,i=Mt(t,",",s)+1,n=Ct(t.substring(e,s-1)),r=Ct(t.substring(s,i-1)),a=new Ps,o=i-1,h=1;o<t.length;){var u=t.indexOf("|",o+1);-1==u&&(u=t.length);var l=t.substring(o+1,u);if(""==l)a.h[h]=es.unchanged,++h;else if("#"==l)a.h[h]=es.changed(null),++h;else if("$"==l)a.h[h]=es.changed(""),++h;else if("^"==l.charAt(0))if("P"==l.charAt(1)){var c=Dt(l.substring(2));try{var d=Rs._new(c);a.h[h]=es.jsonPatch(d),++h}catch(t){var _=g.caught(t);throw oi.isErrorEnabled()&&oi.error("Invalid JSON patch "+c+": "+_.get_message()+"\n"+_.details()),new Me("The JSON Patch for the field "+h+" is not well-formed")}}else if("T"==l.charAt(1)){var p=Dt(l.substring(2));a.h[h]=es.diffPatch(p),++h}else for(var f=Ct(l.substring(1)),m=0;m<f;)++m,a.h[h]=es.unchanged,++h;else{var v=es.changed(Dt(l));a.h[h]=v,++h}o=u}return new It(n,r,a)}function Mt(t,e,s){var i=t.indexOf(e,s);if(-1==i)throw new Me("string not found");return i}function Dt(t){for(var e=Pt.ofString(t,kt.UTF8),s=0,i=0;s<e.length;)37==e.b[s]?(e.b[i++]=(Ot(e.b[s+1])<<4)+Ot(e.b[s+2]),s+=3):e.b[i++]=e.b[s++];return e.getString(0,i,kt.UTF8)}function Ot(t){var e=0;return(e=t-97+10)<=9&&(e=t-65+10)<=9&&(e=t-48),e}It.__name__=!0,It.prototype={__class__:It};var Pt=function(t){this.length=t.byteLength,this.b=new Uint8Array(t),this.b.bufferValue=t,t.hxBytes=this,t.bytes=this.b};Pt.__name__=!0,Pt.ofString=function(t,e){if(e==kt.RawNative){for(var s=new Uint8Array(t.length<<1),i=0,n=t.length;i<n;){var r=i++,a=t.charCodeAt(r);s[r<<1]=255&a,s[r<<1|1]=a>>8}return new Pt(s.buffer)}var o=[];for(r=0;r<t.length;)55296<=(a=t.charCodeAt(r++))&&a<=56319&&(a=a-55232<<10|1023&t.charCodeAt(r++)),a<=127?o.push(a):a<=2047?(o.push(192|a>>6),o.push(128|63&a)):a<=65535?(o.push(224|a>>12),o.push(128|a>>6&63),o.push(128|63&a)):(o.push(240|a>>18),o.push(128|a>>12&63),o.push(128|a>>6&63),o.push(128|63&a));return new Pt(new Uint8Array(o).buffer)},Pt.prototype={getString:function(t,e,s){if(t<0||e<0||t+e>this.length)throw g.thrown(qs.OutsideBounds);null==s&&(s=kt.UTF8);var i="",n=this.b,r=t,a=t+e;switch(s._hx_index){case 0:for(;r<a;)if((l=n[r++])<128){if(0==l)break;i+=String.fromCodePoint(l)}else if(l<224){var o=(63&l)<<6|127&n[r++];i+=String.fromCodePoint(o)}else if(l<240){var h=(31&l)<<12|(127&n[r++])<<6|127&n[r++];i+=String.fromCodePoint(h)}else{var u=(15&l)<<18|(127&n[r++])<<12|(127&n[r++])<<6|127&n[r++];i+=String.fromCodePoint(u)}break;case 1:for(;r<a;){var l=n[r++]|n[r++]<<8;i+=String.fromCodePoint(l)}}return i},__class__:Pt};var kt=i["haxe.io.Encoding"]={__ename__:!0,__constructs__:null,UTF8:{_hx_name:"UTF8",_hx_index:0,__enum__:"haxe.io.Encoding",toString:s},RawNative:{_hx_name:"RawNative",_hx_index:1,__enum__:"haxe.io.Encoding",toString:s}};kt.__constructs__=[kt.UTF8,kt.RawNative];var Ft=function(){this.body=""};Ft.__name__=!0,Ft.isEmpty=function(t){return 0==t.length},Ft.lengthOfBytes=function(t){return Pt.ofString(t,kt.UTF8).length},Ft.prototype={getByteSize:function(){return Ft.lengthOfBytes(this.body)},getBody:function(){return this.body},addSubRequest:function(t){Ft.isEmpty(this.body)?this.body=t:this.body+="\r\n"+t},addSubRequestOnlyIfBodyIsLessThan:function(t,e){return Ft.isEmpty(this.body)&&Ft.lengthOfBytes(t)<=e?(this.body=t,!0):Ft.lengthOfBytes(this.body)+Ft.EOL_LEN+Ft.lengthOfBytes(t)<=e&&(this.body+="\r\n"+t,!0)},__class__:Ft};var At=function(){this.attempt=1,this._currentRetryDelay=0};At.__name__=!0,At.prototype={get_currentRetryDelay:function(){return this._currentRetryDelay},increase:function(){this.attempt>10?this._currentRetryDelay<6e4&&(2*this._currentRetryDelay<6e4?this._currentRetryDelay*=2:this._currentRetryDelay=6e4):this.attempt+=1},reset:function(t){this.attempt=1,this._currentRetryDelay=t},__class__:At};var qt=function(){};qt.__name__=!0,qt.__isInterface__=!0,qt.__interfaces__=[Q],qt.prototype={__class__:qt};var Bt=function(t){this.subId=t,this.s_m=1};Bt.__name__=!0,Bt.prototype={toString:function(){var t="<m="+this.s_m;return null!=this.s_s&&(t+=" s="+this.s_s),null!=this.s_c&&(t+=" c="+this.s_c),t+=">"},traceState:function(){ai.isTraceEnabled()&&ai.trace("sub#goto("+this.subId+") "+this.toString())},__class__:Bt};var Ut=function(t,e){var s;switch(this.lock=e.lock,this.subId=e.generateFreshSubId(),t.fetch_mode()){case"COMMAND":s=Ut.is2LevelCommand(t)?new ut(t,e,this.subId):new ht(t,e,this.subId);break;case"DISTINCT":s=new lt(t,e,this.subId);break;case"MERGE":s=new ct(t,e,this.subId);break;case"RAW":s=new dt(t,e,this.subId)}this.m_strategy=s,this.state=new Bt(this.subId),this.m_client=e,this.m_subscription=t,this.m_client.relateSubManager(this),this.m_subscription.relate(this)};Ut.__name__=!0,Ut.__interfaces__=[qt],Ut.is2LevelCommand=function(t){return"COMMAND"==t.fetch_mode()&&(null!=t.getCommandSecondLevelFields()||null!=t.getCommandSecondLevelFieldSchema())},Ut.prototype={finalize:function(){this.m_strategy.evtDispose(),this.m_client.unrelateSubManager(this),this.m_subscription.unrelate(this)},evtExtSubscribe:function(){this.traceEvent("subscribe"),1==this.state.s_m&&(this.doSetActive(),this.doSubscribe(),this.state.s_m=2,this.state.traceState(),this.genSendControl())},evtExtUnsubscribe:function(){this.traceEvent("unsubscribe"),2==this.state.s_m?(this.doSetInactive(),this.finalize(),this.state.s_m=30,this.state.traceState()):3==this.state.s_m?(this.doUnsubscribe(),this.doSetInactive(),this.state.s_m=5,this.state.traceState(),this.genSendControl()):10==this.state.s_s&&(this.doUnsubscribe(),this.m_subscription.setInactive(),this.notifyOnUnsubscription(),this.state.s_m=5,this.state.s_s=null,this.state.s_c=null,this.state.traceState(),this.genSendControl())},evtExtAbort:function(){this.traceEvent("abort"),2==this.state.s_m?(this.state.s_m=2,this.state.traceState()):3==this.state.s_m?(this.doAbort(),this.doSetActive(),this.state.s_m=2,this.state.traceState()):10==this.state.s_s?(this.doAbort(),this.doSetActive(),this.notifyOnUnsubscription(),this.state.s_s=null,this.state.s_c=null,this.state.s_m=2,this.state.traceState()):5==this.state.s_m&&(this.finalize(),this.state.s_m=32,this.state.traceState())},evtREQERR:function(t,e,s){this.traceEvent("REQERR"),2==this.state.s_m&&t==this.m_lastAddReqId?(this.doSetInactive(),this.notifyOnSubscriptionError(e,s),this.finalize(),this.state.s_m=30,this.state.traceState()):5==this.state.s_m&&t==this.m_lastDeleteReqId?(this.finalize(),this.state.s_m=32,this.state.traceState()):22==this.state.s_c&&t==this.m_lastReconfReqId&&(ds.extEquals(this.m_reqMaxFrequency,this.m_subscription.fetch_requestedMaxFrequency())?(this.state.s_c=21,this.state.traceState()):(this.state.s_c=20,this.state.traceState(),this.evtCheckFrequency()))},evtREQOK:function(t){this.traceEvent("REQOK"),2==this.state.s_m&&t==this.m_lastAddReqId?(this.state.s_m=3,this.state.traceState()):5==this.state.s_m&&t==this.m_lastDeleteReqId?(this.finalize(),this.state.s_m=32,this.state.traceState()):22==this.state.s_c&&t==this.m_lastReconfReqId&&(this.doREQOKConfigure(),this.state.s_c=20,this.state.traceState(),this.evtCheckFrequency())},checkItems:function(t,e){return null==t||t==e},checkFields:function(t,e){return null==t||t==e},checkItemsAndFields:function(t,e,s,i){return!!this.checkItems(t,s)&&this.checkFields(e,i)},evtSUBOK:function(t,e){if(this.traceEvent("SUBOK"),2==this.state.s_m||3==this.state.s_m){var s,i=null!=(s=this.m_subscription.fetch_items())?s.length:null,n=null!=(s=this.m_subscription.fetch_fields())?s.length:null;this.checkItemsAndFields(i,n,t,e)?(this.doSUBOK(t,e),this.notifyOnSubscription(),this.state.s_m=4,this.state.s_s=10,this.state.s_c=20,this.state.traceState(),this.evtCheckFrequency()):(this.doUnsubscribe(),this.doSetInactive(),this.notifyOnSubscriptionError_CountMismatch(i,n,t,e),this.state.s_m=5,this.state.traceState(),this.genSendControl())}},evtSUBCMD:function(t,e,s,i){if(this.traceEvent("SUBCMD"),2==this.state.s_m||3==this.state.s_m){var n,r=null!=(n=this.m_subscription.fetch_items())?n.length:null,a=null!=(n=this.m_subscription.fetch_fields())?n.length:null;this.checkItemsAndFields(r,a,t,e)?(this.doSUBCMD(t,e,i,s),this.notifyOnSubscription(),this.state.s_m=4,this.state.s_s=10,this.state.s_c=20,this.state.traceState(),this.evtCheckFrequency()):(this.doUnsubscribe(),this.doSetInactive(),this.notifyOnSubscriptionError_CountMismatch(r,a,t,e),this.state.s_m=5,this.state.traceState(),this.genSendControl())}},evtUNSUB:function(){this.traceEvent("UNSUB"),10==this.state.s_s?(this.doUNSUB(),this.doSetInactive(),this.notifyOnUnsubscription(),this.finalize(),this.state.s_m=31,this.state.s_s=null,this.state.s_c=null,this.state.traceState()):5==this.state.s_m&&(this.finalize(),this.state.s_m=32,this.state.traceState())},evtU:function(t,e){this.traceEvent("U"),10==this.state.s_s&&(this.doU(t,e),this.state.s_s=10,this.state.traceState())},evtEOS:function(t){this.traceEvent("EOS"),10==this.state.s_s&&(this.doEOS(t),this.state.s_s=10,this.state.traceState())},evtCS:function(t){this.traceEvent("CS"),10==this.state.s_s&&(this.doCS(t),this.state.s_s=10,this.state.traceState())},evtOV:function(t,e){this.traceEvent("OV"),10==this.state.s_s&&(this.doOV(t,e),this.state.s_s=10,this.state.traceState())},evtCONF:function(t){this.traceEvent("CONF"),10==this.state.s_s&&(this.doCONF(t),this.state.s_s=10,this.state.traceState())},evtCheckFrequency:function(){this.traceEvent("check.frequency"),20==this.state.s_c&&(ds.extEquals(this.m_subscription.fetch_requestedMaxFrequency(),this.m_currentMaxFrequency)?(this.state.s_c=21,this.state.traceState()):(this.doConfigure(),this.state.s_c=22,this.state.traceState(),this.genSendControl()))},evtExtConfigure:function(){this.traceEvent("configure"),21==this.state.s_c&&(this.state.s_c=20,this.state.traceState(),this.evtCheckFrequency())},isPending:function(){return 2==this.state.s_m||5==this.state.s_m||22==this.state.s_c},encode:function(t){if(2==this.state.s_m)return this.encodeAdd(t);if(5==this.state.s_m)return this.encodeDelete(t);if(22==this.state.s_c)return this.encodeReconf(t);throw new Me("Can't encode request")},encodeWS:function(){return"control\r\n"+this.encode(!0)},getValue:function(t,e){return this.m_strategy.getValue(t,e)},getCommandValue:function(t,e,s){return this.m_strategy.getCommandValue(t,e,s)},encodeAdd:function(t){var e=new Ke;this.m_lastAddReqId=this.m_client.generateFreshReqId(),e.LS_reqId(this.m_lastAddReqId),e.LS_op("add"),e.LS_subId(this.subId),e.LS_mode(this.m_subscription.fetch_mode());var s=this.m_subscription.getItemGroup(),i=this.m_subscription.fetchItems();null!=s?e.LS_group(s):null!=i&&e.LS_group(i.join(" "));var n=this.m_subscription.getFieldSchema(),r=this.m_subscription.fetchFields();null!=n?e.LS_schema(n):null!=r&&e.LS_schema(r.join(" "));var a=this.m_subscription.getDataAdapter();null!=a&&e.LS_data_adapter(a);var o=this.m_subscription.getSelector();null!=o&&e.LS_selector(o);var h=this.m_subscription.fetch_requestedSnapshot();if(null!=h)switch(h._hx_index){case 0:e.LS_snapshot(!0);break;case 1:e.LS_snapshot(!1);break;case 2:e.LS_snapshot_Int(h.len)}var u=this.m_currentMaxFrequency;if(null!=u)switch(u._hx_index){case 0:e.LS_requested_max_frequency_Float(u.max);break;case 1:e.LS_requested_max_frequency("unlimited");break;case 2:e.LS_requested_max_frequency("unfiltered")}var c=this.m_subscription.fetch_requestedBufferSize();if(null!=c)switch(c._hx_index){case 0:e.LS_requested_buffer_size_Int(c.size);break;case 1:e.LS_requested_buffer_size("unlimited")}return t&&e.LS_ack(!1),ri.isInfoEnabled()&&ri.info("Sending Subscription add: "+l.string(e)),e.getEncodedString()},encodeDelete:function(t){var e=new Ke;return this.m_lastDeleteReqId=this.m_client.generateFreshReqId(),e.LS_reqId(this.m_lastDeleteReqId),e.LS_subId(this.subId),e.LS_op("delete"),t&&e.LS_ack(!1),ri.isInfoEnabled()&&ri.info("Sending Subscription delete: "+l.string(e)),e.getEncodedString()},encodeReconf:function(t){var e=new Ke;this.m_lastReconfReqId=this.m_client.generateFreshReqId(),e.LS_reqId(this.m_lastReconfReqId),e.LS_subId(this.subId),e.LS_op("reconf");var s=this.m_reqMaxFrequency;if(null!=s)switch(s._hx_index){case 0:e.LS_requested_max_frequency_Float(s.max);break;case 1:e.LS_requested_max_frequency("unlimited");break;case 2:e.LS_requested_max_frequency("unfiltered")}return ri.isInfoEnabled()&&ri.info("Sending Subscription configuration: "+l.string(e)),e.getEncodedString()},doSetActive:function(){this.m_subscription.setActive()},doSetInactive:function(){this.m_subscription.setInactive()},doSubscribe:function(){this.m_currentMaxFrequency=this.m_subscription.fetch_requestedMaxFrequency()},doUnsubscribe:function(){this.m_strategy.evtUnsubscribe(),this.m_subscription.unrelate(this)},doAbort:function(){this.m_lastAddReqId=null,this.m_lastDeleteReqId=null,this.m_lastReconfReqId=null,this.m_reqMaxFrequency=null,this.m_currentMaxFrequency=this.m_subscription.fetch_requestedMaxFrequency(),this.m_strategy.evtAbort()},genSendControl:function(){this.m_client.evtSendControl(this)},notifyOnSubscription:function(){this.m_subscription.fireOnSubscription(this.subId)},notifyOnUnsubscription:function(){this.m_subscription.fireOnUnsubscription(this.subId)},notifyOnSubscriptionError:function(t,e){this.m_subscription.fireOnSubscriptionError(this.subId,t,e)},notifyOnSubscriptionError_CountMismatch:function(t,e,s,i){this.checkItems(t,s)?this.m_subscription.fireOnSubscriptionError(this.subId,61,"Expected "+e+" fields but got "+i):this.m_subscription.fireOnSubscriptionError(this.subId,61,"Expected "+t+" items but got "+s)},doConfigure:function(){this.m_reqMaxFrequency=this.m_subscription.fetch_requestedMaxFrequency(),this.m_strategy.evtSetRequestedMaxFrequency(this.m_reqMaxFrequency)},doREQOKConfigure:function(){this.m_currentMaxFrequency=this.m_reqMaxFrequency},doSUBOK:function(t,e){this.m_subscription.setSubscribed(this.subId,t,e),this.m_strategy.evtOnSUB(t,e,null,null,null)},doSUBCMD:function(t,e,s,i){this.m_subscription.setSubscribedCMD(this.subId,t,e,s,i),this.m_strategy.evtOnSUB(t,e,s,i,this.m_currentMaxFrequency)},doUNSUB:function(){this.m_strategy.evtOnUNSUB()},doU:function(t,e){if(t>Pe.sure(this.m_subscription.fetch_nItems()))throw new Me("Assertion failure: itemIdx <= m_subscription.fetch_nItems().sure()");this.m_strategy.evtUpdate(t,e)},doEOS:function(t){this.m_strategy.evtOnEOS(t),this.m_subscription.fireOnEndOfSnapshot(t,this.subId)},doCS:function(t){this.m_strategy.evtOnCS(t),this.m_subscription.fireOnClearSnapshot(t,this.subId)},doOV:function(t,e){this.m_subscription.fireOnLostUpdates(t,e,this.subId)},doCONF:function(t){this.m_strategy.evtOnCONF(t)},traceEvent:function(t){ai.isTraceEnabled()&&ai.trace("sub#"+t+"("+this.subId+") in "+l.string(this.state))},__class__:Ut};var Wt=function(t,e){this.s_m=1,this.subId=t,this.lock=e.lock,this.m_client=e,e.relateSubManager(this)};Wt.__name__=!0,Wt.__interfaces__=[qt],Wt.prototype={finalize:function(){this.m_client.unrelateSubManager(this)},evtExtAbort:function(){this.traceEvent("abort"),2==this.s_m&&(this.finalize(),this.goto(3))},evtREQERR:function(t,e,s){this.traceEvent("REQERR"),2==this.s_m&&t==this.m_lastDeleteReqId&&(this.finalize(),this.goto(3))},evtREQOK:function(t){this.traceEvent("REQOK"),2==this.s_m&&t==this.m_lastDeleteReqId&&(this.finalize(),this.goto(3))},evtSUBOK:function(t,e){this.traceEvent("SUBOK"),1==this.s_m&&(this.goto(2),this.genSendControl())},evtSUBCMD:function(t,e,s,i){this.traceEvent("SUBCMD"),1==this.s_m&&(this.goto(2),this.genSendControl())},evtUNSUB:function(){this.traceEvent("UNSUB"),2==this.s_m&&(this.finalize(),this.goto(3))},evtU:function(t,e){this.traceEvent("U"),1==this.s_m&&(this.goto(2),this.genSendControl())},evtEOS:function(t){this.traceEvent("EOS"),1==this.s_m&&(this.goto(2),this.genSendControl())},evtCS:function(t){this.traceEvent("CS"),1==this.s_m&&(this.goto(2),this.genSendControl())},evtOV:function(t,e){this.traceEvent("OV"),1==this.s_m&&(this.goto(2),this.genSendControl())},evtCONF:function(t){this.traceEvent("CONF"),1==this.s_m&&(this.goto(2),this.genSendControl())},isPending:function(){return 2==this.s_m},encode:function(t){if(this.isPending())return this.encodeDelete(t);throw new Me("Can't encode unsubscription request")},encodeWS:function(){return"control\r\n"+this.encode(!0)},genSendControl:function(){this.m_client.evtSendControl(this)},encodeDelete:function(t){var e=new Ke;return this.m_lastDeleteReqId=this.m_client.generateFreshReqId(),e.LS_reqId(this.m_lastDeleteReqId),e.LS_subId(this.subId),e.LS_op("delete"),t&&e.LS_ack(!1),e.LS_cause("zombie"),ri.isInfoEnabled()&&ri.info("Sending Subscription delete: "+l.string(e)),e.getEncodedString()},traceEvent:function(t){ai.isTraceEnabled()&&ai.trace("zsub#"+t+"("+this.subId+") in "+this.s_m)},goto:function(t){this.s_m=t,ai.isTraceEnabled()&&ai.trace("zsub#goto("+this.subId+") "+this.s_m)},__class__:Wt};var Ht=function(){};Ht.__name__=!0,Ht.__interfaces__=[I],Ht.prototype={__class__:Ht};var Vt=function(t,e,s,i){this.m_subId=i,this.itemIdx=t,this.subscription=e,this.client=s,this.lock=s.lock};Vt.__name__=!0,Vt.prototype={finalize:function(){},evtUpdate:function(t){this.fatalError()},evtOnEOS:function(){this.fatalError()},evtOnCS:function(){this.fatalError()},evtDispose:function(t){this.fatalError()},getValue:function(t){return null!=this.currValues?ie.toString(this.currValues.h[t]):null},getCommandValue:function(t,e){throw new Me("Unsupported operation")},fatalError:function(){throw new Me("Unsupported operation")},doFirstUpdate:function(t){this.doUpdate(t,!1)},doUpdate0:function(t){this.doUpdate(t,!1)},doFirstSnapshot:function(t){this.doUpdate(t,!0)},doSnapshot:function(t){this.doUpdate(t,!0)},doUpdate:function(t,e){var s=this.currValues;this.currValues=ne(s,t);var i=re(s,this.currValues),n=ae(s,t),r=new Jt(this.itemIdx,this.subscription,this.currValues,i,e,n);this.subscription.fireOnItemUpdate(r,this.m_subId)},__class__:Vt};var zt=function(t,e,s,i){this.keys=new ks,Vt.call(this,t,e,s,i),this.s_m=e.hasSnapshot()?3:1};zt.__name__=!0,zt.__super__=Vt,zt.prototype=n(Vt.prototype,{finalize:function(){},unrelate:function(t){var e=this.keys;Object.prototype.hasOwnProperty.call(e.h,t)&&delete e.h[t]},evtUpdate:function(t){switch(this.traceEvent("update"),this.s_m){case 1:this.doFirstUpdate(t),this.goto(2);break;case 2:this.doUpdate0(t),this.goto(2);break;case 3:this.doFirstSnapshot(t),this.goto(4);break;case 4:this.doSnapshot(t),this.goto(4)}},evtOnEOS:function(){switch(this.traceEvent("onEOS"),this.s_m){case 3:this.goto(1);break;case 4:this.goto(2)}},evtOnCS:function(){throw new Me("Unsupported method")},evtDispose:function(t){switch(this.traceEvent("dispose"),this.s_m){case 1:case 2:case 3:case 4:this.finalize(),this.goto(5),this.genDisposeKeys(),t.unrelate(this.itemIdx)}},getCommandValue:function(t,e){var s=this.keys.h[t];return null!=s?s.getCommandValue(e):null},createKey:function(t){throw new Me("Abstract method")},doUpdate:function(t,e){this.currValues=ne(this.currValues,t),this.selectKey().evtUpdate(this.currValues,e)},genDisposeKeys:function(){for(var t=ks.createCopy(this.keys.h).h,e=Object.keys(t),s=e.length,i=0;i<s;)t[e[i++]].evtDispose()},selectKey:function(){var t=this.currValues,e=this.subscription.getKeyPosition(),s=ie.toString(t.h[e]);return null==(e=this.keys.h[s])&&(e=this.createKey(s),this.keys.h[s]=e),e},goto:function(t){this.s_m=t,ai.isTraceEnabled()&&ai.trace("sub#itm#goto("+this.m_subId+":"+this.itemIdx+") in "+this.s_m)},traceEvent:function(t){ai.isTraceEnabled()&&ai.trace("sub#itm#"+t+"("+this.m_subId+":"+this.itemIdx+") in "+this.s_m)},__class__:zt});var Yt=function(t,e,s,i){zt.call(this,t,e,s,i)};Yt.__name__=!0,Yt.__super__=zt,Yt.prototype=n(zt.prototype,{evtOnCS:function(){switch(this.traceEvent("onCS"),this.s_m){case 1:case 2:case 3:case 4:this.goto(this.s_m),this.genDisposeKeys()}},createKey:function(t){return new $t(t,this)},__class__:Yt});var Gt=function(t,e,s,i,n){zt.call(this,t,e,i,n),this.strategy=s};Gt.__name__=!0,Gt.__super__=zt,Gt.prototype=n(zt.prototype,{evtOnCS:function(){switch(this.traceEvent("onCS"),this.s_m){case 1:case 2:case 3:case 4:this.goto(this.s_m),this.genDisposeKeys(),this.genOnRealMaxFrequency2LevelRemoved()}},evtSetRequestedMaxFrequency:function(){switch(this.traceEvent("setRequestedMaxFrequency"),this.s_m){case 1:case 2:case 3:case 4:this.goto(this.s_m),this.genSetRequestedMaxFrequency()}},createKey:function(t){return new te(t,this)},genSetRequestedMaxFrequency:function(){for(var t=this.keys.h,e=Object.keys(t),s=e.length,i=0;i<s;)t[e[i++]].evtSetRequestedMaxFrequency()},genOnRealMaxFrequency2LevelRemoved:function(){this.strategy.evtOnRealMaxFrequency2LevelRemoved()},__class__:Gt});var Kt=function(t,e,s,i){Vt.call(this,t,e,s,i),this.s_m=e.hasSnapshot()?3:1};Kt.__name__=!0,Kt.__super__=Vt,Kt.prototype=n(Vt.prototype,{evtUpdate:function(t){switch(this.traceEvent("update"),this.s_m){case 1:this.doFirstUpdate(t),this.goto(2);break;case 2:this.doUpdate0(t),this.goto(2);break;case 3:this.doFirstSnapshot(t),this.goto(4);break;case 4:this.doSnapshot(t),this.goto(4)}},evtOnEOS:function(){switch(this.traceEvent("onEOS"),this.s_m){case 3:this.goto(1);break;case 4:this.goto(2)}},evtOnCS:function(){},evtDispose:function(t){switch(this.traceEvent("dispose"),this.s_m){case 1:case 2:case 3:case 4:this.finalize(),this.goto(5),t.unrelate(this.itemIdx)}},goto:function(t){this.s_m=t,ai.isTraceEnabled()&&ai.trace("sub#itm#goto("+this.m_subId+":"+this.itemIdx+") "+this.s_m)},traceEvent:function(t){ai.isTraceEnabled()&&ai.trace("sub#itm#"+t+"("+this.m_subId+":"+this.itemIdx+") in "+this.s_m)},__class__:Kt});var jt=function(){};jt.__name__=!0,jt.__isInterface__=!0,jt.prototype={__class__:jt};var Qt=function(t,e,s,i){this.s_m=1,Vt.call(this,t,e,s,i)};Qt.__name__=!0,Qt.__super__=Vt,Qt.prototype=n(Vt.prototype,{evtUpdate:function(t){switch(this.traceEvent("update"),this.s_m){case 1:this.subscription.hasSnapshot()?(this.doSnapshot(t),this.goto(2)):(this.doFirstUpdate(t),this.goto(3));break;case 2:case 3:this.doUpdate0(t),this.goto(3)}},evtDispose:function(t){switch(this.traceEvent("dispose"),this.s_m){case 1:case 2:case 3:this.finalize(),this.goto(4),t.unrelate(this.itemIdx)}},goto:function(t){this.s_m=t,ai.isTraceEnabled()&&ai.trace("sub#itm#goto("+this.m_subId+":"+this.itemIdx+") "+this.s_m)},traceEvent:function(t){ai.isTraceEnabled()&&ai.trace("sub#itm#"+t+"("+this.m_subId+":"+this.itemIdx+") in "+this.s_m)},__class__:Qt});var Xt=function(t,e,s,i){this.s_m=1,Vt.call(this,t,e,s,i)};Xt.__name__=!0,Xt.__super__=Vt,Xt.prototype=n(Vt.prototype,{evtUpdate:function(t){switch(this.traceEvent("update"),this.s_m){case 1:this.doFirstUpdate(t),this.goto(2);break;case 2:this.doUpdate0(t),this.goto(2)}},evtDispose:function(t){switch(this.traceEvent("dispose"),this.s_m){case 1:case 2:this.finalize(),this.goto(3),t.unrelate(this.itemIdx)}},goto:function(t){this.s_m=t,ai.isTraceEnabled()&&ai.trace("sub#itm#goto("+this.m_subId+":"+this.itemIdx+") "+this.s_m)},traceEvent:function(t){ai.isTraceEnabled()&&ai.trace("sub#itm#"+t+"("+this.m_subId+":"+this.itemIdx+") in "+this.s_m)},__class__:Xt});var Zt=function(t,e,s,i,n,r){var a=e.fetch_items(),o=e.fetch_fields(),h=e.fetch_fields2();this.m_itemIdx=t,this.m_items=oe(a),this.m_nFields=Pe.sure(e.fetch_nFields()),this.m_fields=oe(o),this.m_fields2=oe(h),this.m_newValues=s.copy(),this.m_changedFields=i.copy(),this.m_isSnapshot=n,this.m_jsonPatches=r};Zt.__name__=!0,Zt.__super__=Ht,Zt.prototype=n(Ht.prototype,{getItemName:function(){return null!=this.m_items?this.m_items.h[this.m_itemIdx]:null},getItemPos:function(){return this.m_itemIdx},isSnapshot:function(){return this.m_isSnapshot},getValue:function(t){return"number"==typeof t&&(0|t)===t?this.getValuePos(t):this.getValueName(l.string(t))},isValueChanged:function(t){return"number"==typeof t&&(0|t)===t?this.isValueChangedPos(t):this.isValueChangedName(l.string(t))},_getValueAsJSONPatchIfAvailable:function(t){if("number"==typeof t&&(0|t)===t)return this.m_jsonPatches.h[t];var e=this.getFieldIdxFromName(l.string(t));return null!=e?this.m_jsonPatches.h[e]:null},getValueAsJSONPatchIfAvailable:function(t){return this._getValueAsJSONPatchIfAvailable(t)},forEachChangedField:function(t){for(var e=this.m_changedFields.iterator();e.current<e.array.length;){var s=e.array[e.current++];try{t(this.getFieldNameFromIdx(s),s,ie.toString(this.m_newValues.h[s]))}catch(t){var i=g.caught(t);hi.isErrorEnabled()&&hi.error("An exception was thrown while executing the Function passed to the forEachChangedField method\n"+i.details())}}},forEachField:function(t){for(var e=this.m_newValues,s=e.keys();s.hasNext();){var i=s.next(),n=e.get(i);try{t(this.getFieldNameFromIdx(i),i,ie.toString(n))}catch(t){var r=g.caught(t);hi.isErrorEnabled()&&hi.error("An exception was thrown while executing the Function passed to the forEachField method\n"+r.details())}}},getValuePos:function(t){return ie.toString(this.m_newValues.h[t])},getValueName:function(t){if(null==this.m_fields&&null==this.m_fields2)throw new Me(vi);var e=this.getFieldIdxFromName(t);if(null==e)throw new v(yi);return ie.toString(this.m_newValues.h[e])},isValueChangedPos:function(t){return this.m_changedFields.contains(t)},isValueChangedName:function(t){if(null==this.m_fields&&null==this.m_fields2)throw new Me(vi);var e=this.getFieldIdxFromName(t);if(null==e)throw new v(yi);return this.m_changedFields.contains(e)},getFieldNameFromIdx:function(t){return t<=this.m_nFields?null!=this.m_fields?this.m_fields.h[t]:null:null!=this.m_fields2?this.m_fields2.h[t-this.m_nFields]:null},getFieldIdxFromName:function(t){var e,s,i=this.m_fields;return null!=i&&null!=(s=he(Pe.sure(i),t))?s:null!=(e=this.m_fields2)&&null!=(s=he(Pe.sure(e),t))?this.m_nFields+Pe.sure(s):null},toString:function(){var t="";t="[";for(var e=this.m_newValues,s=e.keys();s.hasNext();){var i=s.next(),n=e.get(i),r=this.getFieldNameFromIdx(i),a=null!=r?r:null==i?"null":""+i,o=l.string(n);i>1&&(t+=","),t+=null==a?"null":""+a,t+=":",t+=null==o?"null":""+o}return t+="]"},__class__:Zt});var Jt=function(t,e,s,i,n,r){var a=e.fetch_items(),o=e.fetch_fields();this.m_itemIdx=t,this.m_items=oe(a),this.m_nFields=Pe.sure(e.fetch_nFields()),this.m_fields=oe(o),null!=o&&o.length!=this.m_nFields&&li.isErrorEnabled()&&li.error("Expected "+this.m_nFields+" field names but got "+o.length+": "+l.string(o)),this.m_newValues=s.copy(),this.m_changedFields=i.copy(),this.m_isSnapshot=n,this.m_jsonPatches=r};Jt.__name__=!0,Jt.__super__=Ht,Jt.prototype=n(Ht.prototype,{getItemName:function(){return null!=this.m_items?this.m_items.h[this.m_itemIdx]:null},getItemPos:function(){return this.m_itemIdx},isSnapshot:function(){return this.m_isSnapshot},getValue:function(t){return"number"==typeof t&&(0|t)===t?this.getValuePos(t):this.getValueName(l.string(t))},isValueChanged:function(t){return"number"==typeof t&&(0|t)===t?this.isValueChangedPos(t):this.isValueChangedName(l.string(t))},_getValueAsJSONPatchIfAvailable:function(t){if("number"==typeof t&&(0|t)===t)return this.m_jsonPatches.h[t];var e=this.getFieldIdxFromName(l.string(t));return this.m_jsonPatches.h[e]},getValueAsJSONPatchIfAvailable:function(t){return this._getValueAsJSONPatchIfAvailable(t)},forEachChangedField:function(t){for(var e=this.m_changedFields.iterator();e.current<e.array.length;){var s=e.array[e.current++];try{t(null!=this.m_fields?this.m_fields.h[s]:null,s,ie.toString(this.m_newValues.h[s]))}catch(t){var i=g.caught(t);hi.isErrorEnabled()&&hi.error("An exception was thrown while executing the Function passed to the forEachChangedField method\n"+i.details())}}},forEachField:function(t){for(var e=this.m_newValues,s=e.keys();s.hasNext();){var i=s.next(),n=e.get(i);try{t(null!=this.m_fields?this.m_fields.h[i]:null,i,ie.toString(n))}catch(t){var r=g.caught(t);hi.isErrorEnabled()&&hi.error("An exception was thrown while executing the Function passed to the forEachField method\n"+r.details())}}},getValuePos:function(t){if(!(1<=t&&t<=this.m_nFields))throw new v(Si);return ie.toString(this.m_newValues.h[t])},getValueName:function(t){var e=this.getFieldIdxFromName(t);return ie.toString(this.m_newValues.h[e])},isValueChangedPos:function(t){if(!(1<=t&&t<=this.m_nFields))throw new v(Si);return this.m_changedFields.contains(t)},isValueChangedName:function(t){var e=this.getFieldIdxFromName(t);return this.m_changedFields.contains(e)},getFieldNameOrNullFromIdx:function(t){return null!=this.m_fields?this.m_fields.h[t]:null},getFieldIdxFromName:function(t){if(null==this.m_fields)throw new Me(vi);var e=he(this.m_fields,t);if(null==e)throw new v(yi);return e},toString:function(){var t="";t="[";for(var e=this.m_newValues,s=e.keys();s.hasNext();){var i=s.next(),n=e.get(i),r=this.getFieldNameOrNullFromIdx(i),a=null!=r?r:null==i?"null":""+i,o=l.string(n);i>1&&(t+=","),t+=null==a?"null":""+a,t+=":",t+=null==o?"null":""+o}return t+="]"},__class__:Jt});var $t=function(t,e){this.s_m=1,this.keyName=t,this.item=e,this.lock=e.lock};$t.__name__=!0,$t.__interfaces__=[jt],$t.prototype={finalize:function(){this.currKeyValues=null,this.item.unrelate(this.keyName)},evtUpdate:function(t,e){switch(this.traceEvent("update"),this.s_m){case 1:this.isDelete(t)?(this.doLightDelete(t,e),this.finalize(),this.goto(3)):(this.doFirstUpdate(t,e),this.goto(2));break;case 2:this.isDelete(t)?(this.doDelete(t,e),this.finalize(),this.goto(3)):(this.doUpdate(t,e),this.goto(2))}},evtDispose:function(){switch(this.traceEvent("dispose"),this.s_m){case 1:case 2:this.finalize(),this.goto(3)}},evtSetRequestedMaxFrequency:function(){},getCommandValue:function(t){return null!=this.currKeyValues?ie.toString(this.currKeyValues.h[t]):null},doFirstUpdate:function(t,e){var s=Pe.sure(this.item.subscription.fetch_nFields()),i=this.item.subscription.getCommandPosition();this.currKeyValues=t,this.currKeyValues.h[i]=se.StringVal("ADD");var n=new je(new o(1,s+1));this.fireOnItemUpdate(new Jt(this.item.itemIdx,this.item.subscription,this.currKeyValues,n,e,new Ps))},doUpdate:function(t,e){var s=this.item.subscription.getCommandPosition(),i=this.currKeyValues;this.currKeyValues=t,this.currKeyValues.h[s]=se.StringVal("UPDATE");var n=re(i,this.currKeyValues);this.fireOnItemUpdate(new Jt(this.item.itemIdx,this.item.subscription,this.currKeyValues,n,e,new Ps))},doLightDelete:function(t,e){this.currKeyValues=null;var s=new je(t.keys()),i=new Jt(this.item.itemIdx,this.item.subscription,this.nullify(t),s,e,new Ps);this.item.unrelate(this.keyName),this.fireOnItemUpdate(i)},doDelete:function(t,e){this.currKeyValues=null;var s=new je(t.keys()).subtracting([this.item.subscription.getKeyPosition()]),i=new Jt(this.item.itemIdx,this.item.subscription,this.nullify(t),s,e,new Ps);this.item.unrelate(this.keyName),this.fireOnItemUpdate(i)},nullify:function(t){for(var e=new Ps,s=t,i=s.keys();i.hasNext();){var n=i.next(),r=s.get(n),a=n==this.item.subscription.getCommandPosition()||n==this.item.subscription.getKeyPosition();e.h[n]=a?r:null}return e},isDelete:function(t){var e=this.item.subscription.getCommandPosition();return"DELETE"==ie.toString(t.h[e])},fireOnItemUpdate:function(t){this.item.subscription.fireOnItemUpdate(t,this.item.m_subId)},goto:function(t){this.s_m=t,this.traceEvent("goto")},traceEvent:function(t){if(ai.isTraceEnabled()){var e=this.item.m_subId,s=this.item.itemIdx;ai.isTraceEnabled()&&ai.trace("sub#key#"+t+"("+e+":"+s+":"+this.keyName+") in "+this.s_m)}},__class__:$t};var te=function(t,e){this.s_m=1,this.keyName=t,this.item=e,this.lock=e.lock};te.__name__=!0,te.__interfaces__=[jt],te.prototype={finalize:function(){this.currKeyValues=null,this.currKey2Values=null,this.item.unrelate(this.keyName)},evtUpdate:function(t,e){switch(this.traceEvent("update"),this.s_m){case 1:if(this.isDelete(t))this.doLightDelete(t,e),this.finalize(),this.goto(11),this.genOnRealMaxFrequency2LevelRemoved();else{var s=this.create2LevelSubscription();null!=s?(this.doFirstUpdate(t,e),this.subscription2Level=s,this.goto(4),this.item.strategy.client.subscribeExt(s,!0)):(this.doFirstUpdate(t,e),this.notify2LevelIllegalArgument(),this.goto(3))}break;case 3:this.isDelete(t)?(this.doDelete1LevelOnly(t,e),this.finalize(),this.goto(11),this.genOnRealMaxFrequency2LevelRemoved()):(this.doUpdate(t,e),this.goto(3));break;case 4:this.isDelete(t)?(this.doDelete(t,e),this.finalize(),this.goto(11),this.genOnRealMaxFrequency2LevelRemoved()):(this.doUpdate(t,e),this.goto(4));break;case 5:this.isDelete(t)?(this.doDeleteExt(t,e),this.finalize(),this.goto(11),this.genOnRealMaxFrequency2LevelRemoved()):(this.doUpdate1Level(t,e),this.goto(5))}},evtDispose:function(){switch(this.traceEvent("dispose"),this.s_m){case 1:case 2:case 3:this.finalize(),this.goto(10);break;case 4:case 5:this.doUnsubscribe(),this.finalize(),this.goto(12)}},evtOnSubscriptionError2Level:function(t,e){this.traceEvent("onSubscriptionError2Level"),4==this.s_m&&(this.notify2LevelSubscriptionError(t,e),this.goto(3))},evtUpdate2Level:function(t){switch(this.traceEvent("update2Level"),this.s_m){case 4:case 5:this.doUpdate2Level(t),this.goto(5)}},evtOnUnsubscription2Level:function(){switch(this.traceEvent("onUnsubscription2Level"),this.s_m){case 4:case 5:this.doUnsetRealMaxFrequency(),this.goto(this.s_m),this.genOnRealMaxFrequency2LevelRemoved()}},evtOnItemLostUpdates2Level:function(t){switch(this.traceEvent("onItemLostUpdates2Level"),this.s_m){case 4:case 5:this.goto(this.s_m),this.notify2LevelLostUpdates(t)}},evtOnRealMaxFrequency2Level:function(t){switch(this.traceEvent("onRealMaxFrequency2Level"),this.s_m){case 4:case 5:this.doSetRealMaxFrequency(t),this.goto(this.s_m),this.genOnRealMaxFrequency2LevelAdded()}},evtSetRequestedMaxFrequency:function(){switch(this.traceEvent("setRequestedMaxFrequency"),this.s_m){case 4:case 5:this.doChangeRequestedMaxFrequency(),this.goto(this.s_m)}},getCommandValue:function(t){if(null!=(e=this.currKeyValues)&&null!=e.h[t])return ie.toString(e.h[t]);var e=this.currKey2Values,s=this.item.subscription.fetch_nFields();return null!=e&&null!=s?e.h[t-s]:null},doFirstUpdate:function(t,e){var s=this.item.subscription.getCommandPosition();this.currKeyValues=t,this.currKeyValues.h[s]=se.StringVal("ADD");var i=re(null,this.currKeyValues);this.fireOnItemUpdate(new Zt(this.item.itemIdx,this.item.subscription,this.currKeyValues,i,e,new Ps))},doUpdate:function(t,e){var s=this.item.subscription.getCommandPosition(),i=this.currKeyValues;this.currKeyValues=t,this.currKeyValues.h[s]=se.StringVal("UPDATE");var n=re(i,this.currKeyValues);this.fireOnItemUpdate(new Zt(this.item.itemIdx,this.item.subscription,this.currKeyValues,n,e,new Ps))},doUpdate2Level:function(t){var e=this.item.subscription.getCommandPosition(),s=Pe.sure(this.item.subscription.fetch_nFields()),i=Pe.sure(this.currKeyValues).copy();this.currKeyValues.h[e]=se.StringVal("UPDATE"),this.currKey2Values=ue(t);for(var n=Pe.sure(this.currKeyValues).copy(),r=(u=this.currKey2Values).keys();r.hasNext();){var a=r.next(),o=u.get(a);n.h[a+s]=null==o?null:se.StringVal(o)}var h=new je;for(ie.toString(i.h[e])!=ie.toString(this.currKeyValues.h[e])&&h.insert(e),r=(u=le(t)).keys();r.hasNext();)a=r.next(),u.get(a),h.insert(a+s);var u,l=t.isSnapshot(),c=new Ps;for(r=(u=this.currKey2Values).keys();r.hasNext();){a=r.next(),u.get(a);var d=t.getValueAsJSONPatchIfAvailable(a);null!=d&&(c.h[a+s]=d)}this.fireOnItemUpdate(new Zt(this.item.itemIdx,this.item.subscription,n,h,l,c))},doUpdate1Level:function(t,e){var s=this.item.subscription.getCommandPosition(),i=Pe.sure(this.item.subscription.fetch_nFields()),n=Pe.sure(this.currKeyValues);this.currKeyValues=t,this.currKeyValues.h[s]=se.StringVal("UPDATE");for(var r=Pe.sure(this.currKeyValues).copy(),a=Pe.sure(this.currKey2Values),o=a.keys();o.hasNext();){var h=o.next(),u=a.get(h);r.h[h+i]=null==u?null:se.StringVal(u)}for(var l=new je,c=1,d=i+1;c<d;){var _=c++;ie.toString(n.h[_])!=ie.toString(r.h[_])&&l.insert(_)}this.fireOnItemUpdate(new Zt(this.item.itemIdx,this.item.subscription,r,l,e,new Ps))},doDelete:function(t,e){var s=Pe.sure(this.item.subscription.fetch_nFields()),i=this.item.subscription.getKeyPosition(),n=this.item.subscription.getCommandPosition();this.currKeyValues=null;for(var r=new je(new o(1,s+1)).subtracting([i]),a=new Ps,h=1,u=s+1;h<u;)a.h[h++]=null;a.h[i]=se.StringVal(this.keyName),a.h[n]=se.StringVal("DELETE");var l=new Zt(this.item.itemIdx,this.item.subscription,a,r,e,new Ps);this.item.unrelate(this.keyName);var c=Pe.sure(this.subscription2Level);c.removeListener(Pe.sure(this.listener2Level)),Pe.sure(this.listener2Level).disable(),this.subscription2Level=null,this.listener2Level=null,this.item.strategy.client.unsubscribe(c),this.fireOnItemUpdate(l)},doDeleteExt:function(t,e){var s=Pe.sure(this.item.subscription.fetch_nFields()),i=this.item.subscription.getKeyPosition(),n=this.item.subscription.getCommandPosition(),r=s+h.count(Pe.sure(this.currKey2Values));this.currKeyValues=null,this.currKey2Values=null;for(var a=new je(new o(1,r+1)).subtracting([i]),u=new Ps,l=1,c=r+1;l<c;)u.h[l++]=null;u.h[i]=se.StringVal(this.keyName),u.h[n]=se.StringVal("DELETE");var d=new Zt(this.item.itemIdx,this.item.subscription,u,a,e,new Ps);this.item.unrelate(this.keyName);var _=Pe.sure(this.subscription2Level);_.removeListener(Pe.sure(this.listener2Level)),Pe.sure(this.listener2Level).disable(),this.subscription2Level=null,this.listener2Level=null,this.item.strategy.client.unsubscribe(_),this.fireOnItemUpdate(d)},doLightDelete:function(t,e){var s=Pe.sure(this.item.subscription.fetch_nFields()),i=this.item.subscription.getKeyPosition(),n=this.item.subscription.getCommandPosition();this.currKeyValues=null;for(var r=new je(new o(1,s+1)),a=new Ps,h=1,u=s+1;h<u;)a.h[h++]=null;a.h[i]=t.h[i],a.h[n]=t.h[n],this.fireOnItemUpdate(new Zt(this.item.itemIdx,this.item.subscription,a,r,e,new Ps))},doDelete1LevelOnly:function(t,e){var s=Pe.sure(this.item.subscription.fetch_nFields()),i=this.item.subscription.getKeyPosition(),n=this.item.subscription.getCommandPosition();this.currKeyValues=null;for(var r=new je(new o(1,s+1)).subtracting([i]),a=new Ps,h=1,u=s+1;h<u;)a.h[h++]=null;a.h[i]=t.h[i],a.h[n]=t.h[n],this.fireOnItemUpdate(new Zt(this.item.itemIdx,this.item.subscription,a,r,e,new Ps))},doChangeRequestedMaxFrequency:function(){Pe.sure(this.subscription2Level).setRequestedMaxFrequency(ds.toString(this.item.strategy.requestedMaxFrequency))},doSetRealMaxFrequency:function(t){this.realMaxFrequency=t},doUnsetRealMaxFrequency:function(){this.realMaxFrequency=null},genOnRealMaxFrequency2LevelAdded:function(){this.item.strategy.evtOnRealMaxFrequency2LevelAdded(this.realMaxFrequency)},genOnRealMaxFrequency2LevelRemoved:function(){this.item.strategy.evtOnRealMaxFrequency2LevelRemoved()},doUnsubscribe:function(){if(null==this.subscription2Level)throw new Me("Assertion failure: subscription2Level != null");if(null==this.listener2Level)throw new Me("Assertion failure: listener2Level != null");var t=this.subscription2Level;t.removeListener(this.listener2Level),this.listener2Level.disable(),this.subscription2Level=null,this.listener2Level=null,this.item.strategy.client.unsubscribe(t)},notify2LevelIllegalArgument:function(){this.listener2Level=null,this.subscription2Level=null,this.item.subscription.fireOnSubscriptionError2Level(this.keyName,14,"The received key value is not a valid name for an Item",this.item.m_subId,this.item.itemIdx)},notify2LevelSubscriptionError:function(t,e){this.listener2Level=null,this.subscription2Level=null,this.item.subscription.fireOnSubscriptionError2Level(this.keyName,t,e,this.item.m_subId,this.item.itemIdx)},notify2LevelLostUpdates:function(t){this.item.subscription.fireOnLostUpdates2Level(this.keyName,t,this.item.m_subId,this.item.itemIdx)},fireOnItemUpdate:function(t){this.item.subscription.fireOnItemUpdate(t,this.item.m_subId)},create2LevelSubscription:function(){this.listener2Level=new ee(this);var t=this.item.subscription,e=new D("MERGE",null,null),s=[this.keyName];if(!gs.allValidNames(s))return null;e.setItems(s.slice());var i=t.getCommandSecondLevelFields();return null!=i?e.setFields(i):e.setFieldSchema(t.getCommandSecondLevelFieldSchema()),e.setDataAdapter(t.getCommandSecondLevelDataAdapter()),e.setRequestedSnapshot(ls.toString(us.SnpYes)),e.setRequestedMaxFrequency(ds.toString(this.item.strategy.requestedMaxFrequency)),e.addListener(Pe.sure(this.listener2Level)),e.setInternal(),e},isDelete:function(t){var e=this.item.subscription.getCommandPosition();return"DELETE"==ie.toString(t.h[e])},goto:function(t){this.s_m=t,this.traceEvent("goto")},traceEvent:function(t){if(ai.isTraceEnabled()){var e=this.item.m_subId,s=this.item.itemIdx;ai.isTraceEnabled()&&ai.trace("sub#key#"+t+"("+e+":"+s+":"+this.keyName+") in "+this.s_m)}},__class__:te};var ee=function(t){this.m_disabled=!1,this.key=t};ee.__name__=!0,ee.__interfaces__=[C],ee.prototype={disable:function(){var t=this;this.key.lock.synchronized((function(){return t.m_disabled=!0}))},synchronized:function(t){var e=this;this.key.lock.synchronized((function(){e.m_disabled||t()}))},onSubscriptionError:function(t,e){var s=this;this.synchronized((function(){s.key.evtOnSubscriptionError2Level(t,e)}))},onItemUpdate:function(t){var e=this;this.synchronized((function(){e.key.evtUpdate2Level(t)}))},onItemLostUpdates:function(t,e,s){var i=this;this.synchronized((function(){i.key.evtOnItemLostUpdates2Level(s)}))},onRealMaxFrequency:function(t){var e=this;this.synchronized((function(){var s,i=e.key;if(null==t)s=null;else if(null==t){var n=parseFloat(t);s=isNaN(n)?null:_s.RFreqLimited(n)}else"unlimited"==t?s=_s.RFreqUnlimited:(n=parseFloat(t),s=isNaN(n)?null:_s.RFreqLimited(n));i.evtOnRealMaxFrequency2Level(s)}))},onUnsubscription:function(){var t=this;this.synchronized((function(){t.key.evtOnUnsubscription2Level()}))},onClearSnapshot:function(t,e){},onCommandSecondLevelItemLostUpdates:function(t,e){},onCommandSecondLevelSubscriptionError:function(t,e,s){},onEndOfSnapshot:function(t,e){},onListenEnd:function(t){},onListenStart:function(t){},onSubscription:function(){},__class__:ee};var se=i["com.lightstreamer.client.internal.update.CurrFieldVal"]={__ename__:!0,__constructs__:null,StringVal:(e=function(t){return{_hx_index:0,string:t,__enum__:"com.lightstreamer.client.internal.update.CurrFieldVal",toString:s}},e._hx_name="StringVal",e.__params__=["string"],e),JsonVal:(e=function(t){return{_hx_index:1,json:t,__enum__:"com.lightstreamer.client.internal.update.CurrFieldVal",toString:s}},e._hx_name="JsonVal",e.__params__=["json"],e)};se.__constructs__=[se.StringVal,se.JsonVal];var ie=function(){};function ne(t,e){if(null!=t){for(var s=new Ps,i=(y=e).keys();i.hasNext();){var n=i.next();switch((b=y.get(n))._hx_index){case 0:s.h[n]=t.h[n];break;case 1:var r=b.val;s.h[n]=null==r?null:se.StringVal(r);break;case 2:var a=b.patch,o=t.h[n];if(null==o)throw new Me("Cannot apply the JSON patch to the field "+n+" because the field is null");switch(o._hx_index){case 0:var h=o.string,u=null;try{u=Rs._new(h)}catch(t){var l=g.caught(t);throw oi.isErrorEnabled()&&oi.error(l.get_message()+"\n"+l.details()),new Me("Cannot convert the field "+n+" to JSON")}try{var c=se.JsonVal(Rs.apply(Pe.sure(u),a));s.h[n]=c}catch(t){var d=g.caught(t);throw oi.isErrorEnabled()&&oi.error(d.get_message()+"\n"+d.details()),new Me("Cannot apply the JSON Patch to the field "+n)}break;case 1:var _=o.json;try{var p=se.JsonVal(Rs.apply(_,a));s.h[n]=p}catch(t){var f=g.caught(t);throw oi.isErrorEnabled()&&oi.error(f.get_message()+"\n"+f.details()),new Me("Cannot apply the JSON Patch to the field "+n)}}break;case 3:var m=b.patch,v=t.h[n];if(null==v)throw new Me("Cannot apply the TLCP-diff to the field "+n+" because the field is null");switch(v._hx_index){case 0:var S=se.StringVal(new Ts(v.string,m).decode());s.h[n]=S;break;case 1:throw new Me("Cannot apply the TLCP-diff to the field "+n+" because the field is JSON")}}}return s}var y;for(s=new Ps,i=(y=e).keys();i.hasNext();){var b;switch(n=i.next(),(b=y.get(n))._hx_index){case 0:throw new Me("Cannot set the field "+n+" because the first update is UNCHANGED");case 1:r=b.val,s.h[n]=null==r?null:se.StringVal(r);break;case 2:throw new Me("Cannot set the field "+n+" because the first update is a JSONPatch");case 3:throw new Me("Cannot set the field "+n+" because the first update is a TLCP-diff")}}return s}function re(t,e){if(null!=t){for(var s=new je,i=(r=e).keys();i.hasNext();){var n=i.next();r.get(n),ie.toString(t.h[n])!=ie.toString(e.h[n])&&s.insert(n)}return s}var r;for(s=new je,i=(r=e).keys();i.hasNext();)n=i.next(),r.get(n),s.insert(n);return s}function ae(t,e){if(null!=t){for(var s=new Ps,i=e,n=i.keys();n.hasNext();){var r=n.next(),a=i.get(r);switch(a._hx_index){case 0:var o=t.h[r];if(null!=o&&null!=o&&1==o._hx_index){var h=Rs._new("[]");s.h[r]=h}break;case 2:s.h[r]=a.patch}}return s}return new Ps}function oe(t){if(null!=t){for(var e=new Ps,s=0;s<t.length;){var i=t[s++];e.h[s-1+1]=i}return e}return null}function he(t,e){for(var s=1,i=h.count(t)+1;s<i;){var n=s++;if(t.h[n]==e)return n}return null}function ue(t){var e=new Ps;return t.forEachField((function(t,s,i){e.h[s]=i})),e}function le(t){var e=new Ps;return t.forEachChangedField((function(t,s,i){e.h[s]=i})),e}ie.__name__=!0,ie.toString=function(t){if(null==t)return null;switch(t._hx_index){case 0:return t.string;case 1:return Rs.toString(t.json)}};var ce=N.LSFirebaseMpnBuilder=function(t){var e=null==t?null:JSON.parse(t);null==e&&(e={webpush:{notification:{}}}),null==e.webpush&&(e.webpush={notification:{}}),null==e.webpush.notification&&(e.webpush.notification={}),this.obj=e};ce.__name__=!0,ce.prototype={build:function(){return this.removeNullFields(this.obj.webpush),this.removeNullFields(this.obj.webpush.notification),JSON.stringify(this.obj)},removeNullFields:function(t){for(var e=0,s=u.fields(t);e<s.length;){var i=s[e];++e,null==u.field(t,i)&&u.deleteField(t,i)}},getHeaders:function(){var t=this.obj.webpush.headers;return null==t?null:u.copy(t)},setHeaders:function(t){var e=null==t?null:De.toDynamicAccess(t);return this.obj.webpush.headers=e,this},getTitle:function(){return this.obj.webpush.notification.title},setTitle:function(t){return this.obj.webpush.notification.title=t,this},getBody:function(){return this.obj.webpush.notification.body},setBody:function(t){return this.obj.webpush.notification.body=t,this},getIcon:function(){return this.obj.webpush.notification.icon},setIcon:function(t){return this.obj.webpush.notification.icon=t,this},getData:function(){var t=this.obj.webpush.data;return null==t?null:u.copy(t)},setData:function(t){var e=null==t?null:De.toDynamicAccess(t);return this.obj.webpush.data=e,this},__class__:ce};var de=function(){T.call(this)};de.__name__=!0,de.__super__=T,de.prototype=n(T.prototype,{addListenerAndFireOnListenStart:function(t){this.addListener(t)&&this.dispatchToOne(t,(function(t){null!=t.onListenStart&&t.onListenStart()}))},removeListenerAndFireOnListenEnd:function(t){this.removeListener(t)&&this.dispatchToOne(t,(function(t){null!=t.onListenEnd&&t.onListenEnd()}))},onRegistered:function(){this.dispatchToAll((function(t){null!=t.onRegistered&&t.onRegistered()}))},onSuspended:function(){this.dispatchToAll((function(t){null!=t.onSuspended&&t.onSuspended()}))},onResumed:function(){this.dispatchToAll((function(t){null!=t.onResumed&&t.onResumed()}))},onStatusChanged:function(t,e){this.dispatchToAll((function(s){null!=s.onStatusChanged&&s.onStatusChanged(t,e)}))},onRegistrationFailed:function(t,e){this.dispatchToAll((function(s){null!=s.onRegistrationFailed&&s.onRegistrationFailed(t,e)}))},onSubscriptionsUpdated:function(){this.dispatchToAll((function(t){null!=t.onSubscriptionsUpdated&&t.onSubscriptionsUpdated()}))},__class__:de});var _e=N.LSMpnDevice=function(t,e,s){if(this.lock=new A,this.statusTs=0,this.status="UNKNOWN",this.eventDispatcher=new de,null==t)throw new v("Please specify a valid device token");if(null==e)throw new v("Please specify a valid application ID");var i;switch(this.deviceToken=t,this.applicationId=e,s){case"Apple":i="Apple";break;case"Google":i="Google";break;default:throw new v("Please specify a valid platform: Google or Apple")}this.platform=i;var n=f.getLocalStorage();if(null!=n){var r=n.getItem("com.lightstreamer.mpn.device_token");null!=r?_i.isDebugEnabled()&&_i.debug("Previous registration ID found ("+r+")"):_i.isDebugEnabled()&&_i.debug("No previous registration ID found"),_i.isDebugEnabled()&&_i.debug("Registration ID obtained ("+t+"), storing..."),n.setItem("com.lightstreamer.mpn.device_token",t),_i.isDebugEnabled()&&_i.debug("Registration ID stored"),this.prevDeviceToken=r}else _i.isErrorEnabled()&&_i.error("Local storage not available"),this.prevDeviceToken=null};_e.__name__=!0,_e.prototype={addListener:function(t){this.eventDispatcher.addListenerAndFireOnListenStart(t)},removeListener:function(t){this.eventDispatcher.removeListenerAndFireOnListenEnd(t)},getListeners:function(){return this.eventDispatcher.getListeners().slice()},isRegistered:function(){return"REGISTERED"==this.status},isSuspended:function(){return"SUSPENDED"==this.status},getStatus:function(){return this.status},getStatusTimestamp:function(){return this.statusTs},getPlatform:function(){return this.platform},getApplicationId:function(){return this.applicationId},getDeviceToken:function(){return this.deviceToken},getPreviousDeviceToken:function(){return this.prevDeviceToken},getDeviceId:function(){return this.deviceId},setDeviceId:function(t,e){var s=this;this.lock.synchronized((function(){return s.deviceId=t,s.adapterName=e}))},onRegistered:function(t){var e=this;this.lock.synchronized((function(){_i.isInfoEnabled()&&_i.info("MPN device registered: "+e.deviceId+")"),e.status="REGISTERED",e.statusTs=t,e.eventDispatcher.onStatusChanged("REGISTERED",t),e.eventDispatcher.onRegistered()}))},onSuspend:function(t){var e=this;this.lock.synchronized((function(){_i.isInfoEnabled()&&_i.info("MPN device suspended: "+e.deviceId),e.status="SUSPENDED",e.statusTs=t,e.eventDispatcher.onStatusChanged("SUSPENDED",t),e.eventDispatcher.onSuspended()}))},onResume:function(t){var e=this;this.lock.synchronized((function(){_i.isInfoEnabled()&&_i.info("MPN device resumed: "+e.deviceId),e.status="REGISTERED",e.statusTs=t,e.eventDispatcher.onStatusChanged("REGISTERED",t),e.eventDispatcher.onResumed()}))},onError:function(t,e){var s=this;this.lock.synchronized((function(){_i.isWarnEnabled()&&_i.warn("MPN device error: "+t+" - "+e+" "+s.deviceId),s.status="UNKNOWN",s.statusTs=0,s.deviceId=null,s.adapterName=null,s.eventDispatcher.onRegistrationFailed(t,e),s.eventDispatcher.onStatusChanged("UNKNOWN",0)}))},onReset:function(){var t=this;this.lock.synchronized((function(){_i.isInfoEnabled()&&_i.info("MPN device NOT registered");var e=t.status;t.status="UNKNOWN",t.statusTs=0,t.deviceId=null,t.adapterName=null,"UNKNOWN"!=e&&t.eventDispatcher.onStatusChanged("UNKNOWN",0)}))},fireOnSubscriptionsUpdated:function(){var t=this;this.lock.synchronized((function(){_i.isInfoEnabled()&&_i.info("MPN subscriptions have been updated: "+t.deviceId),t.eventDispatcher.onSubscriptionsUpdated()}))},fireOnBadgeResetFailed:function(t,e){var s=this;this.lock.synchronized((function(){_i.isWarnEnabled()&&_i.warn("MPN badge reset failed: "+t+" - "+e+" "+s.deviceId)}))},fireOnBadgeReset:function(){var t=this;this.lock.synchronized((function(){_i.isInfoEnabled()&&_i.info("MPN badge successfully reset: "+t.deviceId)}))},toString:function(){var t=Ce._new();return Ce.set(t,"platform",this.platform),Ce.set(t,"applicationId",this.applicationId),Ce.set(t,"deviceToken",this.deviceToken),Ce.set(t,"prevDeviceToken",this.prevDeviceToken),ks.stringify(t.h)},__class__:_e};var pe=i["com.lightstreamer.client.mpn.MpnSubscriptionStatus"]={__ename__:!0,__constructs__:null,Unknown:{_hx_name:"Unknown",_hx_index:0,__enum__:"com.lightstreamer.client.mpn.MpnSubscriptionStatus",toString:s},Active:{_hx_name:"Active",_hx_index:1,__enum__:"com.lightstreamer.client.mpn.MpnSubscriptionStatus",toString:s},Subscribed:{_hx_name:"Subscribed",_hx_index:2,__enum__:"com.lightstreamer.client.mpn.MpnSubscriptionStatus",toString:s},Triggered:{_hx_name:"Triggered",_hx_index:3,__enum__:"com.lightstreamer.client.mpn.MpnSubscriptionStatus",toString:s}};pe.__constructs__=[pe.Unknown,pe.Active,pe.Subscribed,pe.Triggered];var fe=function(){T.call(this)};fe.__name__=!0,fe.__super__=T,fe.prototype=n(T.prototype,{addListenerAndFireOnListenStart:function(t){this.addListener(t)&&this.dispatchToOne(t,(function(t){null!=t.onListenStart&&t.onListenStart()}))},removeListenerAndFireOnListenEnd:function(t){this.removeListener(t)&&this.dispatchToOne(t,(function(t){null!=t.onListenEnd&&t.onListenEnd()}))},onSubscription:function(){this.dispatchToAll((function(t){null!=t.onSubscription&&t.onSubscription()}))},onUnsubscription:function(){this.dispatchToAll((function(t){null!=t.onUnsubscription&&t.onUnsubscription()}))},onSubscriptionError:function(t,e){this.dispatchToAll((function(s){null!=s.onSubscriptionError&&s.onSubscriptionError(t,e)}))},onUnsubscriptionError:function(t,e){this.dispatchToAll((function(s){null!=s.onUnsubscriptionError&&s.onUnsubscriptionError(t,e)}))},onTriggered:function(){this.dispatchToAll((function(t){null!=t.onTriggered&&t.onTriggered()}))},onStatusChanged:function(t,e){this.dispatchToAll((function(s){null!=s.onStatusChanged&&s.onStatusChanged(t,e)}))},onPropertyChanged:function(t){this.dispatchToAll((function(e){null!=e.onPropertyChanged&&e.onPropertyChanged(t)}))},onModificationError:function(t,e,s){this.dispatchToAll((function(i){null!=i.onModificationError&&i.onModificationError(t,e,s)}))},__class__:fe});var me=N.LSMpnSubscription=function(t,e,s,i){if(this.lock=new A,this.m_status=pe.Unknown,this.m_statusTs=0,this.eventDispatcher=new fe,this.wrapper=i,"string"==typeof t)this.mode=ve.fromString(t),this.madeByServer=!1,this.initItemsAndFields("string"==typeof e?[e].slice():e,s);else if(t instanceof D){var n=t;this.mode=ve.fromString(n.getMode()),this.madeByServer=!1,this.initFromSubscription(n)}else{if(!(t instanceof me))throw this.mode="MERGE",this.madeByServer=!1,new v("Wrong arguments for MpnSubscription constructor");var r=t;this.mode=r.mode,this.madeByServer=!1,this.initFromMpnSubscription(r)}};me.__name__=!0,me.prototype={reInit:function(t){this.m_mpnSubId=t,this.madeByServer=!0},initFromSubscription:function(t){var e=t.getItems(),s=t.getFields();this.items=null!=e?gs.fromArray(Oe.copy(e,e)):null,this.group=Ss.fromString(t.getItemGroup()),this.fields=null!=s?vs.fromArray(Oe.copy(s,s)):null,this.schema=Ss.fromString(t.getFieldSchema()),this.dataAdapter=Ss.fromString(t.getDataAdapter()),this.bufferSize=hs.fromString(t.getRequestedBufferSize()),this.requestedMaxFrequency=ye.fromString(t.getRequestedMaxFrequency())},initFromMpnSubscription:function(t){this.items=t.items,this.group=t.group,this.fields=t.fields,this.schema=t.schema,this.dataAdapter=t.dataAdapter,this.bufferSize=t.bufferSize,this.requestedMaxFrequency=t.requestedMaxFrequency,this.requestedFormat=t.requestedFormat,this.requestedTrigger=t.requestedTrigger},initItemsAndFields:function(t,e){if(null!=t){if(null==e)throw new v("Please specify a valid field list");this.items=gs.fromArray(Oe.copy(t,t)),this.fields=vs.fromArray(Oe.copy(e,e))}else if(null!=e)throw new v("Please specify a valid item or item list")},addListener:function(t){this.eventDispatcher.addListenerAndFireOnListenStart(t)},removeListener:function(t){this.eventDispatcher.removeListenerAndFireOnListenEnd(t)},getListeners:function(){return this.eventDispatcher.getListeners().slice()},getMode:function(){return this.mode},getTriggerExpression:function(){return this.requestedTrigger},setTriggerExpression:function(t){var e,s=this;this.lock.synchronized((function(){return s.requestedTrigger=null==t?null:t,e=s.m_manager})),null!=e&&e.evtExtMpnSetTrigger()},getActualTriggerExpression:function(){return this.realTrigger},getNotificationFormat:function(){return this.requestedFormat},setNotificationFormat:function(t){var e,s=this;this.lock.synchronized((function(){return s.requestedFormat=null==t?null:t,e=s.m_manager})),null!=e&&e.evtExtMpnSetFormat()},getActualNotificationFormat:function(){return this.realFormat},getDataAdapter:function(){return this.dataAdapter},setDataAdapter:function(t){this.checkActive(),this.dataAdapter=Ss.fromString(t)},getFields:function(){return null==this.fields?null:this.fields.slice()},setFields:function(t){this.checkActive(),this.fields=vs.fromArray(null==t?null:Oe.copy(t,t)),this.schema=null},getFieldSchema:function(){return this.schema},setFieldSchema:function(t){this.checkActive(),this.schema=Ss.fromString(t),this.fields=null},getItems:function(){return null==this.items?null:this.items.slice()},setItems:function(t){this.checkActive(),this.items=gs.fromArray(null==t?null:Oe.copy(t,t)),this.group=null},getItemGroup:function(){return this.group},setItemGroup:function(t){this.checkActive(),this.group=Ss.fromString(t),this.items=null},getRequestedBufferSize:function(){return hs.toString(this.bufferSize)},setRequestedBufferSize:function(t){null!=t&&(t=null==t?"null":""+t),this.checkActive(),this.bufferSize=hs.fromString(t)},getRequestedMaxFrequency:function(){return ye.toString(this.requestedMaxFrequency)},setRequestedMaxFrequency:function(t){null!=t&&(t=null==t?"null":""+t),this.checkActive(),this.requestedMaxFrequency=ye.fromString(t)},isActive:function(){return this.m_status!=pe.Unknown},isSubscribed:function(){return this.m_status==pe.Subscribed},isTriggered:function(){return this.m_status==pe.Triggered},getStatus:function(){switch(this.m_status._hx_index){case 0:return"UNKNOWN";case 1:return"ACTIVE";case 2:return"SUBSCRIBED";case 3:return"TRIGGERED"}},getStatusTimestamp:function(){return this.m_statusTs},getSubscriptionId:function(){return this.m_mpnSubId},checkActive:function(){if(this.isActive())throw new Me("Cannot modify an active MpnSubscription. Please unsubscribe before applying any change")},setSubscriptionId:function(t){this.m_mpnSubId=t},changeStatus:function(t,e){var s=null==e?this.m_statusTs:Lt(e);t!=this.m_status&&(this.m_status=t,this.eventDispatcher.onStatusChanged(this.getStatus(),s))},changeStatusTs:function(t){if(null!=t){var e=Lt(t);e!=this.m_statusTs&&(this.m_statusTs=e,this.fireOnPropertyChange("status_timestamp"))}},changeMode:function(t){if(null!=t){var e=ve.fromString(t);this.mode!=e&&(this.mode=e,this.fireOnPropertyChange("mode"))}},changeGroup:function(t){null!=t&&this.group!=t&&(this.group=t,this.items=null,this.fireOnPropertyChange("group"))},changeSchema:function(t){null!=t&&this.schema!=t&&(this.schema=t,this.fields=null,this.fireOnPropertyChange("schema"))},changeAdapter:function(t){this.dataAdapter!=t&&(this.dataAdapter=null!=t?t:null,this.fireOnPropertyChange("adapter"))},changeFormat:function(t){null!=t&&t!=this.realFormat&&(this.realFormat=t,this.fireOnPropertyChange("notification_format"))},changeTrigger:function(t){t!=this.realTrigger&&(this.realTrigger=null!=t?t:null,this.fireOnPropertyChange("trigger"))},changeBufferSize:function(t){var e=hs.fromString(t);hs.extEquals(this.bufferSize,e)||(this.bufferSize=e,this.fireOnPropertyChange("requested_buffer_size"))},changeMaxFrequency:function(t){var e=ye.fromString(t);ye.extEquals(e,this.requestedMaxFrequency)||(this.requestedMaxFrequency=e,this.fireOnPropertyChange("requested_max_frequency"))},reset:function(){this.realFormat=null,this.realTrigger=null,this.m_statusTs=0,this.m_mpnSubId=null},fireOnSubscription:function(){pi.isInfoEnabled()&&pi.info((this.madeByServer?"Server ":"")+"MPNSubscription subscribed: pnSubId: "+this.m_mpnSubId),this.eventDispatcher.onSubscription()},fireOnUnsubscription:function(){pi.isInfoEnabled()&&pi.info((this.madeByServer?"Server ":"")+"MPNSubscription unsubscribed: pnSubId: "+this.m_mpnSubId),this.eventDispatcher.onUnsubscription()},fireOnTriggered:function(){pi.isInfoEnabled()&&pi.info((this.madeByServer?"Server ":"")+"MPNSubscription triggered: pnSubId: "+this.m_mpnSubId),this.eventDispatcher.onTriggered()},fireOnSubscriptionError:function(t,e){pi.isWarnEnabled()&&pi.warn((this.madeByServer?"Server ":"")+"MPNSubscription error: "+t+" - "+e+" pnSubId: "+this.m_mpnSubId),this.eventDispatcher.onSubscriptionError(t,e)},fireOnUnsubscriptionError:function(t,e){pi.isWarnEnabled()&&pi.warn((this.madeByServer?"Server ":"")+"MPNSubscription unsubscription error: "+t+" - "+e+" pnSubId: "+this.m_mpnSubId),this.eventDispatcher.onUnsubscriptionError(t,e)},fireOnModificationError:function(t,e,s){pi.isWarnEnabled()&&pi.warn((this.madeByServer?"Server ":"")+"MPNSubscription "+s+" modification error: "+t+" - "+e+" pnSubId: "+this.m_mpnSubId),this.eventDispatcher.onModificationError(t,e,s)},fireOnPropertyChange:function(t){if(pi.isInfoEnabled()){var e;switch(t){case"adapter":e="newValue: "+this.dataAdapter;break;case"group":e="newValue: "+this.group;break;case"mode":e="newValue: "+this.mode;break;case"notification_format":e="newValue: "+this.realFormat;break;case"requested_buffer_size":e="newValue: "+hs.toString(this.bufferSize);break;case"requested_max_frequency":e="newValue: "+ye.toString(this.requestedMaxFrequency);break;case"schema":e="newValue: "+this.schema;break;case"status_timestamp":default:e="";break;case"trigger":e="newValue: "+this.realTrigger}"status_timestamp"!=t&&pi.isInfoEnabled()&&pi.info((this.madeByServer?"Server ":"")+"MPNSubscription "+t+" changed: "+e+" pnSubId: "+(null!=this.m_mpnSubId?this.m_mpnSubId:"n.a."))}this.eventDispatcher.onPropertyChanged(t)},fetch_subManager:function(){return this.m_manager},fetch_status:function(){return this.m_status},fetch_madeByServer:function(){return this.madeByServer},fetch_mpnSubId:function(){return this.m_mpnSubId},fetch_requestedBufferSize:function(){return this.bufferSize},fetch_mode:function(){return this.mode},fetch_requestedMaxFrequency:function(){return this.requestedMaxFrequency},fetch_requestedFormat:function(){return this.requestedFormat},fetch_requestedTrigger:function(){return this.requestedTrigger},relate:function(t){this.m_manager=t},unrelate:function(t){t==this.m_manager&&(this.m_manager=null)},toString:function(){var t=Ce._new();return Ce.set(t,"mode",this.mode),Ce.set(t,"items",null!=this.items?l.string(this.items):this.group),Ce.set(t,"fields",null!=this.fields?l.string(this.fields):this.schema),Ce.set(t,"dataAdapter",this.dataAdapter),Ce.set(t,"requestedBufferSize",this.bufferSize),Ce.set(t,"requestedMaxFrequency",this.requestedMaxFrequency),Ce.set(t,"trigger",this.requestedTrigger),Ce.set(t,"notificationFormat",this.requestedFormat),ks.stringify(t.h)},__class__:me};var ge=N.LSSafariMpnBuilder=function(t){var e=null==t?null:JSON.parse(t);null==e&&(e={aps:{alert:{}}}),null==e.aps&&(e.aps={alert:{}}),null==e.aps.alert&&(e.aps.alert={}),this.obj=e};ge.__name__=!0,ge.prototype={build:function(){return this.removeNullFields(this.obj.aps),this.removeNullFields(this.obj.aps.alert),JSON.stringify(this.obj)},removeNullFields:function(t){for(var e=0,s=u.fields(t);e<s.length;){var i=s[e];++e,null==u.field(t,i)&&u.deleteField(t,i)}},getTitle:function(){return this.obj.aps.alert.title},setTitle:function(t){return this.obj.aps.alert.title=t,this},getBody:function(){return this.obj.aps.alert.body},setBody:function(t){return this.obj.aps.alert.body=t,this},getAction:function(){return this.obj.aps.alert.action},setAction:function(t){return this.obj.aps.alert.action=t,this},getUrlArguments:function(){var t=u.field(this.obj.aps,"url-args");return null==t?null:t.slice()},setUrlArguments:function(t){return this.obj.aps["url-args"]=null==t?null:t.slice(),this},__class__:ge};var ve={fromString:function(t){switch(t){case"DISTINCT":return"DISTINCT";case"MERGE":return"MERGE";default:throw new v("The given value is not a valid subscription mode. Admitted values are MERGE, DISTINCT")}}},Se=i["com.lightstreamer.client.mpn.MpnRequestedMaxFrequency"]={__ename__:!0,__constructs__:null,FreqLimited:(e=function(t){return{_hx_index:0,max:t,__enum__:"com.lightstreamer.client.mpn.MpnRequestedMaxFrequency",toString:s}},e._hx_name="FreqLimited",e.__params__=["max"],e),FreqUnlimited:{_hx_name:"FreqUnlimited",_hx_index:1,__enum__:"com.lightstreamer.client.mpn.MpnRequestedMaxFrequency",toString:s}};Se.__constructs__=[Se.FreqLimited,Se.FreqUnlimited];var ye=function(){};function be(t){t.splice(0,t.length)}ye.__name__=!0,ye.fromString=function(t){if(null==t)return null;var e;if("unlimited"==t.toLowerCase())return Se.FreqUnlimited;if(e=parseFloat(t),!isNaN(e)&&e>0)return Se.FreqLimited(e);throw new v("The given value is not valid for this setting; use null, 'unlimited' or a positive number instead")},ye.toString=function(t){if(null==t)return null;switch(t._hx_index){case 0:var e=t.max;return null==e?"null":""+e;case 1:return"unlimited"}},ye.extEquals=function(t,e){return null==t?null==e:null!=e&&_.enumEq(t,e)};var Ee=function(){};Ee.__name__=!0,Ee.prototype={submit:function(t){wi(t)},schedule:function(t,e){return new we(bi(t,e))},stop:function(){},__class__:Ee};var we=function(t){this.handle=t};we.__name__=!0,we.prototype={isCanceled:function(){return null==this.handle},cancel:function(){null!=this.handle&&(Ei(this.handle),this.handle=null)},__class__:we};var Te=function(){this.hasMicroTasks=void 0!==t.queueMicrotask,this.hasWorkers="undefined"!=typeof Worker};Te.__name__=!0,Te.prototype={toString:function(){return"{ hasWorkers: "+l.string(this.hasWorkers)+", hasMicroTasks: "+l.string(this.hasMicroTasks)+" }"},__class__:Te};var Re=function(){};Re.__name__=!0,Re.__isInterface__=!0,Re.prototype={__class__:Re};var Ie=function(t,e,s,i,n,r,a){this.isCanceled=!1,this.reader=new Qe;var o=this;if(ni.isDebugEnabled()&&ni.debug("HTTP sending: "+t+" "+e+" headers("+(null==s?"null":ks.stringify(s.h))+")"),this.xhr=new XMLHttpRequest,this.xhr.open("POST",t),this.xhr.withCredentials=i,null!=s)for(var h=s.h,u=Object.keys(h),l=u.length,c=0;c<l;){var d=u[c++];this.xhr.setRequestHeader(d,h[d])}this.xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),this.xhr.send(e),this.xhr.onreadystatechange=function(){if(!o.isCanceled){var t=o.xhr.readyState;if(2==t){var e=o.xhr.status;0==e||e>=200&&e<300||(ni.isDebugEnabled()&&ni.debug("HTTP event: error(HTTP code "+e+")"),r(o,"Unexpected HTTP code: "+e),o.xhr.abort())}else if(t>2){for(var s=3==t?o.reader.extractNewData(o.xhr.responseText,!1):o.reader.extractNewData(o.xhr.responseText,!0),i=0;i<s.length;){var h=s[i];if(++i,o.isCanceled)return;""!=h&&(ni.isDebugEnabled()&&ni.debug("HTTP event: text("+h+")"),n(o,h))}4==t&&(ni.isDebugEnabled()&&ni.debug("HTTP event: complete"),a(o))}}},this.xhr.onerror=function(){o.isCanceled||(ni.isDebugEnabled()&&ni.debug("HTTP event: error(Network error)"),r(o,"Network error"))}};Ie.__name__=!0,Ie.__interfaces__=[Re],Ie.prototype={dispose:function(){ni.isDebugEnabled()&&ni.debug("HTTP disposing"),this.isCanceled=!0,this.xhr.abort()},isDisposed:function(){return this.isCanceled},__class__:Ie};var Ce={_new:function(){return new ks},set:function(t,e,s){null!=s&&(t.h[e]=null==s?"null":l.string(s))}},xe=function(){this.values=[],this.nRemoved=0};xe.__name__=!0,xe.prototype={get_length:function(){return this.values.length-this.nRemoved},compact:function(){this.nRemoved>this.values.length/2&&(this.nRemoved=0,this.values=this.copy().values)},push:function(t){this.values.push(new Le(t))},remove:function(t){for(var e=0,s=this.values.length;e<s;){var i=e++;if(this.values[i].item==t&&this.values[i].isValid){this.nRemoved++,this.values[i].isValid=!1;break}}},filter:function(t){for(var e=new xe,s=new Ne(this);s.hasNext();){var i=s.next();t(i)&&e.values.push(new Le(i))}return e},map:function(t){for(var e=new xe,s=new Ne(this);s.hasNext();){var i=t(s.next());e.values.push(new Le(i))}return e},exists:function(t){return h.exists(this,t)},find:function(t){return h.find(this,t)},contains:function(t){return h.has(this,t)},iterator:function(){return new Ne(this)},copy:function(){for(var t=new xe,e=new Ne(this);e.hasNext();){var s=e.next();t.values.push(new Le(s))}return t},toString:function(){for(var t=0,e=this.values.length-this.nRemoved,s="[",i=new Ne(this);i.hasNext();)s+=l.string(i.next())+(t!=e-1?", ":""),++t;return s+"]"},__class__:xe};var Le=function(t){this.isValid=!0,this.item=t};Le.__name__=!0,Le.prototype={__class__:Le};var Ne=function(t){this.a=t,this.index=0};Ne.__name__=!0,Ne.prototype={hasNext:function(){for(var t=this.index,e=this.a.values.length;t<e;)if(this.a.values[t++].isValid)return!0;return!1},next:function(){for(var t=this.index,e=this.a.values.length;t<e;){var s=t++;if(this.a.values[s].isValid)return this.index=s+1,this.a.values[s].item}throw new g("No such element")},__class__:Ne};var Me=function(t,e,s){g.call(this,t,e,s),this.__skipStack++};Me.__name__=!0,Me.__super__=g,Me.prototype=n(g.prototype,{__class__:Me});var De={fromHaxeMap:function(t){return De.fromMapToDynamicAccess(t)},toHaxeMap:function(t){return De.toHaxe(t)},fromMapToDynamicAccess:function(t){for(var e={},s=t.h,i=Object.keys(s),n=i.length,r=0;r<n;){var a=i[r++];e[a]=s[a]}return e},toHaxe:function(t){for(var e=new ks,s=u.fields(t),i=0;i<s.length;){var n=s[i++];e.h[n]=t[n]}return e},toDynamicAccess:function(t){return u.copy(t)}},Oe={fromHaxeArray:function(t){return t.slice()},toHaxeArray:function(t){return Oe.copy(t,t)},_new:function(t){return t.slice()},toHaxe:function(t){return Oe.copy(t,t)},copy:function(t,e){for(var s=[],i=0,n=e.length;i<n;)s[i]=e[i],++i;return s}},Pe=function(){};Pe.__name__=!0,Pe.sure=function(t){if(null==t)throw g.thrown("null pointer in .sure() call");return t},Pe.or=function(t,e){return null==t?e:t};var ke=function(){};ke.__name__=!0,ke.__isInterface__=!0,ke.prototype={__class__:ke};var Fe=function(){this._innerMap=new Ps,this._orderedKeys=new xe};Fe.__name__=!0,Fe.__interfaces__=[ke],Fe.prototype={compact:function(){this._orderedKeys.compact()},set:function(t,e){this._innerMap.h.hasOwnProperty(t)||this._orderedKeys.values.push(new Le(t)),this._innerMap.h[t]=e},get:function(t){return this._innerMap.h[t]},exists:function(t){return this._innerMap.h.hasOwnProperty(t)},remove:function(t){var e=this._innerMap.remove(t);return e&&this._orderedKeys.remove(t),e},keys:function(){return new Ne(this._orderedKeys)},iterator:function(){return new Ae(this)},keyValueIterator:function(){return new Us(this)},copy:function(){var t=new Fe;return t._orderedKeys=this._orderedKeys.copy(),t._innerMap=this._innerMap.copy(),t},get_length:function(){var t=this._orderedKeys;return t.values.length-t.nRemoved},get_orderedKeys:function(){return this._orderedKeys},keysCopy:function(){return this._orderedKeys.copy()},clear:function(){this._orderedKeys=new xe,this._innerMap=new Ps},toString:function(){for(var t=0,e=this._orderedKeys,s=e.values.length-e.nRemoved,i="[",n=new Ne(this._orderedKeys);n.hasNext();){var r=n.next();i+=r+" => "+l.string(this._innerMap.h[r])+(t!=s-1?", ":""),++t}return i+"]"},__class__:Fe};var Ae=function(t){this.map=t,this.it=new Ne(t._orderedKeys)};Ae.__name__=!0,Ae.prototype={hasNext:function(){return this.it.hasNext()},next:function(){var t=this.map,e=this.it.next();return t._innerMap.h[e]},__class__:Ae};var qe=function(){};qe.__name__=!0,qe.__isInterface__=!0,qe.prototype={__class__:qe};var Be=function(){};Be.__name__=!0,Be.__isInterface__=!0,Be.prototype={__class__:Be};var Ue=i["com.lightstreamer.internal.ReachabilityStatus"]={__ename__:!0,__constructs__:null,RSReachable:{_hx_name:"RSReachable",_hx_index:0,__enum__:"com.lightstreamer.internal.ReachabilityStatus",toString:s},RSNotReachable:{_hx_name:"RSNotReachable",_hx_index:1,__enum__:"com.lightstreamer.internal.ReachabilityStatus",toString:s}};Ue.__constructs__=[Ue.RSReachable,Ue.RSNotReachable];var We=function(){};We.__name__=!0,We.__isInterface__=!0,We.prototype={__class__:We};var He=i["com.lightstreamer.internal.PageState"]={__ename__:!0,__constructs__:null,Frozen:{_hx_name:"Frozen",_hx_index:0,__enum__:"com.lightstreamer.internal.PageState",toString:s},Resumed:{_hx_name:"Resumed",_hx_index:1,__enum__:"com.lightstreamer.internal.PageState",toString:s}};He.__constructs__=[He.Frozen,He.Resumed];var Ve=function(){};Ve.__name__=!0,Ve.__isInterface__=!0,Ve.prototype={__class__:Ve};var ze=function(t){this.connectionOptions=t.connectionOptions};ze.__name__=!0,ze.__interfaces__=[Ve],ze.prototype={createWsClient:function(t,e,s,i,n){return new ws(t,s,i,n)},createHttpClient:function(t,e,s,i,n,r){return new Ie(t,e,s,this.connectionOptions.isCookieHandlingRequired(),i,n,r)},createCtrlClient:function(t,e,s,i,n,r){return this.createHttpClient(t,e,s,i,n,r)},createReachabilityManager:function(t){return new Ye},createTimer:function(t,e,s){return new Je(t,e,s)},randomMillis:function(t){return l.random(t)},createPageLifecycleFactory:function(t){return new P(t)},__class__:ze};var Ye=function(){};Ye.__name__=!0,Ye.__interfaces__=[We],Ye.prototype={startListening:function(t){f.get_supported()&&(window.ononline=function(){t(Ue.RSReachable)},window.onoffline=function(){t(Ue.RSNotReachable)})},stopListening:function(){f.get_supported()&&(window.ononline=null,window.onoffline=null)},__class__:Ye};var Ge=function(t,e){this.key=t,this.val=e};Ge.__name__=!0,Ge.prototype={toEncodedPair:function(){var t=this.key,e=encodeURIComponent(t)+"=";return t=this.val,e+encodeURIComponent(t)},toString:function(){return this.key+"="+this.val},__class__:Ge};var Ke=function(){this.params=[]};Ke.__name__=!0,Ke.prototype={LS_reqId:function(t){this.addParamAny("LS_reqId",t)},LS_message:function(t){this.addParamString("LS_message",t)},LS_sequence:function(t){this.addParamString("LS_sequence",t)},LS_msg_prog:function(t){this.addParamAny("LS_msg_prog",t)},LS_max_wait:function(t){this.addParamAny("LS_max_wait",t)},LS_outcome:function(t){this.addParamBool("LS_outcome",t)},LS_ack:function(t){this.addParamBool("LS_ack",t)},LS_op:function(t){this.addParamString("LS_op",t)},LS_subId:function(t){this.addParamAny("LS_subId",t)},LS_mode:function(t){this.addParamString("LS_mode",t)},LS_group:function(t){this.addParamString("LS_group",t)},LS_schema:function(t){this.addParamString("LS_schema",t)},LS_data_adapter:function(t){this.addParamString("LS_data_adapter",t)},LS_requested_max_frequency:function(t){this.addParamString("LS_requested_max_frequency",t)},LS_requested_max_frequency_Float:function(t){this.addParamAny("LS_requested_max_frequency",t)},LS_requested_buffer_size:function(t){this.addParamString("LS_requested_buffer_size",t)},LS_requested_buffer_size_Int:function(t){this.addParamAny("LS_requested_buffer_size",t)},LS_cause:function(t){this.addParamString("LS_cause",t)},LS_keepalive_millis:function(t){this.addParamAny("LS_keepalive_millis",t)},LS_inactivity_millis:function(t){this.addParamAny("LS_inactivity_millis",t)},LS_requested_max_bandwidth:function(t){this.addParamString("LS_requested_max_bandwidth",t)},LS_requested_max_bandwidth_Float:function(t){this.addParamAny("LS_requested_max_bandwidth",t)},LS_adapter_set:function(t){this.addParamString("LS_adapter_set",t)},LS_user:function(t){this.addParamString("LS_user",t)},LS_password:function(t){this.addParamString("LS_password",t)},LS_cid:function(t){this.addParamString("LS_cid",t)},LS_old_session:function(t){this.addParamString("LS_old_session",t)},LS_session:function(t){this.addParamString("LS_session",t)},LS_send_sync:function(t){this.addParamBool("LS_send_sync",t)},LS_polling:function(t){this.addParamBool("LS_polling",t)},LS_polling_millis:function(t){this.addParamAny("LS_polling_millis",t)},LS_idle_millis:function(t){this.addParamAny("LS_idle_millis",t)},LS_content_length:function(t){this.addParamAny("LS_content_length",t)},LS_ttl_millis:function(t){this.addParamString("LS_ttl_millis",t)},LS_recovery_from:function(t){this.addParamAny("LS_recovery_from",t)},LS_close_socket:function(t){this.addParamBool("LS_close_socket",t)},LS_selector:function(t){this.addParamString("LS_selector",t)},LS_snapshot:function(t){this.addParamBool("LS_snapshot",t)},LS_snapshot_Int:function(t){this.addParamAny("LS_snapshot",t)},addParamString:function(t,e){this.params.push(new Ge(t,e))},addParamAny:function(t,e){this.addParamString(t,""+(null==e?"null":l.string(e)))},addParamBool:function(t,e){this.addParamString(t,e?"true":"false")},getEncodedString:function(){for(var t=this.params,e=new Array(t.length),s=0,i=t.length;s<i;){var n=s++;e[n]=t[n].toEncodedPair()}return e.join("&")},toString:function(){return this.params.join(" ")},PN_deviceId:function(t){this.addParamString("PN_deviceId",t)},PN_notificationFormat:function(t){this.addParamString("PN_notificationFormat",t)},PN_trigger:function(t){this.addParamString("PN_trigger",t)},PN_coalescing:function(t){this.addParamBool("PN_coalescing",t)},PN_subscriptionId:function(t){this.addParamString("PN_subscriptionId",t)},PN_type:function(t){this.addParamString("PN_type",t)},PN_appId:function(t){this.addParamString("PN_appId",t)},PN_deviceToken:function(t){this.addParamString("PN_deviceToken",t)},PN_newDeviceToken:function(t){this.addParamString("PN_newDeviceToken",t)},PN_subscriptionStatus:function(t){this.addParamString("PN_subscriptionStatus",t)},__class__:Ke};var je=function(t){if(this.values=[],null!=t)for(;t.hasNext();)this.insert(t.next())};je.__name__=!0,je.prototype={count:function(){return this.values.length},insert:function(t){-1==this.values.indexOf(t)&&this.values.push(t)},contains:function(t){return-1!=this.values.indexOf(t)},remove:function(t){a.remove(this.values,t)},removeAll:function(){this.values.splice(0,this.values.length)},copy:function(){return new je(this.iterator())},union:function(t){for(var e=new je,s=0,i=this.values;s<i.length;)e.insert(i[s++]);for(s=0;s<t.length;)e.insert(t[s++]);return e},subtracting:function(t){for(var e=new je,s=0,i=this.values;s<i.length;){var n=i[s];++s,-1==t.indexOf(n)&&e.insert(n)}return e},iterator:function(){return new Bs(this.values)},toArray:function(){return this.values},__class__:je};var Qe=function(){this.progress=0};Qe.__name__=!0,Qe.prototype={extractNewData:function(t,e){var s;if(e)s=t.length;else{if((s=t.lastIndexOf("\r\n"))<0)return[];s+=2}if(s<=this.progress)return[];var i=t.substring(this.progress,s);return this.progress=s,i.split("\r\n")},streamProgress:function(t){return this.extractNewData(t,!1)},streamComplete:function(t){return this.extractNewData(t,!0)},__class__:Qe};var Xe={_new:function(t){return t},toMillis:function(t){return t},toLong:function(t){return t}},Ze={_new:function(t){return t},now:function(){return a.now()/1e3},plus:function(t,e){return 1e3*t+e},minus:function(t,e){return 1e3*(t-e)},toFloat:function(t){return t}},Je=function(t,e,s){var i=this;this.task=new we(bi((function(){s(i)}),e))};Je.__name__=!0,Je.__interfaces__=[Be],Je.prototype={cancel:function(){this.task.cancel()},isCanceled:function(){return null==this.task.handle},__class__:Je};var $e=S;function ts(){var t=Ti.shift();if(null!=t)try{t()}catch(t){var e=g.caught(t);ai.isErrorEnabled()&&ai.error("Timer callback failed\n"+e.details())}else ai.isErrorEnabled()&&ai.error("Timer callback not found")}var es=i["com.lightstreamer.internal.FieldValue"]={__ename__:!0,__constructs__:null,unchanged:{_hx_name:"unchanged",_hx_index:0,__enum__:"com.lightstreamer.internal.FieldValue",toString:s},changed:(e=function(t){return{_hx_index:1,val:t,__enum__:"com.lightstreamer.internal.FieldValue",toString:s}},e._hx_name="changed",e.__params__=["val"],e),jsonPatch:(e=function(t){return{_hx_index:2,patch:t,__enum__:"com.lightstreamer.internal.FieldValue",toString:s}},e._hx_name="jsonPatch",e.__params__=["patch"],e),diffPatch:(e=function(t){return{_hx_index:3,patch:t,__enum__:"com.lightstreamer.internal.FieldValue",toString:s}},e._hx_name="diffPatch",e.__params__=["patch"],e)};es.__constructs__=[es.unchanged,es.changed,es.jsonPatch,es.diffPatch];var ss={_new:function(t){return t},fromIntGt0:function(t){if(t<=0)throw new v("value must be greater than zero");return t},fromIntGtEq0:function(t){if(t<0)throw new v("value must be greater than or equal to zero");return t},gti:function(t,e){return t>e},gt:function(t,e){return t>e},lt:function(t,e){return t<e},plus:function(t,e){return t+e},minus:function(t,e){return t-e},toInt:function(t){return t}},is={_new:function(t){return t},fromIntGt0:function(t){if(t<=0)throw new v("value must be greater than zero");return t}},ns={fromString:function(t){if(null==t)return null;switch(t){case"HTTP":return"HTTP";case"HTTP-POLLING":return"HTTP-POLLING";case"HTTP-STREAMING":return"HTTP-STREAMING";case"WS":return"WS";case"WS-POLLING":return"WS-POLLING";case"WS-STREAMING":return"WS-STREAMING";default:throw new v("The given value is not valid. Use one of: HTTP-STREAMING, HTTP-POLLING, WS-STREAMING, WS-POLLING, WS, HTTP or null")}}},rs=i["com.lightstreamer.internal.RequestedMaxBandwidth"]={__ename__:!0,__constructs__:null,BWLimited:(e=function(t){return{_hx_index:0,bw:t,__enum__:"com.lightstreamer.internal.RequestedMaxBandwidth",toString:s}},e._hx_name="BWLimited",e.__params__=["bw"],e),BWUnlimited:{_hx_name:"BWUnlimited",_hx_index:1,__enum__:"com.lightstreamer.internal.RequestedMaxBandwidth",toString:s}};rs.__constructs__=[rs.BWLimited,rs.BWUnlimited];var as=function(){};as.__name__=!0,as.fromString=function(t){var e;if("unlimited"==t.toLowerCase())return rs.BWUnlimited;if(e=parseFloat(t),!isNaN(e)&&e>0)return rs.BWLimited(e);throw new v('The given value is a not valid value for RequestedMaxBandwidth. Use a positive number or the string "unlimited"')},as.toString=function(t){switch(t._hx_index){case 0:var e=t.bw;return null==e?"null":""+e;case 1:return"unlimited"}};var os=i["com.lightstreamer.internal.RequestedBufferSize"]={__ename__:!0,__constructs__:null,BSLimited:(e=function(t){return{_hx_index:0,size:t,__enum__:"com.lightstreamer.internal.RequestedBufferSize",toString:s}},e._hx_name="BSLimited",e.__params__=["size"],e),BSUnlimited:{_hx_name:"BSUnlimited",_hx_index:1,__enum__:"com.lightstreamer.internal.RequestedBufferSize",toString:s}};os.__constructs__=[os.BSLimited,os.BSUnlimited];var hs=function(){};hs.__name__=!0,hs.fromString=function(t){if(null==t)return null;var e;if("unlimited"==t.toLowerCase())return os.BSUnlimited;if(null!=(e=l.parseInt(t))&&e>0)return os.BSLimited(e);throw new v("The given value is not valid for this setting; use null, 'unlimited' or a positive integer instead")},hs.toString=function(t){if(null==t)return null;switch(t._hx_index){case 0:var e=t.size;return null==e?"null":""+e;case 1:return"unlimited"}},hs.extEquals=function(t,e){return null==t?null==e:null!=e&&_.enumEq(t,e)};var us=i["com.lightstreamer.internal.RequestedSnapshot"]={__ename__:!0,__constructs__:null,SnpYes:{_hx_name:"SnpYes",_hx_index:0,__enum__:"com.lightstreamer.internal.RequestedSnapshot",toString:s},SnpNo:{_hx_name:"SnpNo",_hx_index:1,__enum__:"com.lightstreamer.internal.RequestedSnapshot",toString:s},SnpLength:(e=function(t){return{_hx_index:2,len:t,__enum__:"com.lightstreamer.internal.RequestedSnapshot",toString:s}},e._hx_name="SnpLength",e.__params__=["len"],e)};us.__constructs__=[us.SnpYes,us.SnpNo,us.SnpLength];var ls=function(){};ls.__name__=!0,ls.fromString=function(t){if(null==t)return null;var e;switch(t.toLowerCase()){case"no":return us.SnpNo;case"yes":return us.SnpYes;default:if(null!=(e=l.parseInt(t))&&e>0)return us.SnpLength(e);throw new v("The given value is not valid for this setting; use null, 'yes', 'no' or a positive number instead")}},ls.toString=function(t){if(null==t)return null;switch(t._hx_index){case 0:return"yes";case 1:return"no";case 2:var e=t.len;return null==e?"null":""+e}};var cs=i["com.lightstreamer.internal.RequestedMaxFrequency"]={__ename__:!0,__constructs__:null,FreqLimited:(e=function(t){return{_hx_index:0,max:t,__enum__:"com.lightstreamer.internal.RequestedMaxFrequency",toString:s}},e._hx_name="FreqLimited",e.__params__=["max"],e),FreqUnlimited:{_hx_name:"FreqUnlimited",_hx_index:1,__enum__:"com.lightstreamer.internal.RequestedMaxFrequency",toString:s},FreqUnfiltered:{_hx_name:"FreqUnfiltered",_hx_index:2,__enum__:"com.lightstreamer.internal.RequestedMaxFrequency",toString:s}};cs.__constructs__=[cs.FreqLimited,cs.FreqUnlimited,cs.FreqUnfiltered];var ds=function(){};ds.__name__=!0,ds.fromString=function(t){if(null==t)return null;var e;switch(t.toLowerCase()){case"unfiltered":return cs.FreqUnfiltered;case"unlimited":return cs.FreqUnlimited;default:if(e=parseFloat(t),!isNaN(e)&&e>0)return cs.FreqLimited(e);throw new v("The given value is not valid for this setting; use null, 'unlimited', 'unfiltered' or a positive number instead")}},ds.toString=function(t){if(null==t)return null;switch(t._hx_index){case 0:var e=t.max;return null==e?"null":""+e;case 1:return"unlimited";case 2:return"unfiltered"}},ds.extEquals=function(t,e){return null==t?null==e:null!=e&&_.enumEq(t,e)};var _s=i["com.lightstreamer.internal.RealMaxFrequency"]={__ename__:!0,__constructs__:null,RFreqLimited:(e=function(t){return{_hx_index:0,freq:t,__enum__:"com.lightstreamer.internal.RealMaxFrequency",toString:s}},e._hx_name="RFreqLimited",e.__params__=["freq"],e),RFreqUnlimited:{_hx_name:"RFreqUnlimited",_hx_index:1,__enum__:"com.lightstreamer.internal.RealMaxFrequency",toString:s}};_s.__constructs__=[_s.RFreqLimited,_s.RFreqUnlimited];var ps=i["com.lightstreamer.internal.RealMaxBandwidth"]={__ename__:!0,__constructs__:null,BWLimited:(e=function(t){return{_hx_index:0,bw:t,__enum__:"com.lightstreamer.internal.RealMaxBandwidth",toString:s}},e._hx_name="BWLimited",e.__params__=["bw"],e),BWUnlimited:{_hx_name:"BWUnlimited",_hx_index:1,__enum__:"com.lightstreamer.internal.RealMaxBandwidth",toString:s},BWUnmanaged:{_hx_name:"BWUnmanaged",_hx_index:2,__enum__:"com.lightstreamer.internal.RealMaxBandwidth",toString:s}};ps.__constructs__=[ps.BWLimited,ps.BWUnlimited,ps.BWUnmanaged];var fs=function(){};fs.__name__=!0,fs.toString=function(t){if(null==t)return null;switch(t._hx_index){case 0:var e=t.bw;return null==e?"null":""+e;case 1:return"unlimited";case 2:return"unmanaged"}},fs.eq=function(t,e){return null==t?null==e:null!=e&&_.enumEq(t,e)};var ms={fromString:function(t){switch(t){case"COMMAND":return"COMMAND";case"DISTINCT":return"DISTINCT";case"MERGE":return"MERGE";case"RAW":return"RAW";default:throw new v("The given value is not a valid subscription mode. Admitted values are MERGE, DISTINCT, RAW, COMMAND")}}},gs={_new:function(t){return t},getPos:function(t,e){var s=t.indexOf(e);return-1!=s?s+1:-1},allValidNames:function(t){return!h.exists(t,(function(t){return new r("^$| |^\\d+$","").match(t)}))},fromArray:function(t){if(null==t)return null;if(0==t.length)throw new v("Item List is empty");if(gs.allValidNames(t))return t;throw new v("Item List is invalid")}},vs={_new:function(t){return t},getPos:function(t,e){var s=t.indexOf(e);return-1!=s?s+1:-1},hasKeyField:function(t){return-1!=t.indexOf("key")},hasCommandField:function(t){return-1!=t.indexOf("command")},fromArray:function(t){if(null==t)return null;if(0==t.length)throw new v("Field List is empty");if(h.exists(t,(function(t){return new r("^$| ","").match(t)})))throw new v("Field List is invalid");return t}},Ss={};function ys(t){if(null==t)return"null";switch(t._hx_index){case 0:return""+t.freq;case 1:return"unlimited"}}function bs(t,e){return null==t?null==e:null!=e&&_.enumEq(t,e)}Ss._new=function(t){return t},Ss.fromString=function(t){if(null==t)return null;if(""==t)throw new v("The value is empty");return t};var Es=function(t,e){var s=t.indexOf("://");-1!=s?(this._protocol=t.substring(0,s)+":",t=t.substring(s+3)):this._protocol="";var i=t.indexOf("/");-1!=i?(this._pathname=t.substring(i),t=t.substring(0,i)):this._pathname="/";var n=this.extractPortStart(t);-1!=n?(this._port=t.substring(n),this._hostname=t.substring(0,n-1)):(this._port="",this._hostname=t),null!=e&&this.set_pathname(e)};Es.__name__=!0,Es.build=function(t,e){if(null!=e){var s=d.endsWith(t,"/"),i=d.startsWith(e,"/");t+=s?i?e.substring(1):e:i?e:"/"+e}return t},Es.completeControlLink=function(t,e){var s=new Es(e),i=new Es(t);return""==i.get_protocol()&&i.set_protocol(s.get_protocol()),""==i.get_port()&&i.set_port(s.get_port()),i.get_href()},Es.prototype={get_protocol:function(){return this._protocol},set_protocol:function(t){return""==t||d.endsWith(t,":")||(t+=":"),this._protocol=t,this._protocol},get_hostname:function(){return this._hostname},set_hostname:function(t){return this._hostname=t,this._hostname},get_port:function(){return this._port},set_port:function(t){return this._port=t,this._port},get_pathname:function(){return this._pathname},set_pathname:function(t){return d.startsWith(t,"/")||(t="/"+t),this._pathname=t,this._pathname},get_href:function(){var t=this._hostname;return""!=this._protocol&&(t=this._protocol+"//"+t),""!=this._port&&(t+=":"+this._port),""!=this.get_pathname()&&(t+=this._pathname),t},toString:function(){return this.get_href()},extractPortStart:function(t){var e=t.indexOf(":");return e<=-1?-1:t.indexOf("]")>-1?(e=t.indexOf("]:"))<=-1?-1:e+2:e!=t.lastIndexOf(":")?-1:e+1},__class__:Es};var ws=function(t,e,s,i){this.isCanceled=!1;var n=this;d.startsWith(t,"https://")?t=d.replace(t,"https://","wss://"):d.startsWith(t,"http://")&&(t=d.replace(t,"http://","ws://")),ni.isDebugEnabled()&&ni.debug("WS connecting: "+t),this.ws=new WebSocket(t,$s),this.ws.onopen=function(){n.isCanceled||(ni.isDebugEnabled()&&ni.debug("WS event: open"),e(n))},this.ws.onmessage=function(t){if(!n.isCanceled)for(var e=0,i=t.data.split("\r\n");e<i.length;){var r=i[e];if(++e,n.isCanceled)return;""!=r&&(ni.isDebugEnabled()&&ni.debug("WS event: text("+r+")"),s(n,r))}},this.ws.onerror=function(){n.isCanceled||(ni.isDebugEnabled()&&ni.debug("WS event: error(Network error)"),i(n,"Network error"),n.ws.close())},this.ws.onclose=function(t){if(!n.isCanceled){var e="unexpected disconnection: "+t.code+" - "+t.reason;ni.isDebugEnabled()&&ni.debug("WS event: error("+e+")"),i(n,e),n.ws.close()}}};ws.__name__=!0,ws.__interfaces__=[qe],ws.prototype={send:function(t){ni.isDebugEnabled()&&ni.debug("WS sending: "+t),this.ws.send(t)},dispose:function(){ni.isDebugEnabled()&&ni.debug("WS disposing"),this.isCanceled=!0,this.ws.close()},isDisposed:function(){return this.isCanceled},__class__:ws};var Ts=function(t,e){this.buf=new c,this.basePos=0,this.diffPos=0,this.diff=e,this.base=t};Ts.__name__=!0,Ts.apply=function(t,e){return new Ts(t,e).decode()},Ts.prototype={decode:function(){try{for(;this.diffPos!=this.diff.length&&(this.applyCopy(),this.diffPos!=this.diff.length)&&(this.applyAdd(),this.diffPos!=this.diff.length);)this.applyDel();return this.buf.b}catch(t){throw new g("Bad TLCP-diff",g.caught(t))}},applyCopy:function(){var t=this.decodeVarint();t>0&&(this.appendToBuf(this.base,this.basePos,t),this.basePos+=t)},applyAdd:function(){var t=this.decodeVarint();t>0&&(this.appendToBuf(this.diff,this.diffPos,t),this.diffPos+=t)},applyDel:function(){var t=this.decodeVarint();t>0&&(this.basePos+=t)},decodeVarint:function(){for(var t=0;;){var e=this.charAt(this.diff,this.diffPos);if(this.diffPos+=1,e>=97&&e<123)return 26*t+(e-97);if(!(e>=65&&e<91))throw new g("The code point "+e+" is not in the range A-Z");t=26*t+(e-65)}},appendToBuf:function(t,e,s){if(!(e+s<=t.length))throw new g("Index out of range: startIndex="+e+" count="+s+" length="+t.length);this.buf.b+=null==s?a.substr(t,e,null):a.substr(t,e,s)},charAt:function(t,e){if(e<t.length)return a.cca(t.charAt(e),0);throw new g("Index out of range: pos="+e+" length="+t.length)},__class__:Ts};var Rs={_new:function(t){return JSON.parse(t)},apply:function(t,e){return Is.apply_patch(t,e)},toString:function(t){return JSON.stringify(t)}},Is=b(),Cs=N.LSConsoleLogLevel=function(){};Cs.__name__=!0,Cs.prototype={__class__:Cs};var xs=N.LSConsoleLoggerProvider=function(t){this.level=t};xs.__name__=!0,xs.__interfaces__=[w],xs.prototype={getLogger:function(t){return new Ls(this.level,t)},__class__:xs};var Ls=function(t,e){this.level=t,this.category=e,this.traceEnabled=t<=Cs.TRACE,this.debugEnabled=t<=Cs.DEBUG,this.infoEnabled=t<=Cs.INFO,this.warnEnabled=t<=Cs.WARN,this.errorEnabled=t<=Cs.ERROR,this.fatalEnabled=t<=Cs.FATAL};Ls.__name__=!0,Ls.__super__=k,Ls.prototype=n(k.prototype,{printLog:function(e){t.console.log(e)},format:function(t,e){return a.dateStr(new Date)+"|"+t+"|"+this.category+"|"+e},logFatal:function(e){t.console.log(e)},logError:function(e){t.console.log(e)},logWarn:function(e){t.console.log(e)},logInfo:function(e){t.console.log(e)},logDebug:function(e){t.console.log(e)},logTrace:function(e){t.console.log(e)},fatal:function(e,s){if(this.fatalEnabled){var i=this.format("FATAL",e);t.console.log(i),null!=s&&(i=g.caught(s).details(),t.console.log(i))}},error:function(e,s){if(this.errorEnabled){var i=this.format("ERROR",e);t.console.log(i),null!=s&&(i=g.caught(s).details(),t.console.log(i))}},warn:function(e,s){if(this.warnEnabled){var i=this.format("WARN ",e);t.console.log(i),null!=s&&(i=g.caught(s).details(),t.console.log(i))}},info:function(e,s){if(this.infoEnabled){var i=this.format("INFO ",e);t.console.log(i),null!=s&&(i=g.caught(s).details(),t.console.log(i))}},debug:function(e,s){if(this.debugEnabled){var i=this.format("DEBUG",e);t.console.log(i),null!=s&&(i=g.caught(s).details(),t.console.log(i))}},trace:function(e,s){if(this.traceEnabled){var i=this.format("TRACE",e);t.console.log(i),null!=s&&(i=g.caught(s).details(),t.console.log(i))}},isFatalEnabled:function(){return this.fatalEnabled},isErrorEnabled:function(){return this.errorEnabled},isWarnEnabled:function(){return this.warnEnabled},isInfoEnabled:function(){return this.infoEnabled},isDebugEnabled:function(){return this.debugEnabled},isTraceEnabled:function(){return this.traceEnabled},__class__:Ls});var Ns=i["haxe.StackItem"]={__ename__:!0,__constructs__:null,CFunction:{_hx_name:"CFunction",_hx_index:0,__enum__:"haxe.StackItem",toString:s},Module:(e=function(t){return{_hx_index:1,m:t,__enum__:"haxe.StackItem",toString:s}},e._hx_name="Module",e.__params__=["m"],e),FilePos:(e=function(t,e,i,n){return{_hx_index:2,s:t,file:e,line:i,column:n,__enum__:"haxe.StackItem",toString:s}},e._hx_name="FilePos",e.__params__=["s","file","line","column"],e),Method:(e=function(t,e){return{_hx_index:3,classname:t,method:e,__enum__:"haxe.StackItem",toString:s}},e._hx_name="Method",e.__params__=["classname","method"],e),LocalFunction:(e=function(t){return{_hx_index:4,v:t,__enum__:"haxe.StackItem",toString:s}},e._hx_name="LocalFunction",e.__params__=["v"],e)};Ns.__constructs__=[Ns.CFunction,Ns.Module,Ns.FilePos,Ns.Method,Ns.LocalFunction];var Ms={toString:function(t){for(var e=new c,s=0,i=t;s<i.length;){var n=i[s++];e.b+="\nCalled from ",Ms.itemToString(e,n)}return e.b},subtract:function(t,e){for(var s=-1,i=-1;++i<t.length;){for(var n=0,r=e.length;n<r;)if(Ms.equalItems(t[i],e[n++])){if(s<0&&(s=i),++i>=t.length)break}else s=-1;if(s>=0)break}return s>=0?t.slice(0,s):t},equalItems:function(t,e){if(null==t)return null==e;switch(t._hx_index){case 0:return null!=e&&0==e._hx_index;case 1:return null!=e&&1==e._hx_index&&t.m==e.m;case 2:return null!=e&&2==e._hx_index&&t.file==e.file&&t.line==e.line&&t.column==e.column&&Ms.equalItems(t.s,e.s);case 3:return null!=e&&3==e._hx_index&&t.classname==e.classname&&t.method==e.method;case 4:return null!=e&&4==e._hx_index&&t.v==e.v}},itemToString:function(t,e){switch(e._hx_index){case 0:t.b+="a C function";break;case 1:var s=e.m;t.b=(t.b+="module ")+(null==s?"null":""+s);break;case 2:s=e.s;var i=e.file,n=e.line,r=e.column;null!=s&&(Ms.itemToString(t,s),t.b+=" ("),t.b=(t.b+=null==i?"null":""+i)+" line ",t.b+=null==n?"null":""+n,null!=r&&(t.b=(t.b+=" column ")+(null==r?"null":""+r)),null!=s&&(t.b+=")");break;case 3:s=e.classname,i=e.method,t.b=(t.b+=l.string(null==s?"<unknown>":s))+".",t.b+=null==i?"null":""+i;break;case 4:s=e.v,t.b=(t.b+="local function #")+(null==s?"null":""+s)}}},Ds=function(){};Ds.__name__=!0,Ds.toHaxe=function(t,e){if(null==e&&(e=0),null==t)return[];if("string"==typeof t){var s=t.split("\n");"Error"==s[0]&&s.shift();for(var i=[],n=0,r=s.length;n<r;){var a=n++;if(!(e>a)){var o=s[a],h=o.match(/^    at ([$A-Za-z0-9_. ]+) \(([^)]+):([0-9]+):([0-9]+)\)$/);if(null!=h){var u=h[1].split(".");"$hxClasses"==u[0]&&u.shift();var c=u.pop(),_=h[2],p=l.parseInt(h[3]),f=l.parseInt(h[4]);i.push(Ns.FilePos("Anonymous function"==c?Ns.LocalFunction():"Global code"==c?null:Ns.Method(u.join("."),c),_,p,f))}else i.push(Ns.Module(d.trim(o)))}}return i}return e>0&&Array.isArray(t)?t.slice(e):t},Ds.normalize=function(t,e){if(null==e&&(e=0),Array.isArray(t)&&e>0)return t.slice(e);if("string"==typeof t){switch(t.substring(0,6)){case"Error\n":case"Error:":++e}return Ds.skipLines(t,e)}return t},Ds.skipLines=function(t,e,s){for(null==s&&(s=0);;){if(!(e>0))return t.substring(s);if((s=t.indexOf("\n",s))<0)return"";e=--e,s+=1}};var Os=function(t,e,s){g.call(this,String(t),e,s),this.value=t,this.__skipStack++};Os.__name__=!0,Os.__super__=g,Os.prototype=n(g.prototype,{__class__:Os});var Ps=function(){this.h={}};Ps.__name__=!0,Ps.__interfaces__=[ke],Ps.prototype={get:function(t){return this.h[t]},remove:function(t){return!!this.h.hasOwnProperty(t)&&(delete this.h[t],!0)},keys:function(){var t=[];for(var e in this.h)this.h.hasOwnProperty(e)&&t.push(+e);return new Bs(t)},iterator:function(){return{ref:this.h,it:this.keys(),hasNext:function(){return this.it.hasNext()},next:function(){var t=this.it.next();return this.ref[t]}}},copy:function(){for(var t=new Ps,e=this.keys();e.hasNext();){var s=e.next();t.h[s]=this.h[s]}return t},__class__:Ps};var ks=function(){this.h=Object.create(null)};ks.__name__=!0,ks.__interfaces__=[ke],ks.createCopy=function(t){var e=new ks;for(var s in t)e.h[s]=t[s];return e},ks.stringify=function(t){var e="[",s=!0;for(var i in t)s?s=!1:e+=",",e+=i+" => "+l.string(t[i]);return e+"]"},ks.prototype={get:function(t){return this.h[t]},keys:function(){return new Fs(this.h)},iterator:function(){return new As(this.h)},__class__:ks};var Fs=function(t){this.h=t,this.keys=Object.keys(t),this.length=this.keys.length,this.current=0};Fs.__name__=!0,Fs.prototype={hasNext:function(){return this.current<this.length},next:function(){return this.keys[this.current++]},__class__:Fs};var As=function(t){this.h=t,this.keys=Object.keys(t),this.length=this.keys.length,this.current=0};As.__name__=!0,As.prototype={hasNext:function(){return this.current<this.length},next:function(){return this.h[this.keys[this.current++]]},__class__:As};var qs=i["haxe.io.Error"]={__ename__:!0,__constructs__:null,Blocked:{_hx_name:"Blocked",_hx_index:0,__enum__:"haxe.io.Error",toString:s},Overflow:{_hx_name:"Overflow",_hx_index:1,__enum__:"haxe.io.Error",toString:s},OutsideBounds:{_hx_name:"OutsideBounds",_hx_index:2,__enum__:"haxe.io.Error",toString:s},Custom:(e=function(t){return{_hx_index:3,e:t,__enum__:"haxe.io.Error",toString:s}},e._hx_name="Custom",e.__params__=["e"],e)};qs.__constructs__=[qs.Blocked,qs.Overflow,qs.OutsideBounds,qs.Custom];var Bs=function(t){this.current=0,this.array=t};Bs.__name__=!0,Bs.prototype={hasNext:function(){return this.current<this.array.length},next:function(){return this.array[this.current++]},__class__:Bs};var Us=function(t){this.map=t,this.keys=t.keys()};Us.__name__=!0,Us.prototype={hasNext:function(){return this.keys.hasNext()},next:function(){var t=this.keys.next();return{value:this.map.get(t),key:t}},__class__:Us};var Ws=function(t,e,s){g.call(this,t,s),this.pos=e,this.__skipStack++};function Hs(t){return t instanceof Array?new Bs(t):t.iterator()}function Vs(e,s){return null==s?null:(null==s.__id__&&(s.__id__=t.$haxeUID++),null==e.hx__closures__?e.hx__closures__={}:i=e.hx__closures__[s.__id__],null==i&&(i=s.bind(e),e.hx__closures__[s.__id__]=i),i);var i}Ws.__name__=!0,Ws.__super__=g,Ws.prototype=n(g.prototype,{__class__:Ws}),t.$haxeUID|=0,"undefined"!=typeof performance&&"function"==typeof performance.now&&(a.now=performance.now.bind(performance)),null==String.fromCodePoint&&(String.fromCodePoint=function(t){return t<65536?String.fromCharCode(t):String.fromCharCode(55232+(t>>10))+String.fromCharCode(56320+(1023&t))}),Object.defineProperty(String.prototype,"__class__",{value:String,enumerable:!1,writable:!0}),String.__name__=!0,Array.__name__=!0,Date.prototype.__class__=Date,Date.__name__="Date";var zs={},Ys={},Gs=Number,Ks=Boolean,js={},Qs={};U.__toStr={}.toString;var Xs,Zs=!f.get_supported()||"http:"!=(null!=(Xs=t.location)?Xs.protocol:null)&&"https:"!=(null!=(Xs=t.location)?Xs.protocol:null)?null:m.fromString(t.location.protocol+"//"+t.location.hostname+(""!=t.location.port?":"+t.location.port:"")+"/"),Js="TLCP-2.5.0",$s=Js+".lightstreamer.com",ti="9.2.0 build 20240216",ei="pcYgxn8m8 feOojyA1V681f3g2.pz482hA5DLAk",si="javascript_client",ii="";x.LIB_NAME=si,x.LIB_VERSION=ti,q.lock=new A,q.logInstances=new ks,q.emptyLogger=new F;var ni=q.getLogger("lightstreamer.stream"),ri=q.getLogger("lightstreamer.protocol"),ai=q.getLogger("lightstreamer.internal"),oi=q.getLogger("lightstreamer.session"),hi=q.getLogger("lightstreamer.actions"),ui=q.getLogger("lightstreamer.reachability"),li=q.getLogger("lightstreamer.subscriptions"),ci=q.getLogger("lightstreamer.messages");q.getLogger("lightstreamer.cookies");var di=q.getLogger("lightstreamer.page"),_i=q.getLogger("lightstreamer.mpn.device"),pi=q.getLogger("lightstreamer.mpn.subscriptions");W.frz_globalPageLifecycle=P.newLoggingInstance();var fi="Cannot subscribe to an active MPNSubscription",mi="No MPNDevice Registered",gi="Specify property 'notificationFormat'";Ft.EOL_LEN=Ft.lengthOfBytes("\r\n");var vi="The Subscription was initiated using a Field Schema: the field names are not available",Si="The field position is out of bounds",yi="The field name is unknown";ve.Merge="MERGE",ve.Distinct="DISTINCT",Te.instance=new Te;var bi=Te.instance.hasWorkers?$e.setTimeout:t.setTimeout,Ei=Te.instance.hasWorkers?$e.clearTimeout:t.clearTimeout,wi=Te.instance.hasMicroTasks?t.queueMicrotask:function(t){Ti.push(t),bi(ts,0)},Ti=[];ss.ZERO=0,ns.WS="WS",ns.WS_STREAMING="WS-STREAMING",ns.WS_POLLING="WS-POLLING",ns.HTTP="HTTP",ns.HTTP_STREAMING="HTTP-STREAMING",ns.HTTP_POLLING="HTTP-POLLING",ms.Merge="MERGE",ms.Distinct="DISTINCT",ms.Command="COMMAND",ms.Raw="RAW",Ts.VARINT_RADIX=26,Cs.TRACE=0,Cs.DEBUG=10,Cs.INFO=20,Cs.WARN=30,Cs.ERROR=40,Cs.FATAL=50}("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:void 0);var M=N.LSLightstreamerClient,D=N.LSSubscription,O=N.LSFirebaseMpnBuilder,P=N.LSMpnDevice,k=N.LSMpnSubscription,F=N.LSSafariMpnBuilder,A=N.LSConsoleLogLevel,q=N.LSConsoleLoggerProvider,B=function(){var t=function(t){this.name="IllegalStateException",this.message=t};return t.prototype={toString:function(){return["[",this.name,this.message,"]"].join("|")}},t}(),U=function(){function t(t,e,s){if(e)return s?e.apply(t,s):e.apply(t)}function e(t,e){for(var s in t)if(t[e]==t[s]&&e!=s)return s;return null}var s={Inheritance:function(t,i,n,r){for(var a in i.prototype)if(t.prototype[a]){if(r){var o=e(i.prototype,a);if(o){if(t.prototype[o]&&t.prototype[o]!==t.prototype[a]&&i.prototype[o]!=i.prototype[o])throw new B("Can't solve alias collision, try to minify the classes again ("+o+", "+a+")");t.prototype[o]=t.prototype[a]}}}else t.prototype[a]=i.prototype[a];return n||(t.prototype._super_=i,t.prototype._callSuperConstructor=s._callSuperConstructor,t.prototype._callSuperMethod=s._callSuperMethod),t},_callSuperMethod:function(e,s,i){return t(this,e.prototype._super_.prototype[s],i)},_callSuperConstructor:function(e,s){t(this,e.prototype._super_,s)}};return s.Inheritance}(),W=function(){var t=function(t){this.matrix=t||{}};return t.prototype={insert:function(t,e,s){e in this.matrix||(this.matrix[e]={}),this.matrix[e][s]=t},get:function(t,e){return t in this.matrix&&e in this.matrix[t]?this.matrix[t][e]:null},del:function(t,e){if(!(!t in this.matrix)){for(var s in e in this.matrix[t]&&delete this.matrix[t][e],this.matrix[t])return;delete this.matrix[t]}},insertRow:function(t,e){this.matrix[e]=t},getRow:function(t){return t in this.matrix?this.matrix[t]:null},delRow:function(t){t in this.matrix&&delete this.matrix[t]},getEntireMatrix:function(){return this.matrix},isEmpty:function(){for(var t in this.matrix)return!1;return!0},forEachElement:function(t){for(var e in this.matrix)this.forEachElementInRow(e,t)},forEachRow:function(t){for(var e in this.matrix)t(e)},forEachElementInRow:function(t,e){var s=this.matrix[t];for(var i in s)e(s[i],t,i)}},t.prototype.insert=t.prototype.insert,t.prototype.get=t.prototype.get,t.prototype.del=t.prototype.del,t.prototype.insertRow=t.prototype.insertRow,t.prototype.getRow=t.prototype.getRow,t.prototype.delRow=t.prototype.delRow,t.prototype.getEntireMatrix=t.prototype.getEntireMatrix,t.prototype.forEachElement=t.prototype.forEachElement,t.prototype.forEachElementInRow=t.prototype.forEachElementInRow,t.prototype.forEachRow=t.prototype.forEachRow,t.prototype.isEmpty=t.prototype.isEmpty,t}(),H=function(){var t="undefined"!=typeof window&&"undefined"!=typeof navigator&&"undefined"!=typeof document,e="undefined"!=typeof importScripts,s="object"==typeof process&&(/node(\.exe)?$/.test(process.execPath)||process.node&&process.v8||process.versions&&process.versions.node&&process.versions.v8);if(t&&!document.getElementById)throw new B("Not supported browser");var i={isBrowserDocument:function(){return t},isBrowser:function(){return!s&&(t||e)},isNodeJS:function(){return!t&&s},isWebWorker:function(){return!t&&!s&&e},isOther:function(){return!t&&!s&&!e},browserDocumentOrDie:function(){if(!this.isBrowserDocument())throw new B("Trying to load a browser-only module on non-browser environment")}};return i.isBrowserDocument=i.isBrowserDocument,i.isBrowser=i.isBrowser,i.isNodeJS=i.isNodeJS,i.isWebWorker=i.isWebWorker,i.browserDocumentOrDie=i.browserDocumentOrDie,i}(),V=function(){var t=new RegExp("^\\s*([\\s\\S]*?)\\s*$"),e=new RegExp(",","g"),s=new RegExp("\\.","g"),i={getTimeStamp:function(){return(new Date).getTime()},randomG:function(t){return t=t||1e3,Math.round(Math.random()*t)},trim:function(e){return e.replace(t,"$1")},getNumber:function(t,i){return t?t.replace?(t=i?(t=t.replace(s,"")).replace(e,"."):t.replace(e,""),new Number(t)):t:0},isArray:function(t){return t&&t.join&&"function"==typeof t.join},addEvent:function(t,e,s){return!!H.isBrowserDocument()&&(void 0!==t.addEventListener?t.addEventListener(e,s,!1):void 0!==t.attachEvent&&t.attachEvent("on"+e,s),!0)},removeEvent:function(t,e,s){return!!H.isBrowserDocument()&&(void 0!==t.removeEventListener?t.removeEventListener(e,s,!1):void 0!==t.detachEvent&&t.detachEvent("on"+e,s),!0)}};return i.getTimeStamp=i.getTimeStamp,i.randomG=i.randomG,i.trim=i.trim,i.getNumber=i.getNumber,i.isArray=i.isArray,i.addEvent=i.addEvent,i.removeEvent=i.removeEvent,i}(),z=function(){var t=function(){return!1},e={error:t,warn:t,info:t,debug:t,fatal:t,isDebugEnabled:t,isInfoEnabled:t,isWarnEnabled:t,isErrorEnabled:t,isFatalEnabled:t},s=function(t){this.setWrappedInstance(t)};return s.prototype={setWrappedInstance:function(t){this.wrappedLogger=t||e},logFatal:function(t){this.isFatalLogEnabled()&&(t+=this.logArguments(arguments,1),this.fatal(t))},fatal:function(t,e){this.wrappedLogger.fatal(t,e)},isFatalLogEnabled:function(){return!this.wrappedLogger.isFatalEnabled||this.wrappedLogger.isFatalEnabled()},logError:function(t){this.isErrorLogEnabled()&&(t+=this.logArguments(arguments,1),this.error(t))},logErrorExc:function(t,e){this.isErrorLogEnabled()&&(e+=this.logArguments(arguments,2),this.error(e,t))},error:function(t,e){this.wrappedLogger.error(t,e)},isErrorLogEnabled:function(){return!this.wrappedLogger.isErrorEnabled||this.wrappedLogger.isErrorEnabled()},logWarn:function(t){this.isWarnLogEnabled()&&(t+=this.logArguments(arguments,1),this.warn(t))},warn:function(t,e){this.wrappedLogger.warn(t,e)},isWarnLogEnabled:function(){return!this.wrappedLogger.isWarnEnabled||this.wrappedLogger.isWarnEnabled()},logInfo:function(t){this.isInfoLogEnabled()&&(t+=this.logArguments(arguments,1),this.info(t))},info:function(t,e){this.wrappedLogger.info(t,e)},isInfoLogEnabled:function(){return!this.wrappedLogger.isInfoEnabled||this.wrappedLogger.isInfoEnabled()},logDebug:function(t){this.isDebugLogEnabled()&&(t+=this.logArguments(arguments,1),this.debug(t))},debug:function(t,e){this.wrappedLogger.debug(t,e)},isDebugLogEnabled:function(){return!this.wrappedLogger.isDebugEnabled||this.wrappedLogger.isDebugEnabled()},logArguments:function(t,e){for(var s=" {",i=e=e||0;i<t.length;i++)try{var n=t[i];null===n?s+="NULL":n.length<0?s+="*":null!=n.charAt?s+=n:n.message?(s+=n.message,n.stack&&(s+="\n"+n.stack+"\n")):n[0]==n?s+=n:V.isArray(n)?(s+="(",s+=this.logArguments(n),s+=")"):s+=n,s+=" "}catch(t){s+="??? "}return s+"}"}},s.prototype.debug=s.prototype.debug,s.prototype.isDebugLogEnabled=s.prototype.isDebugLogEnabled,s.prototype.logDebug=s.prototype.logDebug,s.prototype.info=s.prototype.info,s.prototype.isInfoLogEnabled=s.prototype.isInfoLogEnabled,s.prototype.logInfo=s.prototype.logInfo,s.prototype.warn=s.prototype.warn,s.prototype.isWarnEnabled=s.prototype.isWarnEnabled,s.prototype.logWarn=s.prototype.logWarn,s.prototype.error=s.prototype.error,s.prototype.isErrorEnabled=s.prototype.isErrorEnabled,s.prototype.logError=s.prototype.logError,s.prototype.logErrorExc=s.prototype.logErrorExc,s.prototype.fatal=s.prototype.fatal,s.prototype.isFatalEnabled=s.prototype.isFatalEnabled,s.prototype.logFatal=s.prototype.logFatal,s}(),Y=function(){var t=function(t){this.name="IllegalArgumentException",this.message=t};return t.prototype={toString:function(){return["[",this.name,this.message,"]"].join("|")}},t}(),G=function(){var t={},e=null,s="The given object is not a LoggerProvider",i={setLoggerProvider:function(i){if(i&&!i.getLogger)throw new Y(s);for(var n in e=i,t)e?t[n].setWrappedInstance(e.getLogger(n)):t[n].setWrappedInstance(null)},getLoggerProxy:function(s){return t[s]||(t[s]=e?new z(e.getLogger(s)):new z),t[s]},resolve:function(t){return t}};return i.setLoggerProvider=i.setLoggerProvider,i.getLoggerProxy=i.getLoggerProxy,i.resolve=i.resolve,i}(),K=function(){var t="The given value is not valid. ",e="Use a number",s="Use an integer",i="Use a positive number",n=" or 0",r="Use true or false",a=function(){};function o(r,a,o){var h=new Number(r);if(isNaN(h))throw new Y(t+e);if(!o&&h!=Math.round(h))throw new Y(t+s);if(a){if(r<0)throw new Y(t+i+n)}else if(r<=0)throw new Y(t+i);return h}function h(e,s){if(!0===e||!1===e||s&&!e)return!0===e;throw new Y(t+r)}return a.prototype.checkPositiveNumber=o,a.prototype.checkBool=h,a.prototype.checkPositiveNumber=o,a.prototype.checkBool=h,a}(),j=function(){var t=!!H.isBrowser()&&null,e=H.isBrowser()?navigator.userAgent.toLowerCase():null;function s(t,e,s){return!e||!t||(!0===s?t<=e:!1===s?t>=e:t==e)}function i(t){return e.indexOf(t)>-1}function n(e){var s=t;return function(){return null===s&&(s=i(e)),s}}function r(e){var s=t;return function(){if(null===s){s=!0;for(var t=0;t<e.length;t++)s=s&&e[t]()}return s}}function a(e){var s=t;return function(){if(null===s){s=!1;for(var t=0;t<e.length;t++)s=s||e[t]()}return s}}function o(e,i){var n=t,r=t;return function(t,a){return null===n&&(n=e(),r=n?i():null),!!n&&s(r,t,a)}}function h(s){var i=t;return function(){if(null===i){var t=s.exec(e);if(t&&t.length>=2)return t[1]}return null}}function u(){if(opera.version){var t=opera.version();return t=t.replace(new RegExp("[^0-9.]+","g"),""),parseInt(t)}return 7}function l(){return"undefined"!=typeof opera}function c(t){return function(){return!t()}}var d=t,_={isProbablyRekonq:n("rekonq"),isProbablyAWebkit:n("webkit"),isProbablyPlaystation:n("playstation 3"),isProbablyChrome:o(n("chrome/"),h(new RegExp("chrome/([0-9]+)","g"))),isProbablyAKhtml:function(){return null===d&&(d=document.childNodes&&!document.all&&!navigator.taintEnabled&&!navigator.accentColorName),d},isProbablyKonqueror:o(n("konqueror"),h(new RegExp("konqueror/([0-9.]+)","g"))),isProbablyIE:function(t,e){return!(!o(n("msie"),h(new RegExp("msie\\s([0-9]+)[.;]","g")))(t,e)&&!o(n("rv:11.0"),(function(){return"11"}))(t,e))},isProbablyEdge:n("edge"),isProbablyFX:o(n("firefox"),h(new RegExp("firefox\\/(\\d+\\.?\\d*)"))),isProbablyOldOpera:o(l,u)};return _.isProbablyAndroidBrowser=r([n("android"),_.isProbablyAWebkit,c(_.isProbablyChrome)]),_.isProbablyOperaMobile=r([_.isProbablyOldOpera,n("opera mobi")]),_.isProbablyApple=o(r([n("safari"),a([n("ipad"),n("iphone"),n("ipod"),r([c(_.isProbablyAndroidBrowser),c(_.isProbablyChrome),c(_.isProbablyRekonq)])])]),h(new RegExp("version\\/(\\d+\\.?\\d*)"))),_.isProbablyRekonq=_.isProbablyRekonq,_.isProbablyChrome=_.isProbablyChrome,_.isProbablyAWebkit=_.isProbablyAWebkit,_.isProbablyPlaystation=_.isProbablyPlaystation,_.isProbablyAndroidBrowser=_.isProbablyAndroidBrowser,_.isProbablyOperaMobile=_.isProbablyOperaMobile,_.isProbablyApple=_.isProbablyApple,_.isProbablyAKhtml=_.isProbablyAKhtml,_.isProbablyKonqueror=_.isProbablyKonqueror,_.isProbablyIE=_.isProbablyIE,_.isProbablyEdge=_.isProbablyEdge,_.isProbablyFX=_.isProbablyFX,_.isProbablyOldOpera=_.isProbablyOldOpera,_}(),Q=function(){var t=function(){this.data=[]};return t.prototype={add:function(t){this.data.push(t)},remove:function(t){var e=this.find(t);return!(e<0||(this.data.splice(e,1),0))},contains:function(t){return this.find(t)>=0},find:function(t){for(var e=0;e<this.data.length;e++)if(this.data[e]===t)return e;return-1},forEach:function(t){for(var e=0;e<this.data.length;e++)t(this.data[e])},asArray:function(){return[].concat(this.data)},clean:function(){this.data=[]}},t.prototype.add=t.prototype.add,t.prototype.remove=t.prototype.remove,t.prototype.forEach=t.prototype.forEach,t.prototype.asArray=t.prototype.asArray,t.prototype.clean=t.prototype.clean,t}(),X=function(){var t=new Q,e=new Q,s=new Q,i=1e3,n=!1,r={onloadDone:"onloadDone",onloadInprogress:"onloadInprogress",unloaded:"unloaded",unloading:"unloading",preunloading:"preunloading"},a={};for(var o in r)a[r[o]]=o;function h(t){return c(t,a.onloadDone,a.onloadInprogress,e,"onloadEvent")}function u(e){return c(e,a.unloaded,a.unloading,t,"unloadEvent")}function l(t){return c(t,a.preunloading,a.preunloading,s,"preUnloadEvent")}function c(t,e,s,i,n){return function(){t[e]||(t[s]=!0,i.forEach((function(t){try{d(t,n)}catch(t){}})),"preunloading"!=e&&i.clean(),t[e]=!0,t[s]=!1)}}function d(t,e){t[e]?t[e]():t()}function _(t,e){setTimeout((function(){d(t,e)}),0)}function p(t,e,s,i){setTimeout((function(){s?i?t.apply(s,i):t.apply(s):i?t.apply(null,i):t()}),e)}function f(){n=!0}var m={onloadDone:!1,onloadInprogress:!1,unloaded:!1,unloading:!1,preunloading:!1,isLoaded:function(){return this.onloadDone},isUnloaded:function(){return this.unloaded},isUnloading:function(){return this.unloading},addOnloadHandler:function(t){this.isPreOnload()?e.add(t):_(t,"onloadEvent")},addUnloadHandler:function(e){this.isPreUnload()?t.add(e):_(e,"unloadEvent")},addBeforeUnloadHandler:function(t){s.add(t),this.preunloading&&_(t,"preUnloadEvent")},removeOnloadHandler:function(t){e.remove(t)},removeUnloadHandler:function(e){t.remove(e)},removeBeforeUnloadHandler:function(t){s.remove(t)},isPreOnload:function(){return!(this.onloadDone||this.onloadInprogress)},isPreUnload:function(){return!(this.unloaded||this.unloading)},attachToWindow:function(){if(V.addEvent(window,"unload",this.closeFun),V.addEvent(window,"beforeunload",this.beforeCloseFun),document&&void 0!==document.readyState){if("COMPLETE"==document.readyState.toUpperCase())return void this.asynchExecution();p(this.controlReadyStateLoad,i,this)}else if(this.isInBody())return void this.asynchExecution();if(V.addEvent(window,"load",this.readyFun)){if(j.isProbablyOldOpera()){var t=!1;j.isProbablyOldOpera(9,!1)&&(t=!0,V.addEvent(document,"DOMContentLoaded",f)),p(this.controlOperaLoad,i,this,[t])}}else this.asynchExecution()},asynchExecution:function(){p(this.readyFun,0)},controlReadyStateLoad:function(){this.onloadDone||("COMPLETE"==document.readyState.toUpperCase()?this.readyFun():p(this.controlReadyStateLoad,i,this))},controlOperaLoad:function(t){this.onloadDone||(n||!t&&this.isInBody()?this.readyFun():p(this.controlOperaLoad,i,this,[t]))},isInBody:function(){return void 0!==document.getElementsByTagName&&void 0!==document.getElementById&&(null!=document.getElementsByTagName("body")[0]||null!=document.body)}};return m.readyFun=h(m),m.closeFun=u(m),m.beforeCloseFun=l(m),H.isBrowserDocument()?m.attachToWindow():m.asynchExecution(),m.addOnloadHandler=m.addOnloadHandler,m.addUnloadHandler=m.addUnloadHandler,m.addBeforeUnloadHandler=m.addBeforeUnloadHandler,m.removeOnloadHandler=m.removeOnloadHandler,m.removeUnloadHandler=m.removeUnloadHandler,m.removeBeforeUnloadHandler=m.removeBeforeUnloadHandler,m.isLoaded=m.isLoaded,m.isUnloaded=m.isUnloaded,m.isUnloading=m.isUnloading,m}(),Z=function(){var t=50,e=!1,s=[],i=V.getTimeStamp(),n=108e5,r=i+n,a=[],o=null,h=0;function u(t,e){return t.time===e.time?t.orderId-e.orderId:t.time-e.time}var l=!H.isBrowserDocument()||"http:"!=document.location.protocol&&"https:"!=document.location.protocol?"*":document.location.protocol+"//"+document.location.hostname+(document.location.port?":"+document.location.port:""),c=function(){},d=c,_=!1;function p(){_=!1,g()}function f(){_||(_=!0,d())}function m(){if(o)clearInterval(o);else if(H.isBrowserDocument()&&"undefined"!=typeof postMessage){d=function(){try{window.postMessage("Lightstreamer.run",l)}catch(t){try{window.postMessage("Lightstreamer.run",l)}catch(t){}}};var e=function(t){("Lightstreamer.run"==t.data&&"*"==l||t.origin==l)&&p()};V.addEvent(window,"message",e),f(),0==_&&(V.removeEvent(window,"message",e),d=c)}else H.isNodeJS()&&"undefined"!=typeof process&&process.nextTick&&(d=function(){process.nextTick(p)});o=setInterval(g,t)}function g(){if(X.unloaded)clearInterval(o);else{var t,l,c=i;if((i=V.getTimeStamp())<c&&(i=c),s.length>0)for(e&&(s.sort(u),e=!1);s.length>0&&s[0].time<=i&&!X.unloaded;)(t=s.shift()).fun&&(v.executeTask(t),t.step&&a.push(t));for(s.length<=0&&(h=0);a.length>0;)(l=a.shift()).step&&(l.orderId=h++,v.addPackedTimedTask(l,l.step,!0));i>=r&&(r=i+n,s=[].concat(s))}}var v={toString:function(){return["[","Executor",t,s.length,"]"].join("|")},getQueueLength:function(){return s.length},packTask:function(t,e,s){return{fun:t,context:e||null,params:s||null,orderId:h++}},addPackedTimedTask:function(t,n,r){if(t.step=r?n:null,t.time=i+parseInt(n),isNaN(t.time))try{throw new Error}catch(t){var a="Executor error for time: "+n;throw t.stack&&(a+=" "+t.stack),a}s.push(t),e=!0},addRepetitiveTask:function(t,e,s,i){return this.addTimedTask(t,e,s,i,!0)},stopRepetitiveTask:function(t){t&&(t.fun=null,t.step=null)},addTimedTask:function(t,e,s,i,n){var r=this.packTask(t,s,i);return this.addPackedTimedTask(r,e,n),0==e&&f(),r},modifyTaskParam:function(t,e,s){t.params[e]=s},modifyAllTaskParams:function(t,e){t.params=e},delayTask:function(t,s){t.time+=s,e=!0},executeTask:function(t,e){try{var s=e||t.params;t.context?s?t.fun.apply(t.context,s):t.fun.apply(t.context):s?t.fun.apply(null,s):t.fun()}catch(e){try{t.fun.name||t.fun.toString()}catch(t){}}}};return H.isWebWorker()?setTimeout(m,1):m(),v.getQueueLength=v.getQueueLength,v.packTask=v.packTask,v.addPackedTimedTask=v.addPackedTimedTask,v.addRepetitiveTask=v.addRepetitiveTask,v.stopRepetitiveTask=v.stopRepetitiveTask,v.addTimedTask=v.addTimedTask,v.modifyTaskParam=v.modifyTaskParam,v.modifyAllTaskParams=v.modifyAllTaskParams,v.delayTask=v.delayTask,v.executeTask=v.executeTask,v}(),J=function(){var t=function(){this.initDispatcher()};t.prototype={initDispatcher:function(){this.theListeners=new e,this.synchEvents=!1},addListener:function(t){if(t&&!this.theListeners.contains(t)){var e={handler:t,listening:!0};this.theListeners.add(e),this.dispatchToOneListener("onListenStart",[this],e,!0)}},removeListener:function(t){if(t){var e=this.theListeners.remove(t);e&&this.dispatchToOneListener("onListenEnd",[this],e,!0)}},getListeners:function(){return this.theListeners.asArray()},useSynchEvents:function(t){this.synchEvents=!0===t},dispatchToOneListener:function(t,e,s,i){this.synchEvents?this.dispatchToOneListenerExecution(t,e,s,!0):Z.addTimedTask(this.dispatchToOneListenerExecution,0,this,[t,e,s,i])},dispatchToOneListenerExecution:function(t,e,s,i){if(s&&s.handler[t]&&(i||s.listening))try{e?s.handler[t].apply(s.handler,e):s.handler[t].apply(s.handler)}catch(t){}},dispatchEvent:function(t,e){var s=this;this.theListeners.forEach((function(i){s.dispatchToOneListener(t,e,i,!1)}))}},t.prototype.initDispatcher=t.prototype.initDispatcher,t.prototype.addListener=t.prototype.addListener,t.prototype.removeListener=t.prototype.removeListener,t.prototype.getListeners=t.prototype.getListeners,t.prototype.useSynchEvents=t.prototype.useSynchEvents,t.prototype.dispatchEvent=t.prototype.dispatchEvent;var e=function(){this._callSuperConstructor(e)};return e.prototype={remove:function(t){var e=this.find(t);if(e<0)return!1;var s=this.data[e];return s.listening=!1,this.data.splice(e,1),s},find:function(t){for(var e=0;e<this.data.length;e++)if(this.data[e].handler==t)return e;return-1},asArray:function(){var t=[];return this.forEach((function(e){t.push(e.handler)})),t}},U(e,Q),t}(),$=function(){return{CONNECTING:"CONNECTING",CONNECTED:"CONNECTED:",SENSE:"STREAM-SENSING",WS_STREAMING:"WS-STREAMING",HTTP_STREAMING:"HTTP-STREAMING",STALLED:"STALLED",WS_POLLING:"WS-POLLING",HTTP_POLLING:"HTTP-POLLING",DISCONNECTED:"DISCONNECTED",WILL_RETRY:"DISCONNECTED:WILL-RETRY",TRYING_RECOVERY:"DISCONNECTED:TRYING-RECOVERY",WS_ALL:"WS",HTTP_ALL:"HTTP",RAW:"RAW",DISTINCT:"DISTINCT",COMMAND:"COMMAND",MERGE:"MERGE"}}(),tt=function(){var t=function(){this._callSuperConstructor(t),this.reverseIndex={}};return t.prototype={insert:function(e,s,i){void 0===this.reverseIndex[i]&&(this.reverseIndex[i]=s,this._callSuperMethod(t,"insert",[e,s,i]))},del:function(e,s){this._callSuperMethod(t,"del",[e,s]),delete this.reverseIndex[s]},delReverse:function(t){var e=this.reverseIndex[t];void 0!==e&&this.del(e,t)},delRow:function(e){var s=this.getRow(e);for(var i in s)delete this.reverseIndex[i];this._callSuperMethod(t,"delRow",[e])}},t.prototype.insert=t.prototype.insert,t.prototype.del=t.prototype.del,t.prototype.delReverse=t.prototype.delReverse,t.prototype.delRow=t.prototype.delRow,U(t,W),t}(),et=function(){var t=G.getLoggerProxy("lightstreamer.grids"),e="ITEM_IS_KEY",s="UPDATE_IS_KEY",i="KEY_IS_KEY",n="Please parse html before calling this method",r=1,a=2,o=100,h=function(){this._callSuperConstructor(h),this.kind=e,this.keyField=null,this.commandField=null,this.updateCount=0,this.fieldPosBased=null,this.values=new W,this.parsed=!1,this.id=arguments[0],this.useSynchEvents(!0),this.cleanOnFirstSubscribe=!1,this.cleanOnLastUnsubscribe=!1,this.activeSubscriptions=0,this.masterSubscription=null,this.forcedInterpretation=!1,this.updateInProgress=null,this.suspendedUpdates=[],this.fifoKeys=[],this.fifoMap={},this.fifoHoles=0,this.fifoHead=0,this.itemKeyMap=new tt};return h.ITEM_IS_KEY=e,h.UPDATE_IS_KEY=s,h.prototype={getId:function(){return this.id},checkParsed:function(){if(!this.parsed)throw new B(n)},onItemUpdate:function(t){var e,s=t.getItemName(),i=t.getItemPos();this.updateCount++;var n=null==s?i:s;e=this.itemIsKey()?n:this.updateIsKey()?this.updateCount:n+" "+t.getValue(this.keyField);var r={};this.updateIsKey()?t.forEachField(this.getForeachHandler(r)):t.forEachChangedField(this.getForeachHandler(r)),this.keyIsKey()&&"DELETE"==r[this.commandField]?this.removeRow(e):(this.updateRow(e,r),this.itemKeyMap.insert(!0,n,e))},onClearSnapshot:function(t,e){var s=null==t?e:t,i=this.itemKeyMap.getRow(s);for(var n in this.itemKeyMap.delRow(s),i)this.removeRow(n)},onSubscription:function(){0==this.activeSubscriptions&&this.cleanOnFirstSubscribe&&this.clean(),this.keyIsKey()&&!this.keyField&&(this.keyField=this.masterSubscription.getKeyPosition(),this.commandField=this.masterSubscription.getCommandPosition()),this.activeSubscriptions++},onUnsubscription:function(){this.activeSubscriptions--,0==this.activeSubscriptions&&this.cleanOnLastUnsubscribe&&this.clean()},onListenStart:function(t){this.masterSubscription||(this.masterSubscription=t,this.forcedInterpretation||this.chooseInterpretation()),t.isSubscribed()&&this.onSubscription()},onListenEnd:function(t){t.isSubscribed()&&this.onUnsubscription()},chooseInterpretation:function(){if(this.masterSubscription){var t=this.masterSubscription;if(t.getMode()==$.MERGE||t.getMode()==$.RAW)this.kind=e;else if(t.getMode()==$.DISTINCT)this.kind=s;else{this.kind=i;try{t.getFields(),this.keyField="key",this.commandField="command"}catch(t){}}}else this.kind=e},getForeachHandler:function(t){var e=this;return function(s,i,n){null===e.fieldPosBased&&(e.fieldPosBased=null==s);var r=e.fieldPosBased?i:s;t[r]=n}},itemIsKey:function(){return this.kind==e},updateIsKey:function(){return this.kind==s},keyIsKey:function(){return this.kind==i},getOldestKey:function(){return this.fifoHead>=this.fifoKeys.length?null:this.fifoKeys[this.fifoHead]},removeFromFifo:function(t){var e=this.fifoMap[t];if(delete this.fifoMap[t],this.fifoKeys[e]=null,this.fifoHoles++,e==this.fifoHead){for(;null===this.fifoKeys[this.fifoHead]&&this.fifoHead<this.fifoKeys.length;)this.fifoHead++;if(this.fifoHead>=this.fifoKeys.length)return this.fifoKeys=[],this.fifoMap={},this.fifoHoles=0,void(this.fifoHead=0)}if(this.fifoHoles>=o){this.fifoMap={};var s=this.fifoKeys;this.fifoKeys=[],this.fifoHead=0,this.fifoHoles=0;for(var i=0;i<s.length;i++)null!==s[i]&&this.newKey(s[i])}},newKey:function(t){this.fifoMap[t]=this.fifoKeys.length,this.fifoKeys.push(t)},removeRow:function(e){if(this.checkParsed(),this.updateInProgress)this.deleteLater(e);else if(this.values.getRow(e)){t.isDebugLogEnabled()&&t.logDebug("Removing row",e,this),this.updateInProgress={};var s=null;try{this.removeRowExecution(e),this.values.delRow(e),this.itemKeyMap.delReverse(e),this.updateIsKey()&&this.removeFromFifo(e)}catch(t){s=t}if(this.updateInProgress=null,this.dequeuePostponedUpdates(),null!==s)throw s}else t.logWarn("Can't remove row that does not exist",e,this)},updateLater:function(e,s){t.isDebugLogEnabled()&&t.logDebug("Postpone new update until the current update/remove is completed",this),this.suspendedUpdates.push({type:a,key:e,obj:s})},deleteLater:function(e){t.isDebugLogEnabled()&&t.logDebug("Postpone new remove until the current update/remove is completed",this),this.suspendedUpdates.push({type:r,key:e})},dequeuePostponedUpdates:function(){for(;this.suspendedUpdates.length>0;){var t=this.suspendedUpdates.shift();t.type==r?this.removeRow(t.key):this.updateRow(t.key,t.obj)}},updateRow:function(e,s){if(this.checkParsed(),this.updateInProgress)e==this.updateInProgress?this.mergeUpdate(e,s):this.updateLater(e,s);else{this.updateInProgress=e;var i=null;try{if(this.updateRowExecution(e,s),this.values.getRow(e))for(var n in t.isDebugLogEnabled()&&t.logDebug("Updating row",e,this),s)this.values.insert(s[n],e,n);else t.isDebugLogEnabled()&&t.logDebug("Inserting new row",e,this),this.updateIsKey()&&this.newKey(e),this.values.insertRow(s,e)}catch(t){i=t}if(this.updateInProgress=null,this.dequeuePostponedUpdates(),null!==i)throw i}},clean:function(){t.logInfo("Cleaning the model",this);var e=[];this.values.forEachRow((function(t){e.push(t)}));for(var s=0;s<e.length;s++)this.removeRow(e[s])},getValue:function(t,e){return this.values.get(t,e)},setAutoCleanBehavior:function(t,e){this.cleanOnFirstSubscribe=this.checkBool(t),this.cleanOnLastUnsubscribe=this.checkBool(e)},parseHtml:function(){},updateRowExecution:function(t,e){},removeRowExecution:function(t){},mergeUpdate:function(t,e){}},h.prototype.onItemUpdate=h.prototype.onItemUpdate,h.prototype.onClearSnapshot=h.prototype.onClearSnapshot,h.prototype.onSubscription=h.prototype.onSubscription,h.prototype.onUnsubscription=h.prototype.onUnsubscription,h.prototype.onListenStart=h.prototype.onListenStart,h.prototype.onListenEnd=h.prototype.onListenEnd,h.prototype.removeRow=h.prototype.removeRow,h.prototype.updateRow=h.prototype.updateRow,h.prototype.clean=h.prototype.clean,h.prototype.getValue=h.prototype.getValue,h.prototype.setAutoCleanBehavior=h.prototype.setAutoCleanBehavior,h.prototype.parseHtml=h.prototype.parseHtml,h.prototype.updateRowExecution=h.prototype.updateRowExecution,h.prototype.removeRowExecution=h.prototype.removeRowExecution,h.prototype.mergeUpdate=h.prototype.mergeUpdate,U(h,J,!1,!0),U(h,K,!0,!0),h}(),st=function(){H.browserDocumentOrDie();var t="field",e="grid",s="row",i="item",n="update",r="value",a="replica",o="fieldtype",h={extra:!0,"first-level":!0,"second-level":!0},u="first-level",l="second-level",c=1,d=2,_="",p="source",f="lightstreamer",m={input:!0,textarea:!0};function g(t,e){if(!1===M.useOldNames)return v(t,e);if(!0===M.useOldNames)return S(t,e);var s=v(t,e);return s?(M.useOldNames=!1,s):((s=S(t,e))&&(M.useOldNames=!0),s)}function v(t,e){return t.dataset&&t.dataset[e]?t.dataset[e]:t.getAttribute("data-"+e)}function S(t,e){return t.getAttribute(e)}function y(t,e){if(!t)return e;for(var s in e)if(!t[s]){if(null===t[s]||""===t[s])continue;t[s]=e[s]}return t}function b(t){var e=g(t,p);return e&&e.toLowerCase()==f}function E(t){return function(e){this.el.style[t]=e===_?null:e}}function w(t){return function(){return this.el.style[t]||""}}function T(t){this.el.value=t&&t!==_?t:""}function R(){return this.el.value}function I(t,e){e?this.el.innerHTML=t:1!=this.el.childNodes.length||3!=this.el.firstChild.nodeType?(null!=this.el.firstChild&&(this.el.innerHTML=""),this.el.appendChild(document.createTextNode(t))):this.el.firstChild.nodeValue=t}function C(t){return t?this.el.innerHTML:this.el.firstChild?this.el.firstChild.nodeValue:""}function x(t){return t===r?T:function(e){e&&e!==_?this.el.setAttribute(t,e):this.el.removeAttribute(t)}}function L(t){return t===r?R:function(){return this.el.getAttribute(t)}}var N=0,M=function(t,e){if(this.el=t,this.isCell=!0,this.fadePhase=0,e||(e=this.getUpdateWhat()),e)if(0==e.toLowerCase().indexOf("style.")){var s=e.slice(6);this.updateValue=E(s),this.retrieveValue=w(s)}else this.updateValue=x(e),this.retrieveValue=L(e);else t.nodeName.toLowerCase()in m?(this.updateValue=T,this.retrieveValue=R):(this.updateValue=I,this.retrieveValue=C);this.cellId=N++,this.updateCount=0,this.nextFormattedValue=null,this.newHotArray=null,this.newColdArray=null,this.initialValue=this.retrieveValue(!0),this.initialClass=this.extractCSSClass(),this.initialStyles=this.extractStyles()};return M.HOT=c,M.COLD=d,M.FIRST_LEVEL=u,M.SECOND_LEVEL=l,M.useOldNames=null,M.getLSTags=function(t,e){var s=[];e||(e=["*"]);for(var i=0;i<e.length;i++)for(var n=t.getElementsByTagName(e[i]),r=0;r<n.length;r++)b(n[r])&&s.push(new M(n[r]));return s},M.verifyTag=b,M.isAttachedToDOM=function(t){for(var e=null,s=t;null!=s&&s!=document;)e=s,s=s.parentNode;return null!=s||null!=e&&"HTML"==e.nodeName},M.prototype={scrollHere:function(t,e){this.updateValue(t.retrieveValue(),e),this.nextFormattedValue=t.nextFormattedValue,this.newHotArray=t.newHotArray,this.newColdArray=t.newColdArray,this.updateCount=t.updateCount,this.setAttributes(t.extractStyles()),this.updateCSSClass(t.extractCSSClass()),this.fadePhase=t.fadePhase},getEl:function(){return this.el},extractStyles:function(){var t={};for(var e in this.el.style)t[e]=this.el.style[e];return t},extractCSSClass:function(){return this.el.className},updateCSSClass:function(t){null!==t&&this.el.className!=t&&(this.el.className=t)},setAttributes:function(t){if(t)for(var e in t){"CLASS"==e&&this.updateCSSClass(t[e]);try{null!==t[e]&&(this.el.style[e]=t[e])}catch(t){}}},asynchUpdateStyles:function(t,e){t==this.updateCount&&(e==c?(this.setAttributes(this.newHotArray),this.newHotArray=null):(this.setAttributes(this.newColdArray),this.newColdArray=null))},asynchUpdateValue:function(t,e){t==this.updateCount&&(this.updateValue(this.nextFormattedValue,e),this.nextFormattedValue=null,this.asynchUpdateStyles(t,c))},setUpdating:function(){return this.updateCount++,this.updateCount},getField:function(){var e=g(this.el,t);return e||null},getNum:function(){var t=g(this.el,a);return t||null},getFieldType:function(){var t=g(this.el,o);return t?(t=t.toLowerCase(),h[t]?t:u):u},getTable:function(){return g(this.el,e)},getRow:function(){var t=g(this.el,i);return t||(t=g(this.el,s)),t},getUpdateWhat:function(){return g(this.el,n)},incFadePhase:function(){return++this.fadePhase},getFadePhase:function(){return this.fadePhase},getCellId:function(){return this.cellId},isSameEl:function(t){return t.el===this.el},getTagName:function(){return this.el.tagName},isAttachedToDOM:function(){return M.isAttachedToDOM(this.el)},isAttachedToDOMById:function(){return this.el.id?document.getElementById(this.el.id)===this.el:this.isAttachedToDOM(this.el)},setNextFormattedValue:function(t){this.nextFormattedValue=""===t?_:t},getNextFormattedValue:function(){return this.nextFormattedValue},addStyle:function(t,e,s){this.newHotArray||(this.newHotArray={}),this.newColdArray||(this.newColdArray={}),this.newHotArray[s]=t||"",this.newColdArray[s]=e||""},getNextHotArray:function(t){return t&&(this.newHotArray=y(this.newHotArray,t)),this.newHotArray},getNextColdArray:function(t){return t&&(this.newColdArray=y(this.newColdArray,t)),this.newColdArray},clean:function(){this.updateValue(this.initialValue,!0),this.updateCSSClass(this.initialClass),this.setAttributes(this.initialStyles)}},M}(),it=function(){function t(t,e,s){var i=(new Number(t)-e)/s;return Math.round(i)}var e="black",s=G.getLoggerProxy("lightstreamer.charts"),i=0,n=function(){this.parent=arguments[1],this.yField=arguments[3],this.pointColor=e,this.lineColor=e,this.pointSize=1,this.lineSize=1,this.yMin=null,this.yMax=null,this.yUnit=null,this.numYLabels=0,this.labelsFormatter=null,this.xArray=[],this.yArray=[],this.labels=[],this.chartId=i++,s.logDebug("New ChartLine",this)};return n.prototype={toString:function(){return["[","ChartLine",this.parent,"]"].join("|")},getId:function(){return this.chartId},emptyHistory:function(){s.logDebug("Clearing ChartLine",this),this.yArray=[],this.xArray=[]},isEmpty:function(){return this.xArray.length<=0},reset:function(){this.emptyHistory(),this.parent.clearLine(this)},repaint:function(){s.logDebug("Repainting ChartLine",this);var t=this.xArray,e=this.yArray;for(this.reset();t.length>0;)(t.length>1&&t[1]>=this.parent.xMin||t[0]>=this.parent.xMin)&&this.addPoint(t[0],e[0]),t.shift(),e.shift();s.logDebug("ChartLine re-painted",this)},addPoint:function(t,e){this.xArray.push(t),this.yArray.push(e),this.parent.drawLine(t,e,this)},calcYUnit:function(){this.yUnit=(this.yMax-this.yMin)/this.parent.screenY,s.logDebug("Calculated Y unit",this,this.yUnit)},isYAxisPositioned:function(){return null!==this.yMax},isPointInRange:function(t){return t<this.yMax&&t>this.yMin},getMin:function(){return this.yMin},getMax:function(){return this.yMax},paintYLabels:function(){this.clearLabels();var t="",e=-1;if(!(this.numYLabels<=0)){if(this.numYLabels>0&&(t=this.labelsFormatter?this.labelsFormatter(this.yMin):this.yMin,e=this.getRelativeY(this.yMin),this.labels[this.labels.length]=this.parent.createLabel(this.classYLabels,t,e,"Y")),this.numYLabels>1&&(t=this.labelsFormatter?this.labelsFormatter(this.yMax):this.yMax,e=this.getRelativeY(this.yMax),this.labels[this.labels.length]=this.parent.createLabel(this.classYLabels,t,e,"Y")),this.numYLabels>2)for(var i=this.numYLabels-1,n=(this.yMax-this.yMin)/i,r=this.yMin,a=1;a<i;a++)r+=n,t=this.labelsFormatter?this.labelsFormatter(r):r,e=this.getRelativeY(r),this.labels[this.labels.length]=this.parent.createLabel(this.classYLabels,t,e,"Y");s.logDebug("Y labels generated",this)}},getRelativeY:function(e){return t(e,this.yMin,this.yUnit)},clearLabels:function(){for(var t=0;t<this.labels.length;t++)this.labels[t]&&st.isAttachedToDOM(this.labels[t])&&this.labels[t].parentNode.removeChild(this.labels[t]);this.labels=[],s.logDebug("Y labels cleared",this)},setYLabels:function(t,e,i){this.numYLabels=this.checkPositiveNumber(t,!0),this.classYLabels=e,this.labelsFormatter=i||null,s.logDebug("Y labels now configured",this),null!=this.yUnit&&this.parent&&this.parent.painter&&this.paintYLabels()},setStyle:function(t,e,i,n){this.pointColor=t,this.lineColor=e,this.pointSize=this.checkPositiveNumber(i),this.lineSize=this.checkPositiveNumber(n),s.logDebug("Line style configured",this)},positionYAxis:function(t,e){if(this.yMax=Number(e),this.yMin=Number(t),isNaN(this.yMax)||isNaN(this.yMin))throw new Y("Min and max must be numbers");if(this.yMin>this.yMax)throw new Y("The maximum value must be greater than the minimum value");this.parent&&null!=this.parent.screenY&&this.parent.painter&&(this.calcYUnit(),this.paintYLabels(),this.isEmpty()||this.repaint()),s.logDebug("Y axis is now positioned",this)},getYField:function(){return this.yField}},n.prototype.setYLabels=n.prototype.setYLabels,n.prototype.setStyle=n.prototype.setStyle,n.prototype.positionYAxis=n.prototype.positionYAxis,n.prototype.getYField=n.prototype.getYField,U(n,K,"O"),n}(),nt=function(){var t=function(t){var e=!1;if(!t)try{document.createElement("canvas").getContext&&(e=!0)}catch(t){}this.useCanvas=e,this.chartArea,this.lines={}};t.prototype={setContainer:function(t){this.chartArea=document.createElement("div"),this.chartArea.style.position="absolute",this.chartArea.style.overflow="hidden",t.appendChild(this.chartArea)},clean:function(){this.chartArea&&st.isAttachedToDOM(this.chartArea)&&this.chartArea.parentNode.removeChild(this.chartArea)},setSize:function(t,e){this.chartArea.style.width=t+"px",this.chartArea.style.height=e+"px",this.areaHeight=e,this.areaWidth=t},setOffset:function(t,e){this.chartArea.style.top=e+"px",this.chartArea.style.left=t+"px"},setAreaStyle:function(t){this.chartArea.className=t},addLine:function(t){var i=t.getId();this.lines[i]=this.useCanvas?new e(t,this):new s(t,this)},removeLine:function(t){var e=t.getId();this.lines[e]&&(this.lines[e].remove(),delete this.lines[e])},clearLine:function(t){var e=t.getId();this.lines[e]&&this.lines[e].clear()},paintLine:function(t,e,s){var i=t.getId();this.lines[i]||this.addLine(t),this.lines[i].drawTo(e,s)}};var e=function(t,e){this.chartLine=t,this.lastX=null,this.lastY=null,this.painter=e,this.canvasObj=null,this.canvasEl=null};e.prototype={initCanvas:function(){if(!this.canvasEl){var t=document.createElement("canvas");t.style.position="absolute",t.style.overflow="hidden";var e=t.getContext("2d");this.painter.chartArea.appendChild(t),this.canvasEl=t,this.canvasObj=e}this.canvasEl.width=this.painter.areaWidth,this.canvasEl.height=this.painter.areaHeight},drawTo:function(t,e){if(e=this.painter.areaHeight-e,null===this.lastX)return this.initCanvas(),void this.drawPoint(t,e);this.canvasObj.beginPath(),this.canvasObj.strokeStyle=this.chartLine.lineColor,this.canvasObj.lineWidth=this.chartLine.lineSize,this.canvasObj.moveTo(this.lastX,this.lastY),this.canvasObj.lineTo(t,e),this.canvasObj.stroke(),this.drawPoint(t,e)},drawPoint:function(t,e){this.lastX=t,this.lastY=e;var s=Math.round(this.chartLine.pointSize/2);this.canvasObj.fillStyle=this.chartLine.pointColor,this.canvasObj.fillRect(t-s,e-s,this.chartLine.pointSize,this.chartLine.pointSize)},clear:function(){this.lastX=null,this.lastY=null,this.canvasObj.clearRect(0,0,this.canvasEl.width,this.canvasEl.height)},remove:function(){this.lastX=null,this.lastY=null,this.painter.chartArea.removeChild(this.canvasEl),this.canvasEl=null}};var s=function(t,e){this.chartLine=t,this.lastX=null,this.lastY=null,this.painter=e,this.pointArray=[]};return s.prototype={drawTo:function(t,e){if(null!==this.lastX){var s=t-this.lastX,i=e-this.lastY,n=Math.abs(s),r=Math.abs(i),a=null,o=0,h=0,u=0;n>=r?(u=i/s,o=s,h=s>=0?1:-1):(u=s/i,o=i,h=i>=0?1:-1);var l=0,c=0,d=null,_=null,p=!0,f=!0;n<r&&(f=!1);for(var m=0;m!=o;m+=h){var g=0,v=0,S=0,y=0,b=!1;if(m+h==o&&(b=!0,p=!0),a=document.createElement("div"),b?(a.style.backgroundColor=this.chartLine.pointColor,a.style.width=this.chartLine.pointSize+"px",a.style.height=this.chartLine.pointSize+"px"):(a.style.backgroundColor=this.chartLine.lineColor,a.style.width=this.chartLine.lineSize+"px",a.style.height=this.chartLine.lineSize+"px"),a.style.position="absolute",a.style.fontSize="0px",this.painter.chartArea.appendChild(a),this.pointArray.push(a),p&&(p=!1,d=Math.ceil(a.offsetWidth/2),_=Math.ceil(a.offsetHeight/2),l=a.offsetWidth,c=a.offsetHeight),S=l,y=c,f){if(g=Math.round(m+this.lastX),v=Math.round(this.painter.areaHeight-(u*m+this.lastY)),!b){for(var E=0;m+h!=o-h&&v==Math.round(this.painter.areaHeight-(u*(m+h)+this.lastY));)m+=h,E++;S=l+(w=d*E),h<0&&(g-=w)}}else if(g=Math.round(u*m+this.lastX),v=Math.round(this.painter.areaHeight-(m+this.lastY)),!b){for(E=0;m+h!=o-h&&g==Math.round(u*(m+h)+this.lastX);)m+=h,E++;var w;y=c+(w=_*E),h>0&&(v-=w)}g-=Math.floor(d/2),v-=Math.floor(_/2),a.style.left=g+"px",a.style.top=v+"px",a.style.width=S+"px",a.style.height=y+"px"}this.drawPoint(t,e)}else this.drawPoint(t,e)},drawPoint:function(t,e){this.lastX=t,this.lastY=e},clear:function(){if(this.pointArray[0]&&st.isAttachedToDOM(this.pointArray[0]))for(var t=0;t<this.pointArray.length;t++)this.pointArray[t].parentNode.removeChild(this.pointArray[t]);this.pointArray=[],this.lastX=null,this.lastY=null},remove:function(){this.clear()}},t}(),rt=function(){H.browserDocumentOrDie();var t="A DOM element must be provided as an anchor for the chart";function e(t,e,s){var i=(new Number(t)-e)/s;return Math.round(i)}var s=G.getLoggerProxy("lightstreamer.charts"),i=function(t){this._callSuperConstructor(i,arguments),this.caContainer=document.createElement("div"),this.caContainer.style.position="relative",this.caContainer.style.overflow="visible",this.areaClass="",this.offsetY=0,this.offsetX=0,this.screenX=null,this.screenY=null,this.labels=[],this.labelsFormatter=null,this.numXLabels=0,this.xFieldCode=null,this.xMin=null,this.xMax=null,this.xUnit=null,this.xParser=null,this.chartArray={},this.yParsers={},this.forcedDivPainting=!1,this.painter=null,this.parseHtml()};return i.prototype={toString:function(){return["[","Chart",this.id,"]"].join("|")},forceDivPainting:function(t){this.forcedDivPainting=!0===t},initPainter:function(){this.painter=new nt(this.forcedDivPainting),this.painter.setContainer(this.caContainer),this.configurePainter()},configurePainter:function(){this.painter&&(this.painter.setSize(this.screenX,this.screenY),this.painter.setOffset(this.offsetX,this.offsetY),this.painter.setAreaStyle(this.areaClass),s.logDebug("Painter configured"))},setChartAnchor:function(t,e){if(!this.painter)if(t&&t.appendChild){for(var i in t.appendChild(this.caContainer),null==this.screenX&&(this.screenX=t.offsetWidth),null==this.screenY&&(this.screenY=t.offsetHeight),this.initPainter(),null!=this.xMax&&(this.calcXUnit(),this.paintXLabels()),this.chartArray)for(var n in this.chartArray[i]){var r=this.chartArray[i][n];r&&r.isYAxisPositioned()&&(r.calcYUnit(),r.paintYLabels())}s.logInfo("Chart is now ready to be used",this,t)}else e||s.logError("A DOM element must be provided as an anchor for the chart",this)},createLabel:function(t,e,i,n){s.logDebug("Creating a new label for the chart",this);var r=document.createElement("div");null!=t&&(r.className=t),r.style.position="absolute";var a=document.createTextNode(e);r.appendChild(a),this.caContainer.appendChild(r);var o=r.offsetWidth;return"X"==n.toUpperCase()?(r.style.top=this.screenY+5+this.offsetY+"px",r.style.left=i-r.offsetWidth/2+this.offsetX+"px"):"Y"==n.toUpperCase()&&(r.style.left=this.offsetX-o+"px",r.style.top=this.screenY-i-r.offsetHeight/2+this.offsetY+"px"),r},clearLine:function(t){this.painter.clearLine(t)},drawLine:function(t,e,i){s.isDebugLogEnabled()&&s.logDebug("Drawing line on the chart",this);var n=this.getRelativeX(t),r=i.getRelativeY(e);s.isDebugLogEnabled()&&s.logDebug("New line coordinates",n,r),this.painter.paintLine(i,n,r),s.isDebugLogEnabled()&&s.logDebug("New line was drawn")},repaintAll:function(t,e,i){for(var n in s.logDebug("Repaint All"),this.chartArray)for(var r in this.chartArray[n]){var a=this.chartArray[n][r];a&&!a.isEmpty()&&a.repaint()}},calcXUnit:function(){this.xUnit=(this.xMax-this.xMin)/this.screenX,s.isDebugLogEnabled()&&s.logDebug("Calculated X unit",this,this.xUnit)},paintXLabels:function(){this.clearLabels();var t="",e=-1;if(!(this.numXLabels<=0)){if(this.numXLabels>0&&(t=this.labelsFormatter?this.labelsFormatter(this.xMin):this.xMin,e=this.getRelativeX(this.xMin),this.labels[this.labels.length]=this.createLabel(this.classXLabels,t,e,"X")),this.numXLabels>1&&(t=this.labelsFormatter?this.labelsFormatter(this.xMax):this.xMax,e=this.getRelativeX(this.xMax),this.labels[this.labels.length]=this.createLabel(this.classXLabels,t,e,"X")),this.numXLabels>2)for(var i=this.numXLabels-1,n=(this.xMax-this.xMin)/i,r=this.xMin,a=1;a<i;a++)r+=n,t=this.labelsFormatter?this.labelsFormatter(r):r,e=this.getRelativeX(r),this.labels[this.labels.length]=this.createLabel(this.classXLabels,t,e,"X");s.logDebug("X labels generated",this)}},getRelativeX:function(t){return e(t,this.xMin,this.xUnit)},clearLabels:function(){for(var t=0;t<this.labels.length;t++)this.labels[t]&&st.isAttachedToDOM(this.labels[t])&&this.labels[t].parentNode.removeChild(this.labels[t]);this.labels=[],s.logDebug("X labels cleared",this)},onListenStart:function(t){this._callSuperMethod(i,"onListenStart",[t]),this.updateIsKey()&&(this.kind=et.ITEM_IS_KEY)},parseValue:function(t,e,s,i){var n=null===e[s]||void 0===e[s]?this.values.get(t,s):e[s];return null===(n=i?i(n,t):n)?null:V.getNumber(n)},mergeUpdate:function(t,e){this.updateLater(t,e)},updateRowExecution:function(t,e){var i=this.parseValue(t,e,this.xFieldCode,this.xParser);if(null!==i&&!(isNaN(i)||null!==i&&i<this.xMin))for(var n in i>this.xMax&&this.dispatchEvent("onXOverflow",[t,i,this.xMin,this.xMax]),this.chartArray){var r=this.parseValue(t,e,n,this.yParsers[n]);if(!isNaN(r)){var a=this.chartArray[n][t];if(null!=i&&null!=r){if(!a){if(a=new it(t,this,this.xFieldCode,n),this.dispatchEvent("onNewLine",[t,a,i,r]),!a.isYAxisPositioned())return void s.logError("Cannot create line. Please declare the Y axis",this);a.calcYUnit(),a.paintYLabels(),this.chartArray[n][t]=a}a.isPointInRange(r)||this.dispatchEvent("onYOverflow",[t,a,r,a.getMin(),a.getMax()]),a.addPoint(i,r)}else{if(a&&null==i&&null==r){s.logInfo("Got double nulls, clear line",this,a),a.reset();continue}s.logDebug("Got a null, ignore point",this,a)}}}},removeRowExecution:function(t){for(var e in this.chartArray)this.deleteChartLine(t,e)},deleteChartLine:function(t,e){if(this.chartArray[e]){var i=this.chartArray[e][t];i.reset(),i.clearLabels(),this.painter.removeLine(i),delete this.chartArray[e][t],this.dispatchEvent("onRemovedLine",[t,i]),s.logDebug("Line removed",this,t,e)}},clean:function(){this._callSuperMethod(i,"clean"),this.clearLabels(),this.painter&&this.painter.clean(),delete this.painter,this.setChartAnchor(this.caContainer.parentNode,!0),s.logDebug("Cleaned all",this)},parseHtml:function(){s.logInfo("Parse html for Chart",this);var e=document.getElementById(this.id);if(e){if(!st.verifyTag(e))throw new B(t);this.setChartAnchor(e),this.parsed=!0}},configureArea:function(t,e,s,i,n){if(t&&(this.areaClass=t),i&&(this.offsetY=this.checkPositiveNumber(i,!0)),n&&(this.offsetX=this.checkPositiveNumber(n,!0)),e&&(this.screenY=this.checkPositiveNumber(e,!0)),s&&(this.screenX=this.checkPositiveNumber(s,!0)),this.configurePainter(),s||e)for(var r in s&&null!=this.xMax&&(this.calcXUnit(),this.paintXLabels()),this.chartArray)for(var a in this.chartArray[r]){var o=this.chartArray[r][a];o&&o.isYAxisPositioned()&&null!=this.xMax&&(e&&(o.calcYUnit(),o.paintYLabels()),o&&!o.isEmpty()&&o.repaint())}},setXAxis:function(t,e){this.xFieldCode=t,this.xParser=e,this.clean(),s.logDebug("X axis is now configured on field",t,this)},addYAxis:function(t,e){if(V.isArray(t)){s.logDebug("Configuring multiple Y axis",this);for(var i=0;i<t.length;i++)V.isArray(e)?this.addYAxis(t[i],e[i]):this.addYAxis(t[i],e)}else this.chartArray[t]||(this.chartArray[t]={}),this.yParsers[t]=e,s.logDebug("Y axis is now configured on field",t,this)},removeYAxis:function(t){if(V.isArray(t)){s.logDebug("removing multiple Y axis",this);for(var e=0;e<t.length;e++)this.removeYAxis(t[e])}else{if(!this.chartArray[t])return;for(var i in this.chartArray[t])this.deleteChartLine(i,t);delete this.chartArray[t],delete this.yParsers[t],s.logDebug("Y axis is now removed",t,this)}},positionXAxis:function(t,e){if(this.xMax=Number(e),this.xMin=Number(t),isNaN(this.xMax)||isNaN(this.xMin))throw new Y("Min and max must be numbers");if(this.xMin>this.xMax)throw new Y("The maximum value must be greater than the minimum value");null!=this.screenX&&(this.calcXUnit(),this.paintXLabels()),this.repaintAll(),s.logDebug("X axis is now positioned",this)},setXLabels:function(t,e,i){this.numXLabels=this.checkPositiveNumber(t,!0),this.classXLabels=e,this.labelsFormatter=i||null,null!=this.xUnit&&this.paintXLabels(),s.logDebug("X labels now configured",this)},addListener:function(t){this._callSuperMethod(i,"addListener",[t])},removeListener:function(t){this._callSuperMethod(i,"removeListener",[t])},getListeners:function(){return this._callSuperMethod(i,"getListeners")}},i.prototype.parseHtml=i.prototype.parseHtml,i.prototype.configureArea=i.prototype.configureArea,i.prototype.setXAxis=i.prototype.setXAxis,i.prototype.addYAxis=i.prototype.addYAxis,i.prototype.removeYAxis=i.prototype.removeYAxis,i.prototype.positionXAxis=i.prototype.positionXAxis,i.prototype.setXLabels=i.prototype.setXLabels,i.prototype.addListener=i.prototype.addListener,i.prototype.removeListener=i.prototype.removeListener,i.prototype.getListeners=i.prototype.getListeners,i.prototype.clean=i.prototype.clean,i.prototype.onListenStart=i.prototype.onListenStart,i.prototype.updateRowExecution=i.prototype.updateRowExecution,i.prototype.removeRowExecution=i.prototype.removeRowExecution,U(i,et),i}(),at=function(){function t(t){var s=!1;for(var i in t)e(t[i])?s=!0:delete t[i];return s}function e(t){if(t.isCell)return t.isAttachedToDOMById();for(var e=!1,s=0;s<t.length;)t[s].isAttachedToDOMById()?(e=!0,s++):t.splice(s,1);return e}function s(t,e){var s=new st(document.createElement("p"));s.scrollHere(t,e);var i=t.getNum();return s.getNum=function(){return i},s}function i(t){if(t.isCell)t.clean();else for(var e=0;e<t.length;e++)t[e].clean()}function n(t,e){if(t.isCell)return s(t,e);for(var i=[],n=0;n<t.length;n++)i[n]=s(t[n],e);return i}var r=function(t){this._callSuperConstructor(r,[t])};return r.scrollRow=function(t,e,r){var a={};for(var o in t)a[o]=!0;if(e)for(var o in e)a[o]=!0;else e={};for(var h in a)if(t[h])if(e[h])if(e[h].isCell&&t[h].isCell)e[h].scrollHere(t[h],r);else{var u=t[h].isCell?[t[h]]:t[h];if(e[h].isCell){var l=e[h];e[h]=[l]}for(var c=[].concat(e[h]),d=0;d<u.length;d++){for(var _=!1,p=0;p<c.length;p++)if(c[p].getNum()===u[d].getNum()){c[p].scrollHere(u[d],r),_=!0,c.splice(p,1);break}_||e[h].push(s(u[d],r))}i(c)}else e[h]=n(t[h],r);else i(e[h]);return e},r.prototype={alreadyInList:function(t){var e=this.getCell(t.getRow(),t.getField());if(!e)return!1;if(e.isCell)return e.isSameEl(t);for(var s=0;s<e.length;s++)if(e[s].isSameEl(t))return!0;return!1},addCell:function(t,e,s){e=e||t.getRow(),s=s||t.getField();var i=this.getCell(e,s);if(i)if(i.isCell){var n=[i,t];this.insert(n,e,s)}else i.push(t);else this.insert(t,e,s)},forEachCell:function(t){var e=this;this.forEachElement((function(s,i,n){e.forEachCellInElement(s,i,n,t)}))},forEachCellInRow:function(t,e){var s=this;this.forEachElementInRow(t,(function(t,i,n){s.forEachCellInElement(t,i,n,e)}))},forEachCellInPosition:function(t,e,s){var i=this.get(t,e);i&&this.forEachCellInElement(i,t,e,s)},forEachCellInElement:function(t,e,s,i){if(t.isCell)i(t,e,s);else for(var n=0;n<t.length;n++)i(t[n],e,s,t[n].getNum())},getCell:function(t,e,s){if(s){var i=this.get(t,e);if(i)if(i.isCell){if(i.getNum()==s)return i}else for(var n=0;n<i.length;n++)if(i[n].getNum()==s)return i[n];return null}return this.get(t,e)},cellsGarbageCollection:function(){var e=this.getEntireMatrix();for(var s in e)t(e[s])||delete e[s]}},U(r,W,!1,!0),r}(),ot=function(){var t=j.isProbablyAWebkit()&&j.isProbablyChrome(32,!0)?null:"about:blank",e={},s={createFrame:function(s,i){if(!H.isBrowserDocument())return null;var n=document.getElementsByTagName("BODY")[0];if(!n)return null;i=i||t;var r=document.createElement("iframe");r.style.visibility="hidden",r.style.height="0px",r.style.width="0px",r.style.display="none",r.name=s,r.id=s,j.isProbablyIE()||j.isProbablyOldOpera()?(r.src=i,n.appendChild(r)):(n.appendChild(r),r.src=i);try{if(r.contentWindow){try{r.contentWindow.name=s}catch(t){}return e[s]=r.contentWindow,e[s]}return document.frames&&document.frames[s]?(e[s]=document.frames[s],e[s]):null}catch(t){return null}},getFrameWindow:function(t,s,i){return s&&!e[t]&&this.createFrame(t,i),e[t]||null},disposeFrame:function(t){if(e[t]){try{document.getElementsByTagName("BODY")[0].removeChild(document.getElementById(t))}catch(t){}delete e[t]}},removeFrames:function(){for(var t in e)try{document.getElementsByTagName("BODY")[0].removeChild(document.getElementById(t))}catch(t){}e={}}};return s.createFrame=s.createFrame,s.getFrameWindow=s.getFrameWindow,s.disposeFrame=s.disposeFrame,s.removeFrames=s.removeFrames,X.addUnloadHandler(s.removeFrames),s}(),ht=function(){H.browserDocumentOrDie();var t=G.getLoggerProxy("lightstreamer.grids");function e(e){if(0==e.indexOf("#")&&(e=e.substring(1,e.length)),3==e.length)e=e.charAt(0)+e.charAt(0)+e.charAt(1)+e.charAt(1)+e.charAt(2)+e.charAt(2);else if(6!=e.length)return t.warn("A hexadecimal color value must be 3 or 6 character long. An invalid value was specified, will be ignored"),null;var s=e.substring(0,2),i=e.substring(2,4),r=e.substring(4,6),a=n(s),o=n(i),h=n(r);return null==a||null==o||null==h?null:[a,o,h]}var s={A:10,B:11,C:12,D:13,E:14,F:15};function i(e){return e>=0&&e<=9?new Number(e):(e=e.toUpperCase(),s[e]?s[e]:(t.warn("A hexadecimal number must contain numbers between 0 and 9 and letters between A and F. An invalid value was specified, will be ignored"),null))}function n(t){var e,s=0,n=0;for(e=t.length;e>=1;e--){var r,a=i(t.substring(e-1,e));if(null==a)return null;for(r=1;r<=n;r++)a*=16;n++,s+=a}return s}function r(e){if(e.indexOf("%")==e.length-1){if((e=parseFloat(e.substring(0,e.length-1)))>100||e<0)return t.warn("A RGB element must be a number >=0 and <=255 or a percentile >=0 and <=100. An invalid value was specified, will be ignored"),null;e*=2.55}return e}function a(t,e){return!(!t||""==t||e&&t==e)}function o(t){var e=document.createElement("DIV");e.style.backgroundColor=t;var s=f.getStyle(e,c,t);if(null==s)return null;if(255==s[0]&&255==s[1]&&255==s[2]&&"WHITE"!=t.toUpperCase()){var i=document.getElementsByTagName("BODY")[0];i&&(i.appendChild(e),s=f.getStyle(e,c,t),i.removeChild(e))}return _[t]=s,_[t]}function h(t){var s="";if(_[t])return _[t];if(!j.isProbablyIE())return o(t);try{(p=ot.getFrameWindow("weswit__ColorFrame",!0))&&(p.document.bgColor=t,s=p.document.bgColor)}catch(t){s=null}if(!s||s==t){var i=document.bgColor;document.bgColor=t,s=document.bgColor,document.bgColor=i}return s&&s!=t?(_[t]=e(s),_[t]):o(t)}function u(e){var s,i;if(0==e.indexOf("rgb("))s=4,i=")";else{if(0!=e.indexOf("rgba("))return t.warn("A RGB color value must be in the form 'rgb(x, y, z)' or 'rgba(x, y, z, a)'. An invalid value was specified, will be ignored"),null;s=5,i=","}var n=(e=e.substring(s,e.length)).indexOf(","),a=r(e.substring(0,n)),o=e.indexOf(",",n+1),h=r(e.substring(n+1,o)),u=e.indexOf(i,o+1),l=r(e.substring(o+1,u));return null==a||null==h||null==l?null:[a,h,l]}var l="background-color",c="backgroundColor",d="transparent",_={},p=null,f={translateToRGBArray:function(t){return 0==t.indexOf("rgb")?u(t):0==t.indexOf("#")?e(t):h(t)},getStyle:function(t,e,s){if(null==t)return[255,255,255];var i="";try{if(window.getComputedStyle||document.defaultView&&document.defaultView.getComputedStyle){var n=document.defaultView.getComputedStyle(t,null);if(n){var r=e==c?l:e;i=n.getPropertyValue(r)}}}catch(t){}try{!a(i,s)&&t.currentStyle&&(r=e==l?c:e,i=t.currentStyle[r])}catch(t){}try{if(!a(i,s)){var o=e==l?c:e;if(""==t.style[o])return[255,255,255];i=t.style[o]}}catch(t){}return i==d&&t.parentNode?this.getStyle(t.parentNode,e):i==d?[255,255,255]:a(i,s)?this.translateToRGBArray(i):[255,255,255]}};return f}(),ut=function(){H.browserDocumentOrDie();var t=function(t){this.fadeInterval=t,this.freeFaders=new s,this.faderId=0,this.faderList={},this.fadeThread=!1,this.runningFaders={}};function e(t){return function(){t.style.backgroundColor="transparent"}}t.prototype={getNewFaderId:function(t,e,s,n,r,a){var o=this.getHowManySteps(r),h=t.incFadePhase();if(h){var u=this.freeFaders.get();return null==u?(this.faderList[this.faderId]=new i(t,e,s,n,o,h,a),this.faderId++):(this.faderList[u].init(t,e,s,n,o,h,a),u)}},getHowManySteps:function(t){var e=t/this.fadeInterval;return e>1?e:1},launchFader:function(t){var e=this.faderList[t],s=e.cell.getFadePhase();if(s){if(!(e.phase<s)){var i=this.runningFaders[e.cell.getCellId()],n=this.faderList[i];n&&(n.goingDown||(e.goingDown?n.endCommand&&Z.executeTask(n.endCommand):(e.actStep=n.actStep,e.steps<n.steps&&(e.steps=n.steps))),this.freeFaders.put(i)),this.runningFaders[e.cell.getCellId()]=t,e.endBack&&(e.startBack=ht.getStyle(e.cell.getEl(),"backgroundColor")),e.endFore&&(e.startFore=ht.getStyle(e.cell.getEl(),"color")),this.fadeThread||this.fadeThreadStart(this.fadeInterval)}}else this.stopFader(e.cell)},stopFader:function(t){var e=this.runningFaders[t.getCellId()];(e||0==e)&&(delete this.runningFaders[t.getCellId()],this.freeFaders.put(e))},doFade:function(t){var s=V.getTimeStamp(),i=0;t&&(i=s-(t+this.fadeInterval));var n=!1;for(var r in this.runningFaders){var a=this.runningFaders[r],o=this.faderList[a];if(o.actStep>o.steps)this.freeFaders.put(a),delete this.runningFaders[r],o.endCommand&&Z.addPackedTimedTask(o.endCommand,0);else{var h=o.cell.getEl();if(!h){this.stopFader(o.cell);continue}if("transparent"==o.endBack)try{h.style.backgroundColor="rgba("+o.startBack[0]+","+o.startBack[1]+","+o.startBack[2]+","+this.easeInOut(100,0,o.steps,o.actStep)/100+")"}catch(t){var u=(o.steps-o.actStep)*this.fadeInterval;Z.addTimedTask(e(h),u),o.endCommand&&Z.addPackedTimedTask(o.endCommand,u),this.stopFader(o.cell);continue}else o.endBack&&(h.style.backgroundColor="rgb("+this.easeInOut(o.startBack[0],o.endBack[0],o.steps,o.actStep)+","+this.easeInOut(o.startBack[1],o.endBack[1],o.steps,o.actStep)+","+this.easeInOut(o.startBack[2],o.endBack[2],o.steps,o.actStep)+")");o.endFore&&(h.style.color="rgb("+this.easeInOut(o.startFore[0],o.endFore[0],o.steps,o.actStep)+","+this.easeInOut(o.startFore[1],o.endFore[1],o.steps,o.actStep)+","+this.easeInOut(o.startFore[2],o.endFore[2],o.steps,o.actStep)+")"),n=!0}o.actStep++}if(n){var l=V.getTimeStamp(),c=l-s+i;if(c>this.fadeInterval){var d=c/this.fadeInterval,_=Math.floor(d),p=d-_;this.recoverCycles(_),c=this.fadeInterval*p}this.nextFade(this.fadeInterval-c,l)}else this.fadeThread=!1},nextFade:function(t,e){Z.addTimedTask(this.doFade,t,this,[e])},recoverCycles:function(t){for(var e in this.runningFaders){var s=this.runningFaders[e],i=this.faderList[s];i.actStep>i.steps||(i.actStep+t<i.steps?i.actStep+=t:i.actStep=i.steps)}},fadeThreadStart:function(t){1!=this.fadeThread&&(this.fadeThread=!0,this.nextFade(t))},easeInOut:function(t,e,s,i){var n=(t=new Number(t))+1/s*i*((e=new Number(e))-t);return Math.ceil(n)},fadeCell:function(t,e,s,i,n){var r=Z.packTask(n),a=new st(t),o=this.getNewFaderId(a,!1,e,s,i,r);return this.launchFader(o),o}};var s=function(){this.length=0,this.pile={}};s.prototype={put:function(t){this.pile[this.length]=t,this.length++},get:function(){return this.length<=0?null:(this.length--,this.pile[this.length])}};var i=function(t,e,s,i,n,r,a){this.init(t,e,s,i,n,r,a)};return i.prototype={init:function(t,e,s,i,n,r,a){this.endCommand=a||null,this.goingDown=e,this.cell=t,this.endBack=""===s||"transparent"==s?"transparent":s?ht.translateToRGBArray(s):null,this.endFore=i?ht.translateToRGBArray(i):null,this.steps=n,this.phase=r,this.actStep=0}},t}(),lt=function(){H.browserDocumentOrDie();var t="backgroundColor",e="color",s="The given array is not valid or empty",i="The given value is not valid, use UPDATE_IS_KEY or ITEM_IS_KEY.",n="This method can only be called while the grid is empty.",r=["div","span","input"];function a(t){return null===t?"":t}var o=G.getLoggerProxy("lightstreamer.grids"),h=function(){this._callSuperConstructor(h,arguments),this.useInner=!1,this.fieldSymbols=null,this.tagsToCheck=r,this.addOnTop=!1,this.sortField=null,this.descendingSort=!1,this.numericSort=!1,this.commaAsDecimalSeparator=!1,this.fader=new ut(50),this.currentUpdateKey=null,this.currentUpdateValues=null,this.rowCount=0,this.maxRow=0,this.grid=new at};return h.prototype={mergeUpdate:function(t,e){for(var s in o.isDebugLogEnabled()&&o.logDebug("Merging this update values with the values of the current update",this),e)this.currentUpdateValues[s]=e[s];this.fillFormattedValues(this.currentUpdateKey,e)},fillFormattedValues:function(t,e){for(var s in e)this.grid.forEachCellInPosition(t,s,(function(i){o.isDebugLogEnabled()&&o.logDebug("Filling formatted values in cell",t,s),i.setNextFormattedValue(a(e[s]))}))},isBefore:function(t,e){return null!=t&&null!=e||t==e?this.descendingSort?t>e:t<e:null==t?!this.descendingSort:this.descendingSort},setHtmlInterpretationEnabled:function(t){this.useInner=this.checkBool(t)},isHtmlInterpretationEnabled:function(){return this.useInner},setNodeTypes:function(t){if(!(t&&t.length>0))throw new Y(s);this.tagsToCheck=t},getNodeTypes:function(){return this.tagsToCheck},setAddOnTop:function(t){null!=this.sortField&&o.logWarn("Scroll direction is ignored if sort is enabled"),this.addOnTop=this.checkBool(t)},isAddOnTop:function(){return this.addOnTop},setSort:function(t,e,s,i){t?(this.sortField=t,this.descendingSort=this.checkBool(e,!0),this.numericSort=this.checkBool(s,!0),this.commaAsDecimalSeparator=this.checkBool(i,!0),this.sortTable()):this.sortField=null},getSortField:function(){return this.sortField},isDescendingSort:function(){return null===this.sortField?null:this.descendingSort},isNumericSort:function(){return null===this.sortField?null:this.numericSort},isCommaAsDecimalSeparator:function(){return null!==this.sortField&&this.numericSort?this.commaAsDecimalSeparator:null},extractFieldList:function(){return this.extractTypedFieldList(st.FIRST_LEVEL)},extractCommandSecondLevelFieldList:function(){return this.extractTypedFieldList(st.SECOND_LEVEL)},parseHtml:function(){},forceSubscriptionInterpretation:function(t){if(this.rowCount>0)throw new B(n);if(t){if(t!=et.UPDATE_IS_KEY&&t!=et.ITEM_IS_KEY)throw new Y(i);this.kind=t,this.forcedInterpretation=!0}else this.forcedInterpretation=!1,this.chooseInterpretation()},extractTypedFieldList:function(t){var e=this.computeFieldSymbolsSet(t),s=[];for(var i in e)s.push(i);return s},makeSortValue:function(t){return this.numericSort?V.getNumber(t,this.commaAsDecimalSeparator):null===t?t:new String(t).toUpperCase()},visualUpdateExecution:function(s,i,n){n=n||s;var r=i.coldToHotTime,a=r+i.hotTime,o=a+i.hotToColdTime,h=i.hotRowStyle,u=i.coldRowStyle,l=[],c=this.grid.getRow(s);for(var d in c)for(var _=-1,p=c[d],f=0;p&&(p.isCell||f<p.length);f++){var m=p.isCell?p:p[f];p=p.isCell?null:p,null===m.getNum()&&_++;var g=this.getSlidingCell?this.getSlidingCell(m,n,d,m.getNum(),_):m;if(null!=m.getNextFormattedValue()){var v=m.setUpdating(),S=m.getNextColdArray(u),y=m.getNextHotArray(h);if(y){var b=!1,E=!1,w=!1,T=null,R=null,I=null,C=null;if(y&&(y[t]&&(b=!0,T=y[t],R=S[t]),y[e]&&(b=!0,I=y[e],C=S[e])),b){if(r>0){var x=Z.packTask(g.asynchUpdateValue,g,[v,this.useInner]),L=this.fader.getNewFaderId(g,!1,T,I,r,x);this.fader.launchFader(L),E=!0}else this.fader.stopFader(g);if(i.hotToColdTime>0){var N=Z.packTask(g.asynchUpdateStyles,g,[v,st.COLD]);L=this.fader.getNewFaderId(g,!0,R,C,i.hotToColdTime,N),Z.addTimedTask(this.fader.launchFader,a,this.fader,[L]),w=!0}}if(!E)if(r>0)Z.addTimedTask(g.asynchUpdateValue,r,g,[v,this.useInner]);else{var M=Z.packTask(g.asynchUpdateValue,g,[v,this.useInner]);l.push(M)}w||Z.addTimedTask(g.asynchUpdateStyles,o,g,[v,st.COLD])}else r>0?Z.addTimedTask(g.asynchUpdateValue,r,g,[v,this.useInner]):(M=Z.packTask(g.asynchUpdateValue,g,[v,this.useInner]),l.push(M)),S&&(i.hotToColdTime>0?(R=S[t],C=S[e],N=Z.packTask(g.asynchUpdateStyles,g,[v,st.COLD]),L=this.fader.getNewFaderId(g,!0,R,C,i.hotToColdTime,N),Z.addTimedTask(this.fader.launchFader,a,this.fader,[L])):Z.addTimedTask(g.asynchUpdateStyles,o,g,[v,st.COLD]))}}for(var D=0;D<l.length;D++)Z.executeTask(l[D])},updateRowExecution:function(t,e){},removeRowExecution:function(t){},sortTable:function(){},computeFieldSymbolsSet:function(t){}},h.prototype.setHtmlInterpretationEnabled=h.prototype.setHtmlInterpretationEnabled,h.prototype.isHtmlInterpretationEnabled=h.prototype.isHtmlInterpretationEnabled,h.prototype.setNodeTypes=h.prototype.setNodeTypes,h.prototype.getNodeTypes=h.prototype.getNodeTypes,h.prototype.setAddOnTop=h.prototype.setAddOnTop,h.prototype.isAddOnTop=h.prototype.isAddOnTop,h.prototype.setSort=h.prototype.setSort,h.prototype.getSortField=h.prototype.getSortField,h.prototype.isDescendingSort=h.prototype.isDescendingSort,h.prototype.isNumericSort=h.prototype.isNumericSort,h.prototype.isCommaAsDecimalSeparator=h.prototype.isCommaAsDecimalSeparator,h.prototype.extractFieldList=h.prototype.extractFieldList,h.prototype.extractCommandSecondLevelFieldList=h.prototype.extractCommandSecondLevelFieldList,h.prototype.parseHtml=h.prototype.parseHtml,h.prototype.forceSubscriptionInterpretation=h.prototype.forceSubscriptionInterpretation,h.prototype.updateRowExecution=h.prototype.updateRowExecution,h.prototype.removeRowExecution=h.prototype.removeRowExecution,U(h,et),h}(),ct=function(){var t=function(){};return t.prototype={init:function(){this.length=0,this.hashMap={},this.oneMap||(this.map={})}},t}(),dt=function(){var t=function(e,s,i){this._callSuperConstructor(t),this.domNode=e,this.toInsBefore=s,this.offsetIndex=i,this.oneMap=!0,this.topChild=this.toInsBefore,this.init()};return t.prototype={removeChild:function(t){if(!(this.length<=0)){this.length--,delete this.hashMap[t.getId()];var e=t.element();e==this.topChild&&(this.topChild=e.nextSibling),this.domNode.removeChild(e),t.setParentNode(null)}},insertBefore:function(t,e){e!=t&&t&&(e&&null!=this.hashMap[e.getId()]?(this.insertOperation(t),this.domNode.insertBefore(t.element(),e.element())):this.appendChild(t,!0))},appendChild:function(t,e){if(t){this.insertOperation(t);var s=t.element();e?(this.topChild||(this.topChild=s),this.toInsBefore?this.domNode.insertBefore(s,this.toInsBefore):this.domNode.appendChild(s)):(this.domNode.insertBefore(s,this.topChild),this.topChild=s)}},insertOperation:function(t){t.isSonOf(this)||(this.length++,this.hashMap[t.getId()]=t,t.isolation(),t.setParentNode(this))},getChild:function(t){if(this.length<=t)return null;t+=this.offsetIndex;var e=this.domNode.childNodes[t].getAttribute("id");return this.getElementById(e)},getElementById:function(t){return this.hashMap[t]},clean:function(){for(var t in this.domNode&&delete this.domNode,this.toInsBefore&&delete this.toInsBefore,this.hashMap)this.hashMap[t].clean()}},U(t,ct),t}(),_t=function(){var t=function(){this._callSuperConstructor(t),this.oneMap=!1,this.init()};return t.prototype={removeChild:function(t){if(!(this.length<=0)){var e;for(this.length--,e=this.hashMap[t.getId()];e<this.length;e++)this.map[e]=this.map[e+1],this.hashMap[this.map[e].getId()]=e;this.hashMap[t.getId()]=null,this.map[this.length]=null,t.setParentNode(null)}},insertBefore:function(t,e){if(e!=t&&t)if(e)if(null!=this.hashMap[e.getId()]){t.isolation();for(var s=this.hashMap[e.getId()],i=this.length;i>=s+1;i--)this.map[i]=this.map[i-1],this.hashMap[this.map[i].getId()]=i;this.insertOperation(t,s)}else this.appendChild(t,!0);else this.appendChild(t,!0)},appendChild:function(t,e){t&&(t.isolation(),e||0==this.length?this.insertOperation(t,this.length):this.insertBefore(t,this.map[0]))},insertOperation:function(t,e){this.length++,this.hashMap[t.getId()]=e,this.map[e]=t,t.setParentNode(this),t.invisible()},getChild:function(t){return this.map[t]},getElementById:function(t){return this.map[this.hashMap[t]]},clean:function(){for(var t=0;t<this.length;t++)this.map[t].clean()}},U(t,ct),t}(),pt=function(){var t=function(t,e){this.key=t,this.ownerTable=e,this.myParent=null,this.node=null,this.id="hc6|"+e.getId()+"|"+t};return t.prototype={invisible:function(){this.node},getParentNode:function(){return this.myParent},setParentNode:function(t){this.myParent=t},isolation:function(){this.myParent&&this.myParent.removeChild(this)},isSonOf:function(t){return this.myParent==t},getKey:function(){return this.key},getId:function(){return this.id},element:function(){if(null!=this.node)return this.node;this.node=this.ownerTable.getTemplateClone(),this.node.setAttribute("id",this.id);for(var t=st.getLSTags(this.node,this.ownerTable.getNodeTypes()),e=0;e<t.length;e++){var s=t[e],i=s.getField();i&&this.ownerTable.onNewCell(s,this.key,i)}return this.node},clean:function(){this.node&&delete this.node}},t}(),ft=function(){var t=G.getLoggerProxy("lightstreamer.grids"),e="No cell defined for this field",s=1200,i=function(){this.cellsGrid=arguments[0],this.updatingRow=arguments[1],this.key=arguments[2],this.coldToHotTime=0,this.hotToColdTime=0,this.hotTime=s,this.hotRowStyle=null,this.coldRowStyle=null};return i.prototype={getCellValue:function(t,s){var i=this.cellsGrid.getCell(this.key,t,s);if(!i)throw new Y(e);return i.isCell||(i=i[0]),i.getNextFormattedValue()||i.retrieveValue()},setCellValue:function(t,s,i){var n=this.cellsGrid.getCell(this.key,t,i);if(!n)throw new Y(e);if(n.isCell)n.setNextFormattedValue(s);else for(var r=0;r<n.length;r++)n[r].setNextFormattedValue(s)},getChangedFieldValue:function(t){return this.updatingRow[t]||null},setHotTime:function(t){this.hotTime=this.checkPositiveNumber(t,!0)},setColdToHotTime:function(t){this.coldToHotTime=this.checkPositiveNumber(t,!0)},setHotToColdTime:function(t){this.hotToColdTime=this.checkPositiveNumber(t,!0)},addStyle:function(t,s,i,n,r){var a=this.cellsGrid.getCell(this.key,t,r);if(!a)throw new Y(e);if(a.isCell)a.addStyle(s,i,n);else for(var o=0;o<a.length;o++)a[o].addStyle(s,i,n)},addRowStyle:function(t,e,s){this.hotRowStyle||(this.hotRowStyle={},this.coldRowStyle={}),this.hotRowStyle[s]=t||"",this.coldRowStyle[s]=e||""},setAttribute:function(t,e,s){this.addRowStyle(t,e,s)},setStyle:function(t,e){this.addRowStyle(t,e,"CLASS")},setCellAttribute:function(t,e,s,i,n){this.addStyle(t,e,s,i,n)},setCellStyle:function(t,e,s,i){this.addStyle(t,e,s,"CLASS",i)},forEachChangedField:function(e){for(var s in this.updatingRow)try{e(s,this.updatingRow[s])}catch(e){t.logError("Exception thrown while executing the iterator Function",e)}}},i.prototype.getCellValue=i.prototype.getCellValue,i.prototype.setCellValue=i.prototype.setCellValue,i.prototype.getChangedFieldValue=i.prototype.getChangedFieldValue,i.prototype.setHotTime=i.prototype.setHotTime,i.prototype.setColdToHotTime=i.prototype.setColdToHotTime,i.prototype.setHotToColdTime=i.prototype.setHotToColdTime,i.prototype.setAttribute=i.prototype.setAttribute,i.prototype.setStyle=i.prototype.setStyle,i.prototype.setCellAttribute=i.prototype.setCellAttribute,i.prototype.setCellStyle=i.prototype.setCellStyle,i.prototype.forEachChangedField=i.prototype.forEachChangedField,U(i,K,!0,!0),i}(),mt=function(){var t=G.getLoggerProxy("weswit.test"),e=0,s={},i={VOID:s,getFailures:function(){return e},compareArrays:function(e,s,i){if(e.length!=s.length)return this.failInternal(),t.logError("Wong length!",e,s),!1;if(i){for(r=0;r<e.length;r++)if(e[r]!=s[r])return t.logError("Wrong  element",e[r],s[r]),this.failInternal(),!1}else{for(var n={},r=0;r<e.length;r++)n[e[r]]=1;for(var r=0;r<s.length;r++){if(!n[s[r]])return t.logError("Missing from first array",s[r]),this.failInternal(),!1;n[s[r]]++}for(var r in n)if(1==n[r])return t.logError("Missing from second array",n[r]),this.failInternal(),!1}return!0},verifySuccess:function(t,e,s,i,n){return this.verify(t,e,s,i,!1,n)},verifyException:function(t,e,s){return this.verify(t,e,s,null,!0)},verifyNotNull:function(e){return null!==e||(this.failInternal(),t.logError("Not expecting a NULL",e),!1)},verifyValue:function(e,s,i){var n=!1;if(!0===i)n=e===s;else if(i)n=i(e,s);else if(isNaN(e))n=e==s;else{var r=e&&e.charAt?e.charAt(0):null,a=s&&s.charAt?s.charAt(0):null;n="."==r||" "==r||"0"==r||"."==a||" "==a||"0"==a?String(e)==String(s):e==s}return!!n||(this.failInternal(),t.logError("Expecting a different value",e,s),!1)},verifyDiffValue:function(e,s,i){return!!(i?e!==s:e!=s)||(this.failInternal(),t.logError("Expecting 2 different values",e,s),!1)},verifyOk:function(e){return!!e||(this.failInternal(),t.logError("Expecting a valid value"),!1)},verifyNotOk:function(e){return!e||(this.failInternal(),t.logError("Expecting a not valid value"),!1)},fail:function(){return t.logError("ASSERT failed"),this.failInternal(),!1},failInternal:function(){e++},verify:function(e,i,n,r,a,o){var h=!1,u=null,l=null;try{u=n!==s?e[i].apply(e,n):e[i]()}catch(t){h=!0,l=t}var c=a?"succes":"failure";return a==h?!(!a&&r!==s)||this.verifyValue(u,r,o):(this.failInternal(),t.logError("Unexpected",c,"for",i,n,r,l),!1)}};return i.getFailures=i.getFailures,i.fail=i.fail,i.verifyNotOk=i.verifyNotOk,i.verifyOk=i.verifyOk,i.verifyDiffValue=i.verifyDiffValue,i.verifyNotNull=i.verifyNotNull,i.verifyValue=i.verifyValue,i.verifyException=i.verifyException,i.verifySuccess=i.verifySuccess,i.compareArrays=i.compareArrays,i}(),gt=function(){H.browserDocumentOrDie();var t="ELEMENT",e="PAGE",s="OFF",i="The given value is not a valid scroll type. Admitted values are OFF, ELEMENT, PAGE",n="No template defined",r="The template defined for the grid does not define the 'data-source' attribute",a="No valid cells defined for grid",o="This grid is configured to no support pagination",h="Can't switch pages while 'no-page mode' is used",u="Please specify an element id in order to use ELEMENT autoscroll",l=G.getLoggerProxy("lightstreamer.grids"),c=function(t,e){this._callSuperConstructor(c,[t]),this.pageNumber=1,this.currentPages=0,this.autoScrollElement=null,this.autoScrollType=s,this.initDOM(),(e=this.checkBool(e,!0))&&this.parseHtml()};return c.prototype={toString:function(){return["[",this.id,this.rowCount,this.currentPages,"]"].join("|")},setMaxDynaRows:function(t){t&&"unlimited"!=new String(t).toLowerCase()?this.maxRow=this.checkPositiveNumber(t,!0):this.maxRow=0,this.updateIsKey()?this.limitRows():(this.calculatePages(),this.sortTable(),this.changePage(1))},getMaxDynaRows:function(){return 0==this.maxRow?"unlimited":this.maxRow},goToPage:function(t){if(this.updateIsKey())throw new B(o);if(0==this.maxRow)throw new B(h);t=this.checkPositiveNumber(t),this.changePage(t)},getCurrentPages:function(){return 0==this.maxRow?1:this.currentPages},setAutoScroll:function(n,r){if(!n)throw new Y(i);if((n=new String(n).toUpperCase())==t){if(!r)throw new Y(u);this.autoScrollElement=r}else if(n!=e&&n!=s)throw new Y(i);this.autoScrollType=n,this.prepareAutoScroll()},parseHtml:function(){this.parsed=!0;var t=this.clonedNode;if(t){if(st.isAttachedToDOM(t))return!0;this.initDOM()}if(t=document.getElementById(this.id),!this.templateControl(t))return!1;this.template=t.cloneNode(!0),this.template.removeAttribute("id"),this.clonedNode=t;var e=t.parentNode;this.nodeContainer=e,t.style.display="none";var s=e.childNodes,i=0,n=0,r=null;for(i=0;i<s.length;i++)if(s[i]==t){s[i+1]&&(r=s[i+1]),n=i+1;break}return this.clonedContainer=new dt(e,r,n),this.nextParent=new _t,this.prevParent=new _t,!0},computeFieldSymbolsSet:function(t){for(var e=this.clonedNode,s=st.getLSTags(e,this.tagsToCheck),i={},n=0;n<s.length;n++)if(s[n].getFieldType()==t){var r=s[n].getField();r&&(i[r]=!0)}return i},templateControl:function(t){if(!t)throw new Y(n);if(!st.verifyTag(t))throw new Y(r);for(var e=[],s=st.getLSTags(t,this.tagsToCheck),i=0;i<s.length;i++)s[i].getField()&&e.push(s[i]);if(e.length<=0)throw new Y(a);return!0},prepareAutoScroll:function(){if(this.autoScrollType==t)if(this.autoScrollElement&&this.autoScrollElement.appendChild);else{var e=document.getElementById(this.autoScrollElement);e?this.autoScrollElement=e:(l.logError("Cannot find the scroll element",this),this.autoScrollType=s)}},initDOM:function(){this.clonedNode=null,this.template=null,this.nodeContainer=null,this.clonedContainer=null,this.nextParent=null,this.prevParent=null,this.clonesArray={}},getTemplateClone:function(){return this.template.cloneNode(!0)},onNewCell:function(t,e,s){this.grid.addCell(t,e,s)},clean:function(){this._callSuperMethod(c,"clean")},willAutoScroll:function(){if(this.autoScrollType==s)return!1;if(this.updateIsKey()){var e=this.autoScrollType==t?this.autoScrollElement:document.body;return this.addOnTop?0==e.scrollTop:!!j.isProbablyOldOpera()||Math.abs(e.clientHeight+e.scrollTop-e.scrollHeight)<=1}return!0},getNewScrollPosition:function(t){var s=this.autoScrollType==e?document.body:this.autoScrollElement;return this.updateIsKey()?this.addOnTop?0:s.scrollHeight-s.clientHeight:t.offsetTop-s.offsetTop},doAutoScroll:function(t){l.isDebugLogEnabled()&&l.logDebug("Perform auto-scroll",this,t),this.autoScrollType==e?window.scrollTo(0,t):this.autoScrollElement.scrollTop=t},sortTable:function(){for(var t=this.sortField,e=new _t,s=1;this.rowCount>0;){var i=this.getNodeByIndex(s);if(i)if(null!=t){var n=i.getKey();if(""!=n){for(var r=this.makeSortValue(this.values.get(n,this.sortField)),a=0,o=e.length-1;a<o;){var h=Math.floor((a+o)/2),u=e.getChild(h),c=this.makeSortValue(this.values.get(u.getKey(),this.sortField));c||l.logWarn("Can't find value for sort key field",this),this.isBefore(r,c)?o=h-1:a=h+1}if(u=e.getChild(a),a==o){var d=this.makeSortValue(this.values.get(u.getKey(),this.sortField));if(this.isBefore(r,d))e.insertBefore(i,u);else{var _=e.getChild(o+1);_?e.insertBefore(i,_):e.appendChild(i,!0)}}else u?e.insertBefore(i,u):e.appendChild(i,!0);this.rowCount--}else this.rowCount--,s++}else e.appendChild(i,!0),this.rowCount--;else this.rowCount--,s++}for(var p=0;p<e.length;){this.rowCount++;var f=e.getChild(p);this.rowCount<=this.maxRow*(this.pageNumber-1)?this.prevParent.appendChild(f,!0):this.maxRow<=0||this.rowCount<=this.maxRow*this.pageNumber?this.clonedContainer.appendChild(f,!0):this.nextParent.appendChild(f,!0)}},changePage:function(t){if(!(this.rowCount<=0)){if(this.pageNumber>=t)for(;this.shiftDown(this.prevParent,this.clonedContainer,(t-1)*this.maxRow);)this.shiftDown(this.clonedContainer,this.nextParent,this.maxRow);else for(;this.fitFreeSpace(this.clonedContainer,this.prevParent,(t-1)*this.maxRow,!1);)this.fitFreeSpace(this.nextParent,this.clonedContainer,this.maxRow,!1);this.pageNumber=t}},calculatePages:function(){l.isDebugLogEnabled()&&l.logDebug("Calculate number of pages",this);var t=0;return t=this.maxRow<=0?1:Math.ceil(this.rowCount/this.maxRow),this.currentPages!=t&&(this.currentPages=t,this.dispatchEvent("onCurrentPagesChanged",[this.currentPages])),t},removeRowExecution:function(t){var e=this.clonesArray[t];if(e){this.rowCount--,this.calculatePages();var s=!1,i=this.prevParent,n=this.nextParent;this.dispatchEvent("onVisualUpdate",[t,null,e.element()]),this.updateIsKey()&&this.addOnTop&&null==this.sortField&&(s=this.addOnTop,i=this.nextParent,n=this.prevParent),e.isSonOf(this.clonedContainer)?(this.clonedContainer.removeChild(e),this.fitFreeSpace(n,this.clonedContainer,this.maxRow,s)):e.isSonOf(n)?n.removeChild(e):(this.prevParent.removeChild(e),this.fitFreeSpace(this.clonedContainer,i,this.maxRow*(this.pageNumber-1),s)&&this.fitFreeSpace(n,this.clonedContainer,this.maxRow,s)),this.grid.delRow(t),delete this.clonesArray[t]}},updateRowExecution:function(t,e){var s=!1,i=this.clonesArray[t];i||(i=new pt(t,this),this.clonesArray[t]=i,i.element()),mt.verifyOk(i),this.fillFormattedValues(t,e);var n=this.dispatchVisualUpdateEvent(t,e,i),r=this.willAutoScroll(),a=!this.values.getRow(t),o=null!=this.sortField?this.makeSortValue(this.values.get(t,this.sortField)):null,h=null!=this.sortField?this.makeSortValue(e[this.sortField]):null,u=o==h||!e[this.sortField]&&null!==e[this.sortField];if(null!=this.sortField&&0==u){var l=this.calculateSortedPosition(i,o,h);this.insertNodeAtIndex(l,i),a&&(this.rowCount++,s=!0)}else a&&(this.appendNode(i,!this.addOnTop),this.rowCount++,s=!0);if(this.visualUpdateExecution(t,n),this.updateInProgress=null,a&&this.updateIsKey()&&this.limitRows(),r&&i.isSonOf(this.clonedContainer)){var c=this.getNewScrollPosition(i.element());this.doAutoScroll(c)}s&&this.calculatePages()},dispatchVisualUpdateEvent:function(t,e,s){this.currentUpdateKey=t,this.currentUpdateValues=e;var i=new ft(this.grid,e,t);return this.dispatchEvent("onVisualUpdate",[t,i,s.element()]),this.currentUpdateKey=null,this.currentUpdateValues=null,i},calculateSortedPosition:function(t,e,s){for(var i=1,n=this.rowCount,r=-1;i<n;){var a=null;(r=Math.floor((i+n)/2))<=this.rowCount&&(a=(o=this.getNodeByIndex(r))==t?e:this.makeSortValue(this.values.get(o.getKey(),this.sortField))),this.isBefore(s,a)?n=r-1:i=r+1}if(i==n){var o=this.getNodeByIndex(i),h=this.makeSortValue(this.values.get(o.getKey(),this.sortField));return this.isBefore(s,h)?i:i+1}return i},getNodeByIndex:function(t){return t>this.rowCount||t<=0?null:t<=this.prevParent.length?this.prevParent.getChild(t-1):(t-=this.prevParent.length)<=this.clonedContainer.length?this.clonedContainer.getChild(t-1):(t-=this.clonedContainer.length,this.nextParent.getChild(t-1))},appendNode:function(t,e){var s=e?this.prevParent:this.nextParent,i=e?this.nextParent:this.prevParent;return i.length>0||this.clonedContainer.length==this.maxRow&&this.maxRow>0?(i.appendChild(t,e),i):this.clonedContainer.length>0||s.length==this.maxRow*(this.pageNumber-1)?(this.clonedContainer.appendChild(t,e),this.clonedContainer):(s.appendChild(t,e),s)},insertNodeAtIndex:function(t,e){if(!(t>this.rowCount+1||t<=0)&&e!=this.getNodeByIndex(t)){var s,i=e.getParentNode(),n=this.clonedContainer,r=this.nextParent,a=this.prevParent,o=this.getNodeByIndex(t);null==o?s=this.appendNode(e,!0):(s=o.getParentNode()).insertBefore(e,o),s==n?i&&i!=r?i==a&&this.fitFreeSpace(n,a,this.maxRow*(this.pageNumber-1),!1):this.shiftDown(n,r,this.maxRow):s==a?i!=a&&this.shiftDown(a,n,this.maxRow*(this.pageNumber-1))&&this.shiftDown(n,r,this.maxRow):s==r&&(i==a&&this.fitFreeSpace(n,a,this.maxRow*(this.pageNumber-1),!1),this.fitFreeSpace(r,n,this.maxRow,!1))}},fitFreeSpace:function(t,e,s,i){if(this.maxRow<=0)return!1;if(e.length<s&&t.length>0){var n=t.getChild(0);return e.appendChild(n,!i),!0}return!1},shiftDown:function(t,e,s){if(this.maxRow<=0)return!1;if(t.length>s){var i=t.getChild(t.length-1);return e.insertBefore(i,e.getChild(0)),!0}return!1},limitRows:function(){for(;this.maxRow>0&&this.rowCount>this.maxRow;)this.removeRow(this.getOldestKey())},addListener:function(t){this._callSuperMethod(c,"addListener",[t])},removeListener:function(t){this._callSuperMethod(c,"removeListener",[t])},getListeners:function(){return this._callSuperMethod(c,"getListeners")}},c.prototype.setMaxDynaRows=c.prototype.setMaxDynaRows,c.prototype.getMaxDynaRows=c.prototype.getMaxDynaRows,c.prototype.goToPage=c.prototype.goToPage,c.prototype.getCurrentPages=c.prototype.getCurrentPages,c.prototype.setAutoScroll=c.prototype.setAutoScroll,c.prototype.parseHtml=c.prototype.parseHtml,c.prototype.clean=c.prototype.clean,c.prototype.addListener=c.prototype.addListener,c.prototype.removeListener=c.prototype.removeListener,c.prototype.getListeners=c.prototype.getListeners,c.prototype.updateRowExecution=c.prototype.updateRowExecution,c.prototype.removeRowExecution=c.prototype.removeRowExecution,U(c,lt),c}(),vt=function(){var t=function(t,e){this.xSpan=t||60,e=(e||20)/100,this.moreY=1+e,this.lessY=1-e,this.handledLines=new Q,this.minY,this.maxY};return t.prototype={onListenStart:function(t){this.chartTable=t},onYOverflow:function(t,e,s,i,n){var r=(n-i)/2;if(s>n){var a=n+r;s>a&&(a=s),this.maxY=a,this.updateYAxis(i,a)}else if(s<i){var o=i-r;s<o&&(o=s),this.minY=o,this.updateYAxis(o,n)}},onXOverflow:function(t,e,s,i){if(e>i){var n=(i+s)/2,r=i-s;this.chartTable.positionXAxis(n,n+r)}},onNewLine:function(t,e,s,i){this.chartTable.positionXAxis(s,s+this.xSpan);var n=i*this.lessY,r=i*this.moreY;this.handledLines.add(e),this.minY=null!==this.minY&&this.minY<=n?this.minY:n,this.maxY=null!==this.maxY&&this.maxY>=r?this.maxY:r,this.updateYAxis(this.minY,this.maxY)},onRemovedLine:function(t,e){this.handledLines.remove(e)},updateYAxis:function(t,e){this.handledLines.forEach((function(s){s.positionYAxis(t,e)}))}},t.prototype.onListenStart=t.prototype.onListenStart,t.prototype.onYOverflow=t.prototype.onYOverflow,t.prototype.onXOverflow=t.prototype.onXOverflow,t.prototype.onNewLine=t.prototype.onNewLine,t.prototype.onRemovedLine=t.prototype.onRemovedLine,t}(),St=function(){var t=0,e=function(e,s,i,n,r){this.ownerGrid=e,this.key=s,this.field=i,this.num=n||null,this.noNumIndex=r,this.cellId="s"+t++};return e.prototype={getCurrentCell:function(){var t=this.ownerGrid.getCellByKey(this.key,this.field,this.num);if(!t)return null;if(t.isCell){if(this.num===t.getNum()&&this.noNumIndex<=0)return t}else for(var e=-1,s=0;s<t.length;s++){var i=t[s].getNum();if(null===i&&e++,this.num===i&&this.noNumIndex==e)return t[s]}return null},incFadePhase:function(){var t=this.getCurrentCell();return t?t.incFadePhase():null},getCellId:function(){return this.cellId},getFadePhase:function(){var t=this.getCurrentCell();return t?t.getFadePhase():null},getEl:function(){var t=this.getCurrentCell();return t?t.getEl():null},asynchUpdateStyles:function(t,e){var s=this.getCurrentCell();s&&s.asynchUpdateStyles(t,e)},asynchUpdateValue:function(t,e){var s=this.getCurrentCell();s&&s.asynchUpdateValue(t,e)}},e}(),yt=function(){function t(t){return null!=t}function e(e,s,i){var n=e[i];t(n)&&(delete e[i],delete s[n])}function s(e,s,n,r){if(!t(n)||!t(r))throw new Y("values can't be null nor missing");var a=e[n],o=s[r];if(t(a)){if(a===r)return;t(o)?(e[o]=a,e[n]=r,s[r]=n,s[a]=o):i(e,s,n,r)}else t(o)?i(s,e,r,n):(e[n]=r,s[r]=n)}function i(t,e,s,i){delete e[t[s]],t[s]=i,e[i]=s}function n(t,e){for(var s in t)e(s,t[s])}var r=function(){this.map={},this.reverseMap={}};return r.prototype={set:function(t,e){s(this.map,this.reverseMap,t,e)},remove:function(t){e(this.map,this.reverseMap,t)},removeReverse:function(t){e(this.reverseMap,this.map,t)},get:function(t){return this.map[t]},getReverse:function(t){return this.reverseMap[t]},exist:function(t){return void 0!==this.get(t)},existReverse:function(t){return void 0!==this.getReverse(t)},forEach:function(t){n(this.map,t)},forEachReverse:function(t){n(this.reverseMap,t)}},r.prototype.set=r.prototype.set,r.prototype.remove=r.prototype.remove,r.prototype.removeReverse=r.prototype.removeReverse,r.prototype.get=r.prototype.get,r.prototype.getReverse=r.prototype.getReverse,r.prototype.exist=r.prototype.exist,r.prototype.existReverse=r.prototype.existReverse,r.prototype.forEach=r.prototype.forEach,r.prototype.forEachReverse=r.prototype.forEachReverse,r}(),bt=function(){H.browserDocumentOrDie();var t="The given cell is null or undefined",e="The cell does not belong to the Grid",s="The given root element is not valid",i="Can't extract schema from cells declared with the data-row property; use data-item instead.",n="Can't mix data-item and data-row declarations on the same grid",r="Please specify at least one cell";function a(t,e,s){var i=t[e];t[e]=t[s],t[s]=i}var o=G.getLoggerProxy("lightstreamer.grids"),h=function(t,e,s,i){this._callSuperConstructor(h,[t]),this.explicitSetting=!1,this.rootEl=null,this.setRootNode(s||document),this.tableCells=[],i&&this.addCell(i),this.keyRowMap=new yt,this.usingItems=null,(e=this.checkBool(e,!0))&&this.parseHtml()};return h.prototype={toString:function(){return["[",this.id,"]"].join("|")},addCell:function(s){if(!s)throw new Y(t);if(V.isArray(s))for(var i=0;i<s.length;i++)this.addCell(s[i]);else{var n=new st(s),r=n.getTable();if(!r||r!=this.id)throw new Y(e);this.explicitSetting=!0,this.tableCells.push(n)}},setRootNode:function(t){if(!t||!t.getElementsByTagName)throw new Y(s);this.rootEl=t},extractItemList:function(){if(this.checkParsed(),!1===this.usingItems)throw new B(i);var t=this.computeItemSymbolsSet(),e=[];for(var s in t)e.push(s);return e},parseHtml:function(){var t;this.parsed=!0,this.grid.cellsGarbageCollection(),this.explicitSetting?(t=this.tableCells,this.tableCells=[]):t=st.getLSTags(this.rootEl,this.tagsToCheck);for(var e=0;e<t.length;e++){var s=t[e].getTable();if(s&&s==this.id){var i=t[e].getRow();if(i){if(isNaN(i)||(i=Number(i)),null===this.usingItems)this.usingItems=isNaN(i);else if(this.usingItems!=isNaN(i))throw B(n);this.usingItems||(this.maxRow=i>this.maxRow?i:this.maxRow),t[e].getField()&&(this.grid.alreadyInList(t[e])||this.grid.addCell(t[e]))}}}if(this.grid.isEmpty())throw new B(r)},computeFieldSymbolsSet:function(t){var e={};return this.grid.forEachCell((function(s,i,n){s.getFieldType()==t&&(e[n]=!0)})),e},computeItemSymbolsSet:function(){var t={};return this.grid.forEachRow((function(e){t[e]=!0})),t},updateRowExecution:function(t,e){var s,i=!this.values.getRow(t);if(this.usingItems)s=t;else{var n=null!=this.sortField?this.makeSortValue(this.values.get(t,this.sortField)):null,r=null!=this.sortField?this.makeSortValue(e[this.sortField]):null,a=n==r||void 0===e[this.sortField];if(s=null!=this.sortField&&0==a?this.calculateSortedPosition(t,n,r):i?this.addOnTop?1:this.updateIsKey()&&this.rowCount==this.maxRow?this.rowCount:this.rowCount+1:this.keyRowMap.get(t),this.updateIsKey()&&this.maxRow==this.rowCount&&i&&null!=this.sortField){var o=this.getOldestKey(),h=this.scrollOut(o);h<s&&s--,this.keyRowMap.set(t,h),this.rowCount++,i=!1}this.keyRowMap.existReverse(s)&&this.keyRowMap.getReverse(s)!=t&&this.makeRoom(s,t),this.keyRowMap.set(t,s)}if(i&&this.rowCount++,!this.updateIsKey()&&s>this.maxRow&&!this.grid.getRow(s)){var u=this.grid.getRow(s-1),l=at.scrollRow(u,null,this.useInner);this.grid.insertRow(l,s)}this.fillFormattedValues(s,e);var c=this.dispatchVisualUpdateEvent(t,s,e);this.visualUpdateExecution(s,c,t)},dispatchVisualUpdateEvent:function(t,e,s){this.currentUpdateKey=e,this.currentUpdateValues=s;var i=new ft(this.grid,s,e);return this.dispatchEvent("onVisualUpdate",[t,i,e]),this.currentUpdateKey=null,this.currentUpdateValues=null,i},getSlidingCell:function(t,e,s,i,n){return this.usingItems?t:new St(this,e,s,i,n)},getCellByKey:function(t,e,s){var i=this.keyRowMap.get(t);return this.grid.getCell(i,e,s)},removeRowExecution:function(t){var e=this.usingItems?t:this.keyRowMap.get(t);this.dispatchEvent("onVisualUpdate",[t,null,e]),this.usingItems||(e!=this.rowCount&&(this.makeRoom(this.rowCount,t),e=this.keyRowMap.get(t)),mt.verifyValue(this.rowCount,e)||o.logError("Unexpected position of row to be wiped")),this.grid.forEachCellInRow(e,(function(t){t.clean()})),this.rowCount--,this.usingItems||this.keyRowMap.remove(t)},scrollOut:function(t){var e=this.keyRowMap.get(t);return this.keyRowMap.remove(t),this.rowCount--,this.values.delRow(t),this.updateIsKey()&&this.removeFromFifo(t),e},makeRoom:function(t,e){var s=this.keyRowMap.get(e);if(t!=s){var i,n,r,a=s?at.scrollRow(this.grid.getRow(s),null,this.useInner):null,o=s?this.keyRowMap.getReverse(s):null;s?s>t?(n=s-1,r=t,i=-1):(n=s+1,r=t,i=1):null!=this.sortField||this.addOnTop?(r=t,n=this.rowCount,i=-1):(n=1,r=t,i=1);for(var h=n;h-i!=r;h+=i){var u=h-i,l=this.grid.getRow(h),c=this.grid.getRow(u);if(c||this.updateIsKey()||(c={},this.grid.insertRow(c,u),mt.verifyNotOk(s)),c)at.scrollRow(l,c,this.useInner),d=this.keyRowMap.getReverse(h),this.keyRowMap.set(d,u);else{mt.verifyOk(this.updateIsKey()),mt.verifyValue(h,n);var d=this.keyRowMap.getReverse(h);this.scrollOut(d)}}a?(at.scrollRow(a,this.grid.getRow(t),this.useInner),this.keyRowMap.set(o,t)):this.grid.forEachCellInRow(t,(function(t){t.clean()}))}},calculateSortedPosition:function(t,e,s){for(var i=1,n=this.rowCount,r=-1;i<n;){var a=null;(r=Math.floor((i+n)/2))<=this.rowCount&&(a=(o=this.keyRowMap.getReverse(r))==t?e:this.makeSortValue(this.values.get(o,this.sortField))),this.isBefore(s,a)?n=r-1:i=r+1}if(i==n){var o=this.keyRowMap.getReverse(i),h=this.makeSortValue(this.values.get(o,this.sortField));return this.isBefore(s,h)?i:i+1}return i},partition:function(t,e,s,i){var n=this.makeSortValue(this.values.get(t[i],this.sortField));a(t,s,i);for(var r=e,o=e;o<s;o++){var h=this.makeSortValue(this.values.get(t[o],this.sortField));this.isBefore(n,h)||(a(t,o,r),r++)}return a(t,r,s),r},quickSort:function(t,e,s){if(e<s){var i=Math.round(e+(s-e)/2),n=this.partition(t,e,s,i);this.quickSort(t,e,n-1),this.quickSort(t,n+1,s)}},sortTable:function(){if(!this.usingItems){var t={};this.keyRowMap.forEachReverse((function(e,s){t[e]=s})),this.quickSort(t,1,this.rowCount);var e={},s=new yt;for(var i in t){s.set(t[i],i);var n=this.keyRowMap.getReverse(i);if(t[i]!=n){var r=this.grid.getRow(i);e[n]=at.scrollRow(r,null,this.useInner);var a=t[i],o=e[a]?e[a]:this.grid.getRow(this.keyRowMap.get(a));at.scrollRow(o,r,this.useInner)}}this.keyRowMap=s}},addListener:function(t){this._callSuperMethod(h,"addListener",[t])},removeListener:function(t){this._callSuperMethod(h,"removeListener",[t])},getListeners:function(){return this._callSuperMethod(h,"getListeners")}},h.prototype.addCell=h.prototype.addCell,h.prototype.setRootNode=h.prototype.setRootNode,h.prototype.extractItemList=h.prototype.extractItemList,h.prototype.parseHtml=h.prototype.parseHtml,h.prototype.addListener=h.prototype.addListener,h.prototype.removeListener=h.prototype.removeListener,h.prototype.getListeners=h.prototype.getListeners,h.prototype.updateRowExecution=h.prototype.updateRowExecution,h.prototype.removeRowExecution=h.prototype.removeRowExecution,U(h,lt),h}(),Et=function(){H.browserDocumentOrDie();var t="The given value is not valid. Admitted values are no, left and right",e="The given value is not valid. Admitted values are open, closed and dyna",s=j.isProbablyIE(6,!0);function i(){var t=E("div");return b(t,{textAlign:"center",textOverflow:"ellipsis",fontFamily:"Arial, Helvetica, sans-serif",fontSize:"10px",color:"#333333",verticalAlign:"middle",paddingTop:"3px",width:"32px",height:"32px",display:"none"}),t.innerHTML=l,t}function n(t){var e=E("img");return e.src=t,b(e,{display:"none",width:"28px",height:"28px"}),e}var r=n("data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyBpZD0iTGl2ZWxsb18xIiBkYXRhLW5hbWU9IkxpdmVsbG8gMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgdmlld0JveD0iMCAwIDEyNi4xMDgxIDE2OS41MzgiPgogIDxkZWZzPgogICAgPGxpbmVhckdyYWRpZW50IGlkPSJTZnVtYXR1cmFfc2VuemFfbm9tZV83NyIgZGF0YS1uYW1lPSJTZnVtYXR1cmEgc2VuemEgbm9tZSA3NyIgeDE9IjUxLjQ2MTMiIHkxPSI3NC4wMDIyIiB4Mj0iLTM3LjgyMjkiIHkyPSI0OC43MTM2IiBncmFkaWVudFRyYW5zZm9ybT0idHJhbnNsYXRlKDYwLjE5MDkgMTEuNjQ2OCkgcm90YXRlKC0zLjc0MTUpIiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSI+CiAgICAgIDxzdG9wIG9mZnNldD0iMCIgc3RvcC1jb2xvcj0iI2ZmZiIvPgogICAgICA8c3RvcCBvZmZzZXQ9Ii4xNjQyIiBzdG9wLWNvbG9yPSIjZmZmIiBzdG9wLW9wYWNpdHk9Ii45NzQzIi8+CiAgICAgIDxzdG9wIG9mZnNldD0iLjM5NTMiIHN0b3AtY29sb3I9IiNmZmYiIHN0b3Atb3BhY2l0eT0iLjkwMjQiLz4KICAgICAgPHN0b3Agb2Zmc2V0PSIuNjY2IiBzdG9wLWNvbG9yPSIjZmZmIiBzdG9wLW9wYWNpdHk9Ii43ODQzIi8+CiAgICAgIDxzdG9wIG9mZnNldD0iLjk2NDciIHN0b3AtY29sb3I9IiNmZmYiIHN0b3Atb3BhY2l0eT0iLjYyMTMiLz4KICAgICAgPHN0b3Agb2Zmc2V0PSIxIiBzdG9wLWNvbG9yPSIjZmZmIiBzdG9wLW9wYWNpdHk9Ii42Ii8+CiAgICA8L2xpbmVhckdyYWRpZW50PgogICAgPGxpbmVhckdyYWRpZW50IGlkPSJTZnVtYXR1cmFfc2VuemFfbm9tZV83Ny0yIiBkYXRhLW5hbWU9IlNmdW1hdHVyYSBzZW56YSBub21lIDc3IiB4MT0iMzcuNzUzMyIgeTE9Ijk1LjkzMiIgeDI9Ii01MS40MDQyIiB5Mj0iNzAuNjc5MyIgeGxpbms6aHJlZj0iI1NmdW1hdHVyYV9zZW56YV9ub21lXzc3Ii8+CiAgICA8bGluZWFyR3JhZGllbnQgaWQ9IlNmdW1hdHVyYV9zZW56YV9ub21lXzc3LTMiIGRhdGEtbmFtZT0iU2Z1bWF0dXJhIHNlbnphIG5vbWUgNzciIHgxPSItNjMuNjgwNCIgeTE9IjM1LjE3NiIgeDI9IjU1Ljc4NTgiIHkyPSIzNS4xNzYiIHhsaW5rOmhyZWY9IiNTZnVtYXR1cmFfc2VuemFfbm9tZV83NyIvPgogICAgPGxpbmVhckdyYWRpZW50IGlkPSJTZnVtYXR1cmFfc2VuemFfbm9tZV83Ny00IiBkYXRhLW5hbWU9IlNmdW1hdHVyYSBzZW56YSBub21lIDc3IiB4MT0iLTYwLjk2MjMiIHkxPSIxMDUuNjEzIiB4Mj0iNTguNTA0OCIgeTI9IjEwNS42MTMiIHhsaW5rOmhyZWY9IiNTZnVtYXR1cmFfc2VuemFfbm9tZV83NyIvPgogIDwvZGVmcz4KICA8ZyBpZD0ibG9nb01hcmsiPgogICAgPGEgeGxpbms6aHJlZj0iYWRpZW50Ij4KICAgICAgPHBhdGggaWQ9ImxvZ29NYXJrX19QYXRoSXRlbV8iIGRhdGEtbmFtZT0ibG9nb01hcmsgJmFtcDtsdDtQYXRoSXRlbSZhbXA7Z3Q7IiBkPSJNMTExLjkxODMsNjguNDEyMWMtOS4wNzU2LTkuNDUyNy0yMi45ODk1LTExLjc1NDUtMzcuNzI4OS03LjY1ODFsLTE0LjY0NzMsNC4wNDUyYy02LjYyOCwxLjg0MTYtMTIuMzk5Mi0yLjEzMDktMTIuODY2OS04Ljg1NDctLjQ2NzctNi43MjM3LDQuNTQyNi0xMy42ODk1LDExLjE3MDYtMTUuNTMxMSwwLDAtMTQuNTk1Niw0LjA1NTktMjIuODQxOCw2LjM0NzUtMS42NDQ4LDQuMTcyMi0yLjQ0MjcsOC42MTk5LTIuMTM2NSwxMy4wMjEzLDEuMDA0OSwxNC40NDc1LDEzLjE5MTcsMTkuODY3NCwyNy40MzIzLDE1LjkxMTFsMTAuMDQ0Ni0yLjc2NjFjMzMuNzg5NS05LjM4OTEsNDIuOTM4OCwxOS43NjM3LDM2LjY0NjUsMzYuNDAxOCwxMi4yMTM2LTEwLjE5ODgsMTUuMzA1Ni0yNy44NTc0LDQuOTI3NC00MC45MTY5WiIgc3R5bGU9ImZpbGw6IHVybCgjU2Z1bWF0dXJhX3NlbnphX25vbWVfNzcpOyIvPgogICAgPC9hPgogICAgPGEgeGxpbms6aHJlZj0iYWRpZW50Ij4KICAgICAgPHBhdGggaWQ9ImxvZ29NYXJrX19QYXRoSXRlbV8tMiIgZGF0YS1uYW1lPSJsb2dvTWFyayAmYW1wO2x0O1BhdGhJdGVtJmFtcDtndDsiIGQ9Ik02NS42NTQ4LDg3Ljk5MzlsLTE0LjY0NjksNC4wNDY1Yy0xNS4zOTc0LDQuMjc4MS0zOS43MTM3LTMuMDcxNC0zNy41Mzc2LTMzLjM0MTktOC44MTIyLDEwLjQwMjMtMTAuMTM1NywyNS40OTQyLS45ODQxLDM3LjAwOTUsOS4zNDA4LDguNDU4NCwyMi45OTk5LDExLjc0OTMsMzcuNzQ1NCw3LjY1MjdsMTQuNjQ3MS00LjA0NTRjNi42MjY2LTEuODQxNCwxMi4zOTg5LDIuMTI5NSwxMi44NjY2LDguODUzMiwuNDY3Nyw2LjcyMzctNC41NDM2LDEzLjY5MjktMTEuMTcwMywxNS41MzQzLC4yODE2LS4wNzkzLDE0LjQ2MDktNC4wMTg5LDIyLjY1NDctNi4yOTQ4LDcuMTc3OS0yMi45ODQyLTYuNjg2Ni0zNC4xMDYtMjMuNTc0OS0yOS40MTQxWiIgc3R5bGU9ImZpbGw6IHVybCgjU2Z1bWF0dXJhX3NlbnphX25vbWVfNzctMik7Ii8+CiAgICA8L2E+CiAgICA8cGF0aCBpZD0ibG9nb01hcmtfX0NvbXBvdW5kUGF0aEl0ZW1fIiBkYXRhLW5hbWU9ImxvZ29NYXJrICZhbXA7bHQ7Q29tcG91bmRQYXRoSXRlbSZhbXA7Z3Q7IiBkPSJNNjcuNTg5OSwxLjc1NWwtMjMuOTY0NSw2LjYzNDNDMTcuODEzOCwxNS41NjA0LTEuNzAzNSw0Mi42OTg0LC4xMTc4LDY4Ljg4MjJjLjc4MDgsMTEuMjI1NCw1LjM1ODYsMjAuNDgxLDEyLjM2ODQsMjYuODI1OUMtLjkzODMsNzguODE1MSw4LjE2MTEsNTQuMjE5LDMwLjQwNzQsNDguMDM4MmM0Ljg1NzMtMS4zNTA0LDI3LjQzODUtNy42MjQ5LDI3LjQzODUtNy42MjQ5bC40MzQ3LS4wOTdjNi42MjY3LTEuODQxNCwxMi4zOTk1LDIuMTI5NCwxMi44NjcxLDguODUzbDQ2LjU1Ni0xMi45MzU4QzExNS44ODI0LDEwLjA0OTYsOTMuNDAxNS01LjQxNzgsNjcuNTg5OSwxLjc1NVptMTcuMzIzMiwzNS40MTU0Yy00Ljc4NTctMTIuMDg5My0xOC4zNjM2LTExLjg0MjctMjUuOTMxMS05LjczODhsLTEuNjY2NCwuNDM3Ni0yNy40NDAxLDcuNjI1Yy0zLjQ0MTUsLjk1NTctNi43NDI2LDIuMjgwMi05Ljg1NywzLjkyMTgsNS44MzI0LTguODQ4LDE0LjY2MTItMTUuODUwMywyNC44MDcyLTE4LjY2OTdsMjMuOTY2MS02LjYzNDZjMTIuODQ1Ny0zLjU2OTEsMjguNTMsMi4wNTE5LDMzLjM0NjQsMTguMjczMWwtMTcuMjI1LDQuNzg1NVoiIHN0eWxlPSJmaWxsOiB1cmwoI1NmdW1hdHVyYV9zZW56YV9ub21lXzc3LTMpOyIvPgogICAgPHBhdGggaWQ9ImxvZ29NYXJrX19Db21wb3VuZFBhdGhJdGVtXy0yIiBkYXRhLW5hbWU9ImxvZ29NYXJrICZhbXA7bHQ7Q29tcG91bmRQYXRoSXRlbSZhbXA7Z3Q7IiBkPSJNMTExLjkxODMsNjguNDEyMWMxMy40MjQ0LDE2Ljg5MjksNC4zMjQ1LDQxLjQ4OS0xNy45MjEzLDQ3LjY3LTQuODU3MywxLjM1MDQtMjcuNDM4Niw3LjYyNDktMjcuNDM4Niw3LjYyNDlsLS40MzQ2LC4wOTY4Yy02LjYyNjgsMS44NDE2LTEyLjM5OTQtMi4xMjkyLTEyLjg2NzEtOC44NTI5TDYuNjk5OSwxMjcuODg2OWMxLjgyMTMsMjYuMTgzOCwyNC4zMDMsNDEuNjUxMSw1MC4xMTQ1LDM0LjQ3ODRsMjMuOTY0NC02LjYzNDJjMjUuODExOS03LjE3MTIsNDUuMzI5Mi0zNC4zMDkzLDQzLjUwNzktNjAuNDkzLS43ODA4LTExLjIyNTQtNS4zNTg4LTIwLjQ4MS0xMi4zNjg0LTI2LjgyNlptLTMyLjAwNTYsNzQuODY4NWwtMjMuOTY0NCw2LjYzNDRjLTEyLjg0NTgsMy41NjkxLTI4LjUzMTctMi4wNTItMzMuMzQ4MS0xOC4yNzNsMTcuMjI1Mi00Ljc4NThjNC43ODU3LDEyLjA4OTYsMTguMzYzNiwxMS44NDMsMjUuOTMyNyw5Ljc0MDNsMS42NjYzLS40MzksMjcuNDM4Ni03LjYyNTFjMy40NDE0LS45NTU0LDYuNzQ0Mi0yLjI3ODcsOS44NTY5LTMuOTIxNy01LjgzMDYsOC44NDk2LTE0LjY1OTQsMTUuODUwNS0yNC44MDcyLDE4LjY2OTlaIiBzdHlsZT0iZmlsbDogdXJsKCNTZnVtYXR1cmFfc2VuemFfbm9tZV83Ny00KTsiLz4KICA8L2c+Cjwvc3ZnPg=="),a=r,o=r,h=!1,u="DATA STREAMING STATUS",l="Net<br/>State",c=0,d=1,_=2,p=3,f="left",m=y("no",f,"right"),g="dyna",v="closed",S=y(g,"open",v);function y(){for(var t={},e=0;e<arguments.length;e++)t[arguments[e]]=!0;return t}function b(t,e){for(var s in e)t.style[s]=e[s]}function E(t){var e=document.createElement(t);return b(e,{backgroundColor:"transparent"}),e}function w(){for(var t=["animationName","WebkitAnimationName","MozAnimationName","OAnimationName","msAnimationName"],e=document.createElement("div").style,s=0;s<t.length;s++)if(void 0!==e[t[s]])return!0;return!1}var T=w(),R=function(i,n,r,a){if(!s){if(this.ready=!1,this.readyStatusOpen=!1,this.cachedStatus=null,this.lsClient=null,!m[i=i||f])throw new Y(t);if(!S[a=a||v])throw new Y(e);this.isLeftBorder=i===f;var o=r?n:"auto",h=r?"auto":n;this.statusWidgetContainer=E("div");var l=E("div");this.statusTextsContainer=E("div"),b(this.statusWidgetContainer,{zIndex:"99999"}),b(l,{width:"42px",height:"42px",opacity:"0.95",filter:"alpha(opacity=95)",backgroundColor:"#003D06",zIndex:"99999",position:"relative"}),b(this.statusTextsContainer,{width:"245px",height:"42px",backgroundColor:"#E2E2E2",fontFamily:"'Open Sans',Arial,sans-serif",fontSize:"11px",color:"#003D06",position:"absolute",zIndex:"99998",visibility:"hidden",opacity:"0",filter:"alpha(opacity=0)",transition:"all 0.5s",MozTransition:"all 0.5s","-webkit-transition":"all 0.5s",OTransition:"all 0.5s","-ms-transition":"all 0.5s"}),"no"==i?(b(this.statusWidgetContainer,{position:"absolute"}),b(l,{borderRadius:"4px",float:"left"}),b(this.statusTextsContainer,{borderTopRightRadius:"4px",borderBottomRightRadius:"4px",left:"38px"})):(b(this.statusWidgetContainer,{position:"fixed",top:o,bottom:h}),i==f?(b(this.statusWidgetContainer,{left:"0px"}),b(l,{borderTopRightRadius:"4px",borderBottomRightRadius:"4px",float:"left"}),b(this.statusTextsContainer,{borderTopRightRadius:"4px",borderBottomRightRadius:"4px",left:"38px"})):(b(this.statusWidgetContainer,{right:"0px"}),b(l,{borderTopLeftRadius:"4px",borderBottomLeftRadius:"4px",float:"right"}),b(this.statusTextsContainer,{borderTopLeftRadius:"4px",borderBottomLeftRadius:"4px",right:"38px"}))),this.statusWidgetContainer.appendChild(l),this.statusWidgetContainer.appendChild(this.statusTextsContainer);var c=E("div");b(c,{position:"absolute",top:"4px",left:"7px",width:"28px",height:"28px"}),l.appendChild(c),this.initImages(c),this.transportLed=new L(l,1),this.streamingLed=new L(l,2),this.dataStreamingServer=E("div"),b(this.dataStreamingServer,{position:"absolute",top:"7px",left:"13px"}),this.statusTextsContainer.appendChild(this.dataStreamingServer),this.statusText=E("div"),b(this.statusText,{position:"absolute",top:"21px",left:"13px"}),this.statusTextsContainer.appendChild(this.statusText),this.updateWidget(x,x,x,"Ready",u,this.greyImg),this.updateWidgetS(this.greyImg),this.activate(),this.displayStatus=_,this.pinned=!1,a!=v&&(this.openDetails(!0),a==g?Z.addTimedTask(this.getMouseoutHandler(),1e3):this.pinned=!0);var d=this.getTransitionendHandler();V.addEvent(this.statusTextsContainer,"transitionend",d),V.addEvent(this.statusTextsContainer,"webkitTransitionEnd",d),V.addEvent(this.statusTextsContainer,"MSTransitionEnd",d),V.addEvent(this.statusTextsContainer,"oTransitionEnd",d),V.addEvent(this.statusWidgetContainer,"click",this.getClickHandler()),V.addEvent(this.statusWidgetContainer,"mouseover",this.getMouseoverHandler()),V.addEvent(this.statusWidgetContainer,"mouseout",this.getMouseoutHandler())}};R.prototype={getDomNode:function(){return this.statusWidgetContainer},initImages:function(t){this.greyImg=a.cloneNode(!0),t.appendChild(this.greyImg),!h&&32!=this.greyImg.height&&j.isProbablyIE(7)&&(t.removeChild(this.greyImg),a=r=o=i(),h=!0,this.greyImg=a.cloneNode(!0),t.appendChild(this.greyImg)),this.greenImg=r.cloneNode(!0),t.appendChild(this.greenImg),this.lgreenImg=o.cloneNode(!0),t.appendChild(this.lgreenImg)},activate:function(){if(!this.ready){var t=document.getElementsByTagName("body");if(t&&0!=t.length)t[0].appendChild(this.statusWidgetContainer),this.ready=!0;else{var e=this;V.addEvent(document,"DOMContentLoaded",(function(){document.getElementsByTagName("body")[0].appendChild(e.statusWidgetContainer),e.ready=!0,e.cachedStatus&&e.onStatusChange(e.cachedStatus),e.displayStatus==c?e.openDetails():e.closeDetails()}))}}},onListenStart:function(t){s||(this.onStatusChange(t.getStatus()),this.lsClient=t)},onListenEnd:function(){s||(this.updateWidget(x,x,x,"Ready",u),this.lsClient=null)},updateWidget:function(t,e,s,i,n){this.transportLed.changeColor(t),this.streamingLed.changeColor(e),this.statusText.innerHTML=s,this.dataStreamingServer.innerHTML="<b>"+i+"</b>"},updateWidgetS:function(t,e){e&&this.stopBlinking(),this.widgetImageNode&&(this.widgetImageNode.style.display="none"),t.style.display="",this.widgetImageNode=t},stopBlinking:function(){this.blinkThread&&(this.blinkFlag=!1,Z.stopRepetitiveTask(this.blinkThread),this.blinkThread=null)},startBlinking:function(){},doBlinking:function(){this.updateWidgetS(this.blinkFlag?this.greyImg:this.greenImg),this.blinkFlag=!this.blinkFlag},onStatusChange:function(t){if(this.ready&&!s){var e=u;if(t==$.DISCONNECTED)this.updateWidget(x,x,x,"Disconnected",u,this.greyImg);else if(t==$.CONNECTING)this.updateWidget(x,x,"Connecting...",e,this.greyImg),this.startBlinking();else if(0==t.indexOf($.CONNECTED)){var i="Connected over ",n=this.lsClient&&0==this.lsClient.connectionDetails.getServerAddress().indexOf("https")?"S in ":" in ";t==$.CONNECTED+$.SENSE?(this.updateWidget(C,C,"Stream-sensing...",e,this.greyImg),this.startBlinking()):t==$.CONNECTED+$.WS_STREAMING?this.updateWidget(I,I,i+"WS"+n+"streaming mode",e,this.greenImg):t==$.CONNECTED+$.HTTP_STREAMING?this.updateWidget(C,I,i+"HTTP"+n+"streaming mode",e,this.greenImg):t==$.CONNECTED+$.WS_POLLING?this.updateWidget(I,C,i+"WS"+n+"polling mode",e,this.greenImg):t==$.CONNECTED+$.HTTP_POLLING&&this.updateWidget(C,C,i+"HTTP"+n+"polling mode",e,this.greenImg)}else t==$.STALLED?this.updateWidget(x,x,"Stalled",e,this.lgreenImg):t==$.TRYING_RECOVERY?(this.updateWidget(x,x,"Recovering...",e,this.lgreenImg),this.startBlinking()):this.updateWidget(x,x,"Disconnected (will retry)",e,this.greyImg)}else this.cachedStatus=t},openDetails:function(t){this.displayStatus!=c&&this.displayStatus!=d&&(this.displayStatus=d,b(this.statusTextsContainer,{visibility:"",opacity:"1",filter:"alpha(opacity=100)"}),T&&!t||this.transitionendHandler())},closeDetails:function(t){this.displayStatus!=_&&this.displayStatus!=p&&(this.displayStatus=p,b(this.statusTextsContainer,{visibility:"hidden",opacity:"0",filter:"alpha(opacity=0)"}),this.pinned=!1,T&&!t||this.transitionendHandler())},getMouseoverHandler:function(){var t=this;return function(){t.openDetails()}},getMouseoutHandler:function(){var t=this;return function(){t.pinned||t.closeDetails()}},getClickHandler:function(){var t=this;return function(){t.clickHandler()}},clickHandler:function(){this.pinned?this.closeDetails():(this.pinned=!0,this.openDetails())},getTransitionendHandler:function(){var t=this;return function(){t.transitionendHandler()}},transitionendHandler:function(){"hidden"==this.statusTextsContainer.style.visibility?this.toggleState=_:this.toggleState=c}};var I="#00C922",C="#F4DD80",x="#003D06";function L(t,e){this.led=E("div"),b(this.led,{position:"absolute",bottom:"3px",left:11+11*(e-1)+"px",width:"10px",height:"3px",borderRadius:"2px",backgroundColor:x}),t.appendChild(this.led)}return L.prototype.changeColor=function(t){b(this.led,{backgroundColor:t})},R.prototype.onStatusChange=R.prototype.onStatusChange,R.prototype.onListenStart=R.prototype.onListenStart,R.prototype.onListenEnd=R.prototype.onListenEnd,R.prototype.getDomNode=R.prototype.getDomNode,R}(),wt=function(){};wt.prototype={onNewLine:function(t,e,s,i){},onRemovedLine:function(t,e){},onXOverflow:function(t,e,s,i){},onYOverflow:function(t,e,s,i,n){}};var Tt=function(){};Tt.prototype={onCurrentPagesChanged:function(t){},onVisualUpdate:function(t,e,s){}};var Rt=function(){};Rt.prototype={onVisualUpdate:function(t,e,s){}};var It=function(t){this.delegate=t};It.prototype={setContentLength:function(t){this.delegate.setContentLength(t)},getContentLength:function(){return this.delegate.getContentLength()},setIdleTimeout:function(t){this.delegate.setIdleTimeout(t)},getIdleTimeout:function(){return this.delegate.getIdleTimeout()},setKeepaliveInterval:function(t){this.delegate.setKeepaliveInterval(t)},getKeepaliveInterval:function(){return this.delegate.getKeepaliveInterval()},setRequestedMaxBandwidth:function(t){this.delegate.setRequestedMaxBandwidth(t)},getRequestedMaxBandwidth:function(){return this.delegate.getRequestedMaxBandwidth()},getRealMaxBandwidth:function(){return this.delegate.getRealMaxBandwidth()},setPollingInterval:function(t){this.delegate.setPollingInterval(t)},getPollingInterval:function(){return this.delegate.getPollingInterval()},setReconnectTimeout:function(t){this.delegate.setReconnectTimeout(t)},getReconnectTimeout:function(){return this.delegate.getReconnectTimeout()},setStalledTimeout:function(t){this.delegate.setStalledTimeout(t)},getStalledTimeout:function(){return this.delegate.getStalledTimeout()},setRetryDelay:function(t){this.delegate.setRetryDelay(t)},getRetryDelay:function(){return this.delegate.getRetryDelay()},setFirstRetryMaxDelay:function(t){this.delegate.setFirstRetryMaxDelay(t)},getFirstRetryMaxDelay:function(){return this.delegate.getFirstRetryMaxDelay()},setSlowingEnabled:function(t){this.delegate.setSlowingEnabled(t)},isSlowingEnabled:function(){return this.delegate.isSlowingEnabled()},setForcedTransport:function(t){this.delegate.setForcedTransport(t)},getForcedTransport:function(){return this.delegate.getForcedTransport()},setServerInstanceAddressIgnored:function(t){this.delegate.setServerInstanceAddressIgnored(t)},isServerInstanceAddressIgnored:function(){return this.delegate.isServerInstanceAddressIgnored()},setCookieHandlingRequired:function(t){this.delegate.setCookieHandlingRequired(t)},isCookieHandlingRequired:function(){return this.delegate.isCookieHandlingRequired()},setReverseHeartbeatInterval:function(t){this.delegate.setReverseHeartbeatInterval(t)},getReverseHeartbeatInterval:function(){return this.delegate.getReverseHeartbeatInterval()},setHttpExtraHeaders:function(t){this.delegate.setHttpExtraHeaders(t)},getHttpExtraHeaders:function(){return this.delegate.getHttpExtraHeaders()},setHttpExtraHeadersOnSessionCreationOnly:function(t){this.delegate.setHttpExtraHeadersOnSessionCreationOnly(t)},isHttpExtraHeadersOnSessionCreationOnly:function(){return this.delegate.isHttpExtraHeadersOnSessionCreationOnly()},setSessionRecoveryTimeout:function(t){this.delegate.setSessionRecoveryTimeout(t)},getSessionRecoveryTimeout:function(){return this.delegate.getSessionRecoveryTimeout()}};var Ct=function(t){this.delegate=t};Ct.prototype={setServerAddress:function(t){this.delegate.setServerAddress(t)},getServerAddress:function(){return this.delegate.getServerAddress()},setAdapterSet:function(t){this.delegate.setAdapterSet(t)},getAdapterSet:function(){return this.delegate.getAdapterSet()},setUser:function(t){this.delegate.setUser(t)},getUser:function(){return this.delegate.getUser()},setPassword:function(t){this.delegate.setPassword(t)},getServerInstanceAddress:function(){return this.delegate.getServerInstanceAddress()},getServerSocketName:function(){return this.delegate.getServerSocketName()},getSessionId:function(){return this.delegate.getSessionId()},getClientIp:function(){return this.delegate.getClientIp()}};var xt=function(t,e){this.delegate=new M(t,e),this.connectionOptions=new It(this.delegate.connectionOptions),this.connectionDetails=new Ct(this.delegate.connectionDetails)};xt.setLoggerProvider=function(t){M.setLoggerProvider(t)},xt.LIB_NAME=M.LIB_NAME,xt.LIB_VERSION=M.LIB_VERSION,xt.prototype={connect:function(){this.delegate.connect()},disconnect:function(){this.delegate.disconnect()},getStatus:function(){return this.delegate.getStatus()},sendMessage:function(t,e,s,i,n){this.delegate.sendMessage(t,e,s,i,n)},getSubscriptions:function(){return this.delegate.getSubscriptionWrappers()},subscribe:function(t){this.delegate.subscribe(t.delegate)},unsubscribe:function(t){this.delegate.unsubscribe(t.delegate)},addListener:function(t){this.delegate.addListener(t)},removeListener:function(t){this.delegate.removeListener(t)},getListeners:function(){return this.delegate.getListeners()},registerForMpn:function(t){this.delegate.registerForMpn(t.delegate)},subscribeMpn:function(t,e){this.delegate.subscribeMpn(t.delegate,e)},unsubscribeMpn:function(t){this.delegate.unsubscribeMpn(t.delegate)},unsubscribeMpnSubscriptions:function(t){this.delegate.unsubscribeMpnSubscriptions(t)},getMpnSubscriptions:function(t){return this.delegate.getMpnSubscriptionWrappers(t)},findMpnSubscription:function(t){return this.delegate.findMpnSubscriptionWrapper(t)}};var Lt=function(t,e,s){this.delegate=new D(t,e,s,this)};Lt.prototype={isActive:function(){return this.delegate.isActive()},isSubscribed:function(){return this.delegate.isSubscribed()},setItems:function(t){this.delegate.setItems(t)},getItems:function(){return this.delegate.getItems()},setItemGroup:function(t){this.delegate.setItemGroup(t)},getItemGroup:function(){return this.delegate.getItemGroup()},setFields:function(t){this.delegate.setFields(t)},getFields:function(){return this.delegate.getFields()},setFieldSchema:function(t){this.delegate.setFieldSchema(t)},getFieldSchema:function(){return this.delegate.getFieldSchema()},getMode:function(){return this.delegate.getMode()},setDataAdapter:function(t){this.delegate.setDataAdapter(t)},getDataAdapter:function(){return this.delegate.getDataAdapter()},setSelector:function(t){this.delegate.setSelector(t)},getSelector:function(){return this.delegate.getSelector()},setRequestedMaxFrequency:function(t){this.delegate.setRequestedMaxFrequency(t)},getRequestedMaxFrequency:function(){return this.delegate.getRequestedMaxFrequency()},setRequestedBufferSize:function(t){this.delegate.setRequestedBufferSize(t)},getRequestedBufferSize:function(){return this.delegate.getRequestedBufferSize()},setRequestedSnapshot:function(t){this.delegate.setRequestedSnapshot(t)},getRequestedSnapshot:function(){return this.delegate.getRequestedSnapshot()},setCommandSecondLevelFields:function(t){this.delegate.setCommandSecondLevelFields(t)},getCommandSecondLevelFields:function(){return this.delegate.getCommandSecondLevelFields()},setCommandSecondLevelFieldSchema:function(t){this.delegate.setCommandSecondLevelFieldSchema(t)},getCommandSecondLevelFieldSchema:function(){return this.delegate.getCommandSecondLevelFieldSchema()},setCommandSecondLevelDataAdapter:function(t){this.delegate.setCommandSecondLevelDataAdapter(t)},getCommandSecondLevelDataAdapter:function(){return this.delegate.getCommandSecondLevelDataAdapter()},getValue:function(t,e){return this.delegate.getValue(t,e)},getCommandValue:function(t,e,s){return this.delegate.getCommandValue(t,e,s)},getKeyPosition:function(){return this.delegate.getKeyPosition()},getCommandPosition:function(){return this.delegate.getCommandPosition()},addListener:function(t){this.delegate.addListener(t)},removeListener:function(t){this.delegate.removeListener(t)},getListeners:function(){return this.delegate.getListeners()}};var Nt=function(){};Nt.TRACE=A.TRACE,Nt.DEBUG=A.DEBUG,Nt.INFO=A.INFO,Nt.WARN=A.WARN,Nt.ERROR=A.ERROR,Nt.FATAL=A.FATAL;var Mt=function(t){this.delegate=new q(t)};Mt.prototype.getLogger=function(t){return this.delegate.getLogger(t)};var Dt=function(t,e,s){this.delegate=new P(t,e,s)};Dt.prototype={addListener:function(t){this.delegate.addListener(t)},removeListener:function(t){this.delegate.removeListener(t)},getListeners:function(){return this.delegate.getListeners()},getPlatform:function(){return this.delegate.getPlatform()},getApplicationId:function(){return this.delegate.getApplicationId()},getDeviceToken:function(){return this.delegate.getDeviceToken()},getPreviousDeviceToken:function(){return this.delegate.getPreviousDeviceToken()},isRegistered:function(){return this.delegate.isRegistered()},isSuspended:function(){return this.delegate.isSuspended()},getStatus:function(){return this.delegate.getStatus()},getStatusTimestamp:function(){return this.delegate.getStatusTimestamp()},getDeviceId:function(){return this.delegate.getDeviceId()}};var Ot=function(){var t=arguments[0],e=arguments[1],s=arguments[2];if("string"==typeof t)this.delegate=new k(t,e,s,this);else{var i=t.delegate;this.delegate=new k(i,null,null,this)}};Ot.prototype={addListener:function(t){this.delegate.addListener(t)},removeListener:function(t){this.delegate.removeListener(t)},getListeners:function(){return this.delegate.getListeners()},getNotificationFormat:function(){return this.delegate.getNotificationFormat()},getActualNotificationFormat:function(){return this.delegate.getActualNotificationFormat()},setNotificationFormat:function(t){this.delegate.setNotificationFormat(t)},getTriggerExpression:function(){return this.delegate.getTriggerExpression()},getActualTriggerExpression:function(){return this.delegate.getActualTriggerExpression()},setTriggerExpression:function(t){this.delegate.setTriggerExpression(t)},isActive:function(){return this.delegate.isActive()},isSubscribed:function(){return this.delegate.isSubscribed()},isTriggered:function(){return this.delegate.isTriggered()},getStatus:function(){return this.delegate.getStatus()},getStatusTimestamp:function(){return this.delegate.getStatusTimestamp()},setItems:function(t){this.delegate.setItems(t)},getItems:function(){return this.delegate.getItems()},setItemGroup:function(t){this.delegate.setItemGroup(t)},getItemGroup:function(){return this.delegate.getItemGroup()},setFields:function(t){this.delegate.setFields(t)},getFields:function(){return this.delegate.getFields()},setFieldSchema:function(t){this.delegate.setFieldSchema(t)},getFieldSchema:function(){return this.delegate.getFieldSchema()},setDataAdapter:function(t){this.delegate.setDataAdapter(t)},getDataAdapter:function(){return this.delegate.getDataAdapter()},setRequestedBufferSize:function(t){this.delegate.setRequestedBufferSize(t)},getRequestedBufferSize:function(){return this.delegate.getRequestedBufferSize()},setRequestedMaxFrequency:function(t){this.delegate.setRequestedMaxFrequency(t)},getRequestedMaxFrequency:function(){return this.delegate.getRequestedMaxFrequency()},getMode:function(){return this.delegate.getMode()},getSubscriptionId:function(){return this.delegate.getSubscriptionId()}};var Pt=function(t){this.delegate=new F(t)};Pt.prototype={build:function(){return this.delegate.build()},getTitle:function(){return this.delegate.getTitle()},setTitle:function(t){return this.delegate.setTitle(t),this},getBody:function(){return this.delegate.getBody()},setBody:function(t){return this.delegate.setBody(t),this},getAction:function(){return this.delegate.getAction()},setAction:function(t){return this.delegate.setAction(t),this},getUrlArguments:function(){return this.delegate.getUrlArguments()},setUrlArguments:function(t){return this.delegate.setUrlArguments(t),this}};var kt=function(t){this.delegate=new O(t)};return kt.prototype={build:function(){return this.delegate.build()},getHeaders:function(){return this.delegate.getHeaders()},setHeaders:function(t){return this.delegate.setHeaders(t),this},getTitle:function(){return this.delegate.getTitle()},setTitle:function(t){return this.delegate.setTitle(t),this},getBody:function(){return this.delegate.getBody()},setBody:function(t){return this.delegate.setBody(t),this},getIcon:function(){return this.delegate.getIcon()},setIcon:function(t){return this.delegate.setIcon(t),this},getData:function(){return this.delegate.getData()},setData:function(t){return this.delegate.setData(t),this}},t.Chart=rt,t.ChartListener=wt,t.ClientListener=T,t.ClientMessageListener=R,t.ConsoleLogLevel=Nt,t.ConsoleLoggerProvider=Mt,t.DynaGrid=gt,t.DynaGridListener=Tt,t.FirebaseMpnBuilder=kt,t.ItemUpdate=I,t.LightstreamerClient=xt,t.Logger=E,t.LoggerProvider=w,t.MpnDevice=Dt,t.MpnDeviceListener=x,t.MpnSubscription=Ot,t.MpnSubscriptionListener=L,t.SafariMpnBuilder=Pt,t.SimpleChartListener=vt,t.StaticGrid=bt,t.StaticGridListener=Rt,t.StatusWidget=Et,t.Subscription=Lt,t.SubscriptionListener=C,t}({}),s);if("function"==typeof define&&define.amd)define("lightstreamer",["module"],(function(t){var e=t.config().ns?t.config().ns+"/":"";define(e+"LightstreamerClient",(function(){return i.LightstreamerClient})),define(e+"Subscription",(function(){return i.Subscription})),define(e+"ConsoleLogLevel",(function(){return i.ConsoleLogLevel})),define(e+"ConsoleLoggerProvider",(function(){return i.ConsoleLoggerProvider})),define(e+"MpnDevice",(function(){return i.MpnDevice})),define(e+"MpnSubscription",(function(){return i.MpnSubscription})),define(e+"SafariMpnBuilder",(function(){return i.SafariMpnBuilder})),define(e+"FirebaseMpnBuilder",(function(){return i.FirebaseMpnBuilder})),define(e+"Chart",(function(){return i.Chart})),define(e+"DynaGrid",(function(){return i.DynaGrid})),define(e+"SimpleChartListener",(function(){return i.SimpleChartListener})),define(e+"StaticGrid",(function(){return i.StaticGrid})),define(e+"StatusWidget",(function(){return i.StatusWidget})),define(e+"Logger",(function(){return i.Logger})),define(e+"LoggerProvider",(function(){return i.LoggerProvider})),define(e+"ClientListener",(function(){return i.ClientListener})),define(e+"ClientMessageListener",(function(){return i.ClientMessageListener})),define(e+"ItemUpdate",(function(){return i.ItemUpdate})),define(e+"SubscriptionListener",(function(){return i.SubscriptionListener})),define(e+"MpnDeviceListener",(function(){return i.MpnDeviceListener})),define(e+"MpnSubscriptionListener",(function(){return i.MpnSubscriptionListener})),define(e+"ChartListener",(function(){return i.ChartListener})),define(e+"DynaGridListener",(function(){return i.DynaGridListener})),define(e+"StaticGridListener",(function(){return i.StaticGridListener}))})),require(["lightstreamer"]);else{var n=function(t,e){if(!t)return e;for(var s=t.split("."),i=e||window,n=0;n<s.length;n++){var r=s[n],a=i[r];a&&"object"==typeof a||(a=i[r]={}),i=a}return i}(function(){if("undefined"==typeof window||void 0===window.document)return null;for(var t=window.document.getElementsByTagName("script"),e=0,s=t.length;e<s;e++)if("data-lightstreamer-ns"in t[e].attributes)return t[e].attributes["data-lightstreamer-ns"].value;return null}(),t);n.LightstreamerClient=i.LightstreamerClient,n.Subscription=i.Subscription,n.ConsoleLogLevel=i.ConsoleLogLevel,n.ConsoleLoggerProvider=i.ConsoleLoggerProvider,n.MpnDevice=i.MpnDevice,n.MpnSubscription=i.MpnSubscription,n.SafariMpnBuilder=i.SafariMpnBuilder,n.FirebaseMpnBuilder=i.FirebaseMpnBuilder,n.Chart=i.Chart,n.DynaGrid=i.DynaGrid,n.SimpleChartListener=i.SimpleChartListener,n.StaticGrid=i.StaticGrid,n.StatusWidget=i.StatusWidget,n.Logger=i.Logger,n.LoggerProvider=i.LoggerProvider,n.ClientListener=i.ClientListener,n.ClientMessageListener=i.ClientMessageListener,n.ItemUpdate=i.ItemUpdate,n.SubscriptionListener=i.SubscriptionListener,n.MpnDeviceListener=i.MpnDeviceListener,n.MpnSubscriptionListener=i.MpnSubscriptionListener,n.ChartListener=i.ChartListener,n.DynaGridListener=i.DynaGridListener,n.StaticGridListener=i.StaticGridListener}}("undefined"!=typeof self?self:this);
//# sourceMappingURL=lightstreamer.min.js.map
