<?xml version="1.0"?>

<adapters_conf id="KafkaConnector">
    <metadata_provider>
        <!-- Mandatory. Java class name of the Kafka Connector Metadata Adapter. It is possible to provide a
             custom implementation by extending this class. -->
        <adapter_class>com.lightstreamer.kafka.adapters.pub.KafkaConnectorMetadataAdapter</adapter_class>

        <!-- Mandatory. The path of the reload4j configuration file, relative to the deployment folder
             (LS_HOME/adapters/lightstreamer-kafka-connector). -->
        <param name="logging.configuration.path">log4j.properties</param>

    </metadata_provider>

    <data_provider name="QuickStart">
        <!-- ##### GENERAL PARAMETERS ##### -->

        <adapter_class>com.lightstreamer.kafka.adapters.KafkaConnectorDataAdapter</adapter_class>

        <param name="bootstrap.servers">$env.bootstrap_server</param>
        <param name="group.id">lightstreamer-kafka-consumer-group</param>

        <!-- ##### ENCRYPTION SETTINGS ##### -->
        <param name="encryption.enable">true</param>
        <param name="encryption.protocol">TLSv1.2</param>
        <param name="encryption.hostname.verification.enable">true</param>

        <!-- ##### AUTHENTICATION SETTINGS ##### -->
        <param name="authentication.enable">true</param>
        <param name="authentication.mechanism">PLAIN</param>
        <param name="authentication.username">\$ConnectionString</param>
        <param name="authentication.password">$env.connection_string</param>

        <!-- ##### RECORD EVALUATION SETTINGS ##### -->
        <param name="record.consume.from">EARLIEST</param>
        <param name="record.key.evaluator.type">INTEGER</param>
        <param name="record.value.evaluator.type">JSON</param>

		<!-- ##### Azure Event Hubs specific settings ##### -->
		<param name="consumer.max.poll.interval.ms">50000</param>
		<param name="consumer.session.timeout.ms">30000</param>

        <!-- ##### Azure Schema Registry ##### -->
        <!-- AVRO Schema Example 
		<param name="record.value.evaluator.schema.registry.enable">true</param>
		<param name="schema.registry.url">https://myeventhub.servicebus.windows.net</param>
		<param name="schema.registry.provider">AZURE</param>
		<param name="schema.registry.azure.schema.id.header">de4ad7aa6d70468ba862660f9aa51ba1</param>
		<param name="schema.registry.azure.client.id">b32caa30-0000-4444-6041-f29e75572449</param>
		<param name="schema.registry.azure.tenant.id">fb769c2b-0b0b-8888-aaaa-bb756bf7e924</param>
		<param name="schema.registry.azure.client.secret">Yij8Q~Z~myapplicationsecretfggmuzp-bQ~</param>
        -->
        <!-- JSON Schema Example
        <param name="record.value.evaluator.schema.registry.enable">true</param>
		<param name="schema.registry.url">https://myeventhub.servicebus.windows.net</param>
		<param name="schema.registry.provider">AZURE</param>
        #### Tenant id, schema id, and application secret should be  ####
        #### configured in environment variables.                    ####
        -->

        <!-- ##### RECORD ROUTING SETTINGS ##### -->
        <param name="item-template.stock">stock-#{index=KEY}</param>
        <param name="map.stocks.to">item-template.stock</param>

        <!-- ##### RECORD MAPPING SETTINGS ##### -->
        <param name="field.timestamp">#{VALUE.timestamp}</param>
        <param name="field.time">#{VALUE.time}</param>
        <param name="field.stock_name">#{VALUE.name}</param>
        <param name="field.last_price">#{VALUE.last_price}</param>
        <param name="field.ask">#{VALUE.ask}</param>
        <param name="field.ask_quantity">#{VALUE.ask_quantity}</param>
        <param name="field.bid">#{VALUE.bid}</param>
        <param name="field.bid_quantity">#{VALUE.bid_quantity}</param>
        <param name="field.pct_change">#{VALUE.pct_change}</param>
        <param name="field.min">#{VALUE.min}</param>
        <param name="field.max">#{VALUE.max}</param>
        <param name="field.ref_price">#{VALUE.ref_price}</param>
        <param name="field.open_price">#{VALUE.open_price}</param>
        <param name="field.item_status">#{VALUE.item_status}</param>
        <param name="field.ts">#{TIMESTAMP}</param>
        <param name="field.topic">#{TOPIC}</param>
        <param name="field.offset">#{OFFSET}</param>
        <param name="field.partition">#{PARTITION}</param>

    </data_provider>

</adapters_conf>